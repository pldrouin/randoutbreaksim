<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>branchsimc: standard_summary_stats.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">branchsimc
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">branchsimc Outbreak Branching Model Simulation Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('standard__summary__stats_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">standard_summary_stats.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="standard__summary__stats_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * @file standard_summary_stats.h</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * @brief User-defined functions to compute standard summary statistics.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * @author &lt;Pierre-Luc.Drouin@drdc-rddc.gc.ca&gt;, Defence Research and Development Canada Ottawa Research Centre.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#ifndef _STANDARD_SUMMARY_STATS_</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#define _STANDARD_SUMMARY_STATS_</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;stdbool.h&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160; </div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;assert.h&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="infindividual_8h.html">infindividual.h</a>&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="simulation_8h.html">simulation.h</a>&quot;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#af129ef530dd15ca11c8d3d8bb4586d58">   19</a></span>&#160;<span class="preprocessor">#define INIT_NINF_ALLOC (16) </span><span class="comment">//!&lt; Initial number of allocated bins for the ninf histogram</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"></span>#define INIT_NACTENTRIES (16)</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#define CTENTRIES_GROWFACT (1.5)</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">extern</span> <span class="keywordtype">int</span> __ro_debug;</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#ifdef DEBUG_PRINTF</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#undef DEBUG_PRINTF</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">   27</a></span>&#160;<span class="preprocessor">#define DEBUG_PRINTF(...) </span><span class="comment">//!&lt; Debug print function</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"></span>//#define DEBUG_PRINTF(...) {if(__ro_debug) printf(__VA_ARGS__);} <span class="comment">//!&lt; Debug print function</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#ifdef CT_OUTPUT</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span>{</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  int32_t postesttime;</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  int32_t presymtime;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  uint32_t id;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  uint32_t pid;</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  uint32_t ntracedcts;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;} ctposinf;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160; </div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="structext__timeline__info.html">   40</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="structext__timeline__info.html#aed11afcf2a1f604436e380df85ab18ec">   42</a></span>&#160;  uint32_t   <a class="code" href="structext__timeline__info.html#aed11afcf2a1f604436e380df85ab18ec">n</a>;                <span class="comment">//!&lt; Number of infectious creating infections in the timeline bin.</span></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="structext__timeline__info.html#ad53abeb4eebe50d38b9dfa8603e454f3">   43</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structext__timeline__info.html#ad53abeb4eebe50d38b9dfa8603e454f3">rsum</a>;           <span class="comment">//!&lt; Sum of the number of individuals that get infected in the timeline bin.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno"><a class="line" href="structext__timeline__info.html#a07d1c95137114d8b33cac91c14d1d736">   44</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="structext__timeline__info.html#a07d1c95137114d8b33cac91c14d1d736">commpersum</a>;           <span class="comment">//!&lt; Sum of communicable periods for all infectious individuals whose communicable period start before tmax in the timeline bin.</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"></span><span class="preprocessor">#ifdef NUMEVENTSSTATS</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  uint32_t neventssum;         <span class="comment">//!&lt; Sum of the number of transmission events for all infectious individuals whose communicable period occurs before tmax in the timeline bin.</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"></span><span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="structext__timeline__info.html#aeca0daef2a8c5553596ea7871f4b4946">   48</a></span>&#160;  uint64_t* <a class="code" href="structext__timeline__info.html#aeca0daef2a8c5553596ea7871f4b4946">ngeninfs</a>;          <span class="comment">//!&lt; Number of generated infections from each infectious individual in the timeline bin.</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"></span>} <a class="code" href="structext__timeline__info.html">ext_timeline_info</a>;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> * Simulation-level standard summary statistics data struct.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html">   54</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;{</div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#acbd17fcad2eb7abd3430ec4ff8275d3d">   56</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="structstd__summary__stats.html#acbd17fcad2eb7abd3430ec4ff8275d3d">extinction_time</a>;   <span class="comment">//!&lt; *Path extinction time, if any. </span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a40874a46f008c64e6ad71312da1c3e04">   57</a></span>&#160;<span class="comment"></span>  uint32_t* <a class="code" href="structstd__summary__stats.html#a40874a46f008c64e6ad71312da1c3e04">inf_timeline</a>;   <span class="comment">//!&lt; For each integer interval between 0 and floor(nbinsperunit*tmax)-1, the number of individuals that are infected, but not isolated, at some point in this interval.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a9f1399b1a96c10fc895ca4138cc0cae0">   58</a></span>&#160;<span class="comment"></span>  uint32_t* <a class="code" href="structstd__summary__stats.html#a9f1399b1a96c10fc895ca4138cc0cae0">newinf_timeline</a>;    <span class="comment">//!&lt; For each integer interval between 0 and floor(nbinsperunit*tmax)-1, the number of individuals that get infected at some point in this interval. For the last interval,</span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#acd11be3b63130e0de5173f46fb718642">   59</a></span>&#160;<span class="comment"></span>  uint32_t* <a class="code" href="structstd__summary__stats.html#acd11be3b63130e0de5173f46fb718642">postest_timeline</a>;   <span class="comment">//!&lt; For each integer interval between 0 and floor(nbinsperunit*tmax)-1, the number of individuals that have a recent positive test result at the end of this interval.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a1a4469f6d6346c2c1218880021c3189a">   60</a></span>&#160;<span class="comment"></span>  uint32_t* <a class="code" href="structstd__summary__stats.html#a1a4469f6d6346c2c1218880021c3189a">newpostest_timeline</a>;<span class="comment">//!&lt; For each integer interval between 0 and floor(nbinsperunit*tmax), the number of individuals that receive a positive test result at some point in this interval.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">   61</a></span>&#160;<span class="comment"></span>  uint32_t* <a class="code" href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">pp_inf_timeline</a>;    <span class="comment">//!&lt; Post-processing timeline. For each integer interval between 0 and floor(nbinsperunit*tmax)-1, the number of individuals that are infected, but not isolated, at some point in this interval.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#acc1e7914a73488e5ae0f119a4ea976bf">   62</a></span>&#160;<span class="comment"></span>  uint32_t* <a class="code" href="structstd__summary__stats.html#acc1e7914a73488e5ae0f119a4ea976bf">pp_newinf_timeline</a>; <span class="comment">//!&lt; Post-processing timeline. For each integer interval between 0 and floor(nbinsperunit*tmax)-1, the number of individuals that get infected at some point in this interval. For the last interval,</span></div>
<div class="line"><a name="l00063"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#ab24cc3e00ea54bfefbfad70baf4981c2">   63</a></span>&#160;<span class="comment"></span>  uint32_t* <a class="code" href="structstd__summary__stats.html#ab24cc3e00ea54bfefbfad70baf4981c2">pp_newpostest_timeline</a>;<span class="comment">//!&lt; Post-processing timeline. For each integer interval between 0 and floor(nbinsperunit*tmax), the number of individuals that receive a positive test result at some point in this interval.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a0bd89cf4c05f92f384a148c39ff44dbe">   64</a></span>&#160;<span class="comment"></span>  <a class="code" href="structext__timeline__info.html">ext_timeline_info</a>* <a class="code" href="structstd__summary__stats.html#a0bd89cf4c05f92f384a148c39ff44dbe">ext_timeline</a>;     <span class="comment">//!&lt; Extended timeline for parameters that cannot correctly be calculated when a dynamic time cur is used.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a674edafa7c2d58245fe239b50d59410b">   65</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structstd__summary__stats.html#a674edafa7c2d58245fe239b50d59410b">nainfbins</a>;       <span class="comment">//!&lt; Number of allocated infectious individual bins.</span></div>
<div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#ae7b791ae4143018fe9cd72df38039d30">   66</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structstd__summary__stats.html#ae7b791ae4143018fe9cd72df38039d30">ninfbins</a>;        <span class="comment">//!&lt; Number of used infectious individual bins.</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"></span><span class="preprocessor">#ifdef CT_OUTPUT</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  ctposinf** ctentries;</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  uint32_t nctentries;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  uint32_t nactentries;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  int32_t curctid;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a5692c490e4607c8ac651ee17d3e98ab0">   73</a></span>&#160;  int32_t <a class="code" href="structstd__summary__stats.html#a5692c490e4607c8ac651ee17d3e98ab0">npers</a>;        <span class="comment">//!&lt; Number of positive integer intervals</span></div>
<div class="line"><a name="l00074"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a88045dcbad084a2bdca7c0d537aa7d79">   74</a></span>&#160;<span class="comment"></span>  int32_t <a class="code" href="structstd__summary__stats.html#a88045dcbad084a2bdca7c0d537aa7d79">nbinsperunit</a>;     <span class="comment">//!&lt; Number of timeline bins per unit of time.</span></div>
<div class="line"><a name="l00075"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">   75</a></span>&#160;<span class="comment"></span>  int32_t  <a class="code" href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">tlshifta</a>;            <span class="comment">//!&lt; *Allocated integral shift of the timeline origin (to allow for negative time bins). Corresponds also to the number of negative integer intervals</span></div>
<div class="line"><a name="l00076"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">   76</a></span>&#160;<span class="comment"></span>  int32_t  <a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>;             <span class="comment">//!&lt; *Integral shift of the timeline origin (to allow for negative time bins). Corresponds also to the number of negative integer intervals</span></div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a8c36935604a78b458da7ab1404453c71">   77</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structstd__summary__stats.html#a8c36935604a78b458da7ab1404453c71">tnpersa</a>;             <span class="comment">//!&lt; *Total number of allocated integer intervals (negative+positive)</span></div>
<div class="line"><a name="l00078"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#af6b54552d1d6d46d9d8ac8ad1e11fa2f">   78</a></span>&#160;<span class="comment"></span>  int32_t  <a class="code" href="structstd__summary__stats.html#af6b54552d1d6d46d9d8ac8ad1e11fa2f">tlppt0idx</a>;           <span class="comment">//!&lt; Timeline post-processing t=0 index</span></div>
<div class="line"><a name="l00079"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a2e396b075b2f47ad38cc6cabc3cbeb16">   79</a></span>&#160;<span class="comment"></span>  int32_t <a class="code" href="structstd__summary__stats.html#a2e396b075b2f47ad38cc6cabc3cbeb16">tlppnnpers</a>;       <span class="comment">//!&lt; Timeline post-processing number of negative periods</span></div>
<div class="line"><a name="l00080"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a81431467e8f5b95dac9f75b26fb23785">   80</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structstd__summary__stats.html#a81431467e8f5b95dac9f75b26fb23785">tlpptnvpers</a>;     <span class="comment">//!&lt; Timeline post-processing total number of valid periods</span></div>
<div class="line"><a name="l00081"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a68ed8f4856c0c06225b77e25e1ba56e6">   81</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structstd__summary__stats.html#a68ed8f4856c0c06225b77e25e1ba56e6">lmax</a>;                <span class="comment">//!&lt; Maximum number of layers for the simulation. lmax=1 means only primary infectious individuals.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a8e83d6a8048fe685966daa2fc88b9786">   82</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structstd__summary__stats.html#a8e83d6a8048fe685966daa2fc88b9786">nimax</a>;               <span class="comment">//!&lt; Maximum number of infectious individuals for a given integer interval between 0 and floor(nbinsperunit*tmax)-1. Extinction is set to false and the simulation does not proceed further if this maximum is exceeded.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#ae164276299e063211e451d40224ab885">   83</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structstd__summary__stats.html#ae164276299e063211e451d40224ab885">npostestmax</a>;         <span class="comment">//!&lt; Maximum number of positive test results during an interval of duration npostestmaxnpers for each individual that starts when the test results are received. Extinction is set to false and the simulation does not proceed further if this maximum is exceeded.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#ab174bf9afad860d56a639cf6081494e4">   84</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structstd__summary__stats.html#ab174bf9afad860d56a639cf6081494e4">npostestmaxnpers</a>;    <span class="comment">//!&lt; Interval duration for the maximum number of positive test results</span></div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a5b91639bfd5662d72eb30e80629f3afb">   85</a></span>&#160;<span class="comment"></span>  int32_t <a class="code" href="structstd__summary__stats.html#a5b91639bfd5662d72eb30e80629f3afb">maxedoutmintimeindex</a>; <span class="comment">//!&lt; *Minimum time index which maxed out the allowed number of infected individuals or positive test results.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"></span>  <span class="comment">//uint32_t n_ended_infections;</span></div>
<div class="line"><a name="l00087"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#ac229de531e51ab996d8d9943836a81df">   87</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structstd__summary__stats.html#ac229de531e51ab996d8d9943836a81df">extinction</a>;      <span class="comment">//!&lt; *Set to true if extinction does not occur before tmax.</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a3b9774d0359ac227a1419a63bfb1b9ef">   88</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="structstd__summary__stats.html#a3b9774d0359ac227a1419a63bfb1b9ef">timerelfirstpostestresults</a>; <span class="comment">//!&lt; Indicate that the output time values are relative to the time of the first positive test results. This require the times to be recomputed in post processing.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span>} <a class="code" href="structstd__summary__stats.html">std_summary_stats</a>;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"> * @brief Initialises the standard summary statistics.</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"> * This function must be called once to initialise the standard summary</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"> * statistics, if used.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#a7e48bd471bfd6ac6f97a903ac3e2ade0">std_stats_init</a>(<a class="code" href="structsim__vars__.html">sim_vars</a> *sv, <span class="keyword">const</span> uint32_t nbinsperunit, <span class="keywordtype">bool</span> ngeninfs, <span class="keywordtype">bool</span> timerelfirstpostestresults);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"> * @brief Initialises elements of the standard summary statistics</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"> * before a path simulation.</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"> * This function must be called before the simulation of each path to initialise</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"> * elements of the standard summary statistics, if used</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"> * @param stats: Pointer to the standard summary statistics whose</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"> * elements will be initialised.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#ac35116c06c0b121db7de1e4edb6a6f9e">  111</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#ac35116c06c0b121db7de1e4edb6a6f9e">std_stats_path_init</a>(<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>* stats)</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;{</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  stats-&gt;<a class="code" href="structstd__summary__stats.html#acbd17fcad2eb7abd3430ec4ff8275d3d">extinction_time</a>=-INFINITY;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keyword">const</span> uint32_t nerase=stats-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>+stats-&gt;<a class="code" href="structstd__summary__stats.html#a5692c490e4607c8ac651ee17d3e98ab0">npers</a>;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  memset(stats-&gt;<a class="code" href="structstd__summary__stats.html#a40874a46f008c64e6ad71312da1c3e04">inf_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>,0,nerase*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  memset(stats-&gt;<a class="code" href="structstd__summary__stats.html#a9f1399b1a96c10fc895ca4138cc0cae0">newinf_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>,0,nerase*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  memset(stats-&gt;<a class="code" href="structstd__summary__stats.html#acd11be3b63130e0de5173f46fb718642">postest_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>,0,nerase*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  memset(stats-&gt;<a class="code" href="structstd__summary__stats.html#a1a4469f6d6346c2c1218880021c3189a">newpostest_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>,0,nerase*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  int32_t i;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="structext__timeline__info.html">ext_timeline_info</a>* <span class="keyword">const</span> set=stats-&gt;<a class="code" href="structstd__summary__stats.html#a0bd89cf4c05f92f384a148c39ff44dbe">ext_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span>(stats-&gt;<a class="code" href="structstd__summary__stats.html#a674edafa7c2d58245fe239b50d59410b">nainfbins</a>) {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    stats-&gt;<a class="code" href="structstd__summary__stats.html#ae7b791ae4143018fe9cd72df38039d30">ninfbins</a>=1;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <span class="keywordflow">for</span>(i=nerase-1; i&gt;=0; --i) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      set[i].<a class="code" href="structext__timeline__info.html#aed11afcf2a1f604436e380df85ab18ec">n</a>=set[i].<a class="code" href="structext__timeline__info.html#ad53abeb4eebe50d38b9dfa8603e454f3">rsum</a>=set[i].<a class="code" href="structext__timeline__info.html#a07d1c95137114d8b33cac91c14d1d736">commpersum</a>=0;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">#ifdef NUMEVENTSSTATS</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      set[i].neventssum=0;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      memset(set[i].ngeninfs,0,stats-&gt;<a class="code" href="structstd__summary__stats.html#a674edafa7c2d58245fe239b50d59410b">nainfbins</a>*<span class="keyword">sizeof</span>(uint64_t));</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  } <span class="keywordflow">else</span> memset(stats-&gt;<a class="code" href="structstd__summary__stats.html#a0bd89cf4c05f92f384a148c39ff44dbe">ext_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>,0,nerase*<span class="keyword">sizeof</span>(<a class="code" href="structext__timeline__info.html">ext_timeline_info</a>));</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  stats-&gt;<a class="code" href="structstd__summary__stats.html#ac229de531e51ab996d8d9943836a81df">extinction</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  stats-&gt;<a class="code" href="structstd__summary__stats.html#a5b91639bfd5662d72eb30e80629f3afb">maxedoutmintimeindex</a>=INT32_MAX;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  stats-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>=0;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160; </div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="preprocessor">#ifdef CT_OUTPUT</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  stats-&gt;nctentries=0;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  stats-&gt;curctid=0;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;}</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"> * @brief Performs task at the end of a path simulation.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"> * This function must be called after the simulation of each path.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00152"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#a15f6d86b1bc2a5fccbdbf58c480476c0">  152</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#a15f6d86b1bc2a5fccbdbf58c480476c0">std_stats_path_end</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv)</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;{</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;  <span class="keyword">const</span> int32_t maxedoutmintimeindex=((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;maxedoutmintimeindex;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  int32_t i,j;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="structstd__summary__stats.html">std_summary_stats</a>* sss=(<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  uint32_t tnvpers;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160; </div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <span class="keywordflow">if</span>(maxedoutmintimeindex&lt;INT32_MAX) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    tnvpers=(maxedoutmintimeindex&lt;sss-&gt;<a class="code" href="structstd__summary__stats.html#a5692c490e4607c8ac651ee17d3e98ab0">npers</a>?maxedoutmintimeindex+1:sss-&gt;<a class="code" href="structstd__summary__stats.html#a5692c490e4607c8ac651ee17d3e98ab0">npers</a>)+sss-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    tnvpers=sss-&gt;<a class="code" href="structstd__summary__stats.html#a5692c490e4607c8ac651ee17d3e98ab0">npers</a>+sss-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  }</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <span class="comment">//printf(&quot;Shift %i/%i, tnpers %u/%u\n&quot;,sss-&gt;tlshift,sss-&gt;tlshifta,tnvpers,sss-&gt;tnpersa);</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <a class="code" href="structext__timeline__info.html">ext_timeline_info</a>* <span class="keyword">const</span> et=sss-&gt;<a class="code" href="structstd__summary__stats.html#a0bd89cf4c05f92f384a148c39ff44dbe">ext_timeline</a>-sss-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <span class="comment">//for(i=-sss-&gt;tlshift; i&lt;(int32_t)tnvpers; ++i) printf(&quot;rsum[%i]=%u %u\n&quot;,i,et[i].rsum,et[i].n);</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="comment">//for(i=tnvpers-sss-&gt;tlshift-1; i&gt;=-sss-&gt;tlshift; --i) printf(&quot;newinf_timeline[%i]=%i\n&quot;,i,sss-&gt;newinf_timeline[i]);</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <span class="comment">//for(i=sss-&gt;npers-1; i&gt;=0; --i) printf(&quot;inf_timeline[%i]=%i\n&quot;,i,sss-&gt;inf_timeline[i]);</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <span class="keywordflow">if</span>(sss-&gt;<a class="code" href="structstd__summary__stats.html#ae7b791ae4143018fe9cd72df38039d30">ninfbins</a>) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <span class="keywordflow">for</span>(i=tnvpers-2; i&gt;=0; --i) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="comment">//printf(&quot;et[%i].n (%u) += %u\n&quot;,i,et[i].n,et[i+1].n);</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      et[i].<a class="code" href="structext__timeline__info.html#aed11afcf2a1f604436e380df85ab18ec">n</a>+=et[i+1].<a class="code" href="structext__timeline__info.html#aed11afcf2a1f604436e380df85ab18ec">n</a>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      et[i].<a class="code" href="structext__timeline__info.html#ad53abeb4eebe50d38b9dfa8603e454f3">rsum</a>+=et[i+1].<a class="code" href="structext__timeline__info.html#ad53abeb4eebe50d38b9dfa8603e454f3">rsum</a>;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;      et[i].<a class="code" href="structext__timeline__info.html#a07d1c95137114d8b33cac91c14d1d736">commpersum</a>+=et[i+1].<a class="code" href="structext__timeline__info.html#a07d1c95137114d8b33cac91c14d1d736">commpersum</a>;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor">#ifdef NUMEVENTSSTATS</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      et[i].neventssum+=et[i+1].neventssum;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      <span class="comment">//printf(&quot;Address et[%i].ngeninfs=%p\n&quot;,i-sss-&gt;tlshift,et[i].ngeninfs);</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <span class="keywordflow">for</span>(j=sss-&gt;<a class="code" href="structstd__summary__stats.html#ae7b791ae4143018fe9cd72df38039d30">ninfbins</a>-1; j&gt;=0; --j) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">//printf(&quot;et[%i].ngeninfs[%i] (%lu) += %lu\n&quot;,i-sss-&gt;tlshift,j,et[i].ngeninfs[j],et[i+1].ngeninfs[j]);</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    et[i].<a class="code" href="structext__timeline__info.html#aeca0daef2a8c5553596ea7871f4b4946">ngeninfs</a>[j]+=et[i+1].<a class="code" href="structext__timeline__info.html#aeca0daef2a8c5553596ea7871f4b4946">ngeninfs</a>[j];</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">//if(i==0) printf(&quot;et[%i].ngeninfs[%i] = %lu\n&quot;,i-sss-&gt;tlshift,j,et[i].ngeninfs[j]);</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordflow">for</span>(i=tnvpers-2; i&gt;=0; --i) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;      et[i].<a class="code" href="structext__timeline__info.html#aed11afcf2a1f604436e380df85ab18ec">n</a>+=et[i+1].<a class="code" href="structext__timeline__info.html#aed11afcf2a1f604436e380df85ab18ec">n</a>;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;      et[i].<a class="code" href="structext__timeline__info.html#ad53abeb4eebe50d38b9dfa8603e454f3">rsum</a>+=et[i+1].<a class="code" href="structext__timeline__info.html#ad53abeb4eebe50d38b9dfa8603e454f3">rsum</a>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;      et[i].<a class="code" href="structext__timeline__info.html#a07d1c95137114d8b33cac91c14d1d736">commpersum</a>+=et[i+1].<a class="code" href="structext__timeline__info.html#a07d1c95137114d8b33cac91c14d1d736">commpersum</a>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="preprocessor">#ifdef NUMEVENTSSTATS</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      et[i].neventssum+=et[i+1].neventssum;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  <span class="keywordflow">if</span>(sss-&gt;<a class="code" href="structstd__summary__stats.html#a3b9774d0359ac227a1419a63bfb1b9ef">timerelfirstpostestresults</a>) {</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    uint32_t <span class="keyword">const</span>* <span class="keyword">const</span> nptt=sss-&gt;<a class="code" href="structstd__summary__stats.html#a1a4469f6d6346c2c1218880021c3189a">newpostest_timeline</a>-sss-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    int32_t k;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    int32_t z;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordtype">bool</span> single;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    int32_t tlppt0idx;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    sss-&gt;<a class="code" href="structstd__summary__stats.html#a81431467e8f5b95dac9f75b26fb23785">tlpptnvpers</a>=tlppt0idx=sss-&gt;<a class="code" href="structstd__summary__stats.html#a2e396b075b2f47ad38cc6cabc3cbeb16">tlppnnpers</a>=0;</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">for</span>(z=0; z&lt;tnvpers; ++z) <span class="keywordflow">if</span>(nptt[z]) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    <span class="comment">//z=sss-&gt;tlshift;</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">//while(true) {</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      tlppt0idx=z-sss-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;      sss-&gt;<a class="code" href="structstd__summary__stats.html#a2e396b075b2f47ad38cc6cabc3cbeb16">tlppnnpers</a>=(uint32_t)ceil(z*0.5);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;      sss-&gt;<a class="code" href="structstd__summary__stats.html#a81431467e8f5b95dac9f75b26fb23785">tlpptnvpers</a>=(uint32_t)ceil((tnvpers-z)*0.5)+sss-&gt;<a class="code" href="structstd__summary__stats.html#a2e396b075b2f47ad38cc6cabc3cbeb16">tlppnnpers</a>;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keywordflow">if</span>(sss-&gt;<a class="code" href="structstd__summary__stats.html#a5b91639bfd5662d72eb30e80629f3afb">maxedoutmintimeindex</a>&lt;INT32_MAX) sss-&gt;<a class="code" href="structstd__summary__stats.html#a5b91639bfd5662d72eb30e80629f3afb">maxedoutmintimeindex</a>=(int32_t)floor((sss-&gt;<a class="code" href="structstd__summary__stats.html#a5b91639bfd5662d72eb30e80629f3afb">maxedoutmintimeindex</a>-tlppt0idx)*0.5);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;      sss-&gt;<a class="code" href="structstd__summary__stats.html#acbd17fcad2eb7abd3430ec4ff8275d3d">extinction_time</a>-=tlppt0idx/(double)sss-&gt;<a class="code" href="structstd__summary__stats.html#a88045dcbad084a2bdca7c0d537aa7d79">nbinsperunit</a>;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;      <span class="comment">//printf(&quot;Before merging: %i negatives and %u total. First positive test found at %i\n&quot;,sss-&gt;tlshift,tnvpers,z);</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      <span class="comment">//printf(&quot;First positive test found at %i =&gt; %i negative periods and %u total valid periods. maxedoutmintimeindex set to %i\n&quot;,tlppt0idx,sss-&gt;tlppnnpers,sss-&gt;tlpptnvpers,sss-&gt;maxedoutmintimeindex);</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">if</span>(sss-&gt;<a class="code" href="structstd__summary__stats.html#a81431467e8f5b95dac9f75b26fb23785">tlpptnvpers</a>) {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      sss-&gt;<a class="code" href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">pp_inf_timeline</a>=sss-&gt;<a class="code" href="structstd__summary__stats.html#a40874a46f008c64e6ad71312da1c3e04">inf_timeline</a>+tlppt0idx;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      sss-&gt;<a class="code" href="structstd__summary__stats.html#acc1e7914a73488e5ae0f119a4ea976bf">pp_newinf_timeline</a>=sss-&gt;<a class="code" href="structstd__summary__stats.html#a9f1399b1a96c10fc895ca4138cc0cae0">newinf_timeline</a>+tlppt0idx;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      sss-&gt;<a class="code" href="structstd__summary__stats.html#ab24cc3e00ea54bfefbfad70baf4981c2">pp_newpostest_timeline</a>=sss-&gt;<a class="code" href="structstd__summary__stats.html#a1a4469f6d6346c2c1218880021c3189a">newpostest_timeline</a>+tlppt0idx;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      <span class="comment">//Check if the last index is even. If it is, there is a single fine bin in</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="comment">//the last merged bin</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      single=!((tnvpers-1-z)%2);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      j=-sss-&gt;<a class="code" href="structstd__summary__stats.html#a2e396b075b2f47ad38cc6cabc3cbeb16">tlppnnpers</a>+sss-&gt;<a class="code" href="structstd__summary__stats.html#a81431467e8f5b95dac9f75b26fb23785">tlpptnvpers</a>-1-single;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">for</span>(k=0; k&lt;=j; ++k) {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    i=2*k;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    <span class="comment">//printf(&quot;[%i] = [%i] (%u) + [%i] (%u)\n&quot;,l,i,sss-&gt;newpostest_timeline[i],i+1,sss-&gt;newpostest_timeline[i+1]);</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    sss-&gt;<a class="code" href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">pp_inf_timeline</a>[k]=(sss-&gt;<a class="code" href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">pp_inf_timeline</a>[i]&gt;sss-&gt;<a class="code" href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">pp_inf_timeline</a>[i+1]?sss-&gt;<a class="code" href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">pp_inf_timeline</a>[i]:sss-&gt;<a class="code" href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">pp_inf_timeline</a>[i+1]);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    sss-&gt;<a class="code" href="structstd__summary__stats.html#acc1e7914a73488e5ae0f119a4ea976bf">pp_newinf_timeline</a>[k]=sss-&gt;<a class="code" href="structstd__summary__stats.html#acc1e7914a73488e5ae0f119a4ea976bf">pp_newinf_timeline</a>[i]+sss-&gt;<a class="code" href="structstd__summary__stats.html#acc1e7914a73488e5ae0f119a4ea976bf">pp_newinf_timeline</a>[i+1];</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    sss-&gt;<a class="code" href="structstd__summary__stats.html#ab24cc3e00ea54bfefbfad70baf4981c2">pp_newpostest_timeline</a>[k]=sss-&gt;<a class="code" href="structstd__summary__stats.html#ab24cc3e00ea54bfefbfad70baf4981c2">pp_newpostest_timeline</a>[i]+sss-&gt;<a class="code" href="structstd__summary__stats.html#ab24cc3e00ea54bfefbfad70baf4981c2">pp_newpostest_timeline</a>[i+1];</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;      }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keywordflow">if</span>(single) {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    i=-sss-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>+tnvpers;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    <span class="comment">//printf(&quot;[%i] = [%i] (%u)\n&quot;,l,i,sss-&gt;newpostest_timeline[i]);</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    sss-&gt;<a class="code" href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">pp_inf_timeline</a>[j+1]=sss-&gt;<a class="code" href="structstd__summary__stats.html#a40874a46f008c64e6ad71312da1c3e04">inf_timeline</a>[i];</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;    sss-&gt;<a class="code" href="structstd__summary__stats.html#acc1e7914a73488e5ae0f119a4ea976bf">pp_newinf_timeline</a>[j+1]=sss-&gt;<a class="code" href="structstd__summary__stats.html#a9f1399b1a96c10fc895ca4138cc0cae0">newinf_timeline</a>[i];</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    sss-&gt;<a class="code" href="structstd__summary__stats.html#ab24cc3e00ea54bfefbfad70baf4981c2">pp_newpostest_timeline</a>[j+1]=sss-&gt;<a class="code" href="structstd__summary__stats.html#a1a4469f6d6346c2c1218880021c3189a">newpostest_timeline</a>[i];</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;      } </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160; </div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="comment">//Check if the first (negative) index is odd. If it is, there is a single fine bin in</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      <span class="comment">//the first merged bin</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;      single=z%2;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      j=-sss-&gt;<a class="code" href="structstd__summary__stats.html#a2e396b075b2f47ad38cc6cabc3cbeb16">tlppnnpers</a>+single;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keywordflow">for</span>(k=-1; k&gt;=j; --k) {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    i=2*k;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">//printf(&quot;[%i] = [%i] (%u) + [%i] (%u)\n&quot;,l,i,sss-&gt;newpostest_timeline[i],i+1,sss-&gt;newpostest_timeline[i+1]);</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    sss-&gt;<a class="code" href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">pp_inf_timeline</a>[k]=(sss-&gt;<a class="code" href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">pp_inf_timeline</a>[i]&gt;sss-&gt;<a class="code" href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">pp_inf_timeline</a>[i+1]?sss-&gt;<a class="code" href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">pp_inf_timeline</a>[i]:sss-&gt;<a class="code" href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">pp_inf_timeline</a>[i+1]);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    sss-&gt;<a class="code" href="structstd__summary__stats.html#acc1e7914a73488e5ae0f119a4ea976bf">pp_newinf_timeline</a>[k]=sss-&gt;<a class="code" href="structstd__summary__stats.html#acc1e7914a73488e5ae0f119a4ea976bf">pp_newinf_timeline</a>[i]+sss-&gt;<a class="code" href="structstd__summary__stats.html#acc1e7914a73488e5ae0f119a4ea976bf">pp_newinf_timeline</a>[i+1];</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160; </div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      <span class="keywordflow">if</span>(single) {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    i=-sss-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="comment">//printf(&quot;[%i] = [%i] (%u)\n&quot;,l,i,sss-&gt;newpostest_timeline[i]);</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    sss-&gt;<a class="code" href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">pp_inf_timeline</a>[j-1]=sss-&gt;<a class="code" href="structstd__summary__stats.html#a40874a46f008c64e6ad71312da1c3e04">inf_timeline</a>[i];</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    sss-&gt;<a class="code" href="structstd__summary__stats.html#acc1e7914a73488e5ae0f119a4ea976bf">pp_newinf_timeline</a>[j-1]=sss-&gt;<a class="code" href="structstd__summary__stats.html#a9f1399b1a96c10fc895ca4138cc0cae0">newinf_timeline</a>[i];</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      } </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160; </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;      memset(sss-&gt;<a class="code" href="structstd__summary__stats.html#ab24cc3e00ea54bfefbfad70baf4981c2">pp_newpostest_timeline</a>-sss-&gt;<a class="code" href="structstd__summary__stats.html#a2e396b075b2f47ad38cc6cabc3cbeb16">tlppnnpers</a>,0,sss-&gt;<a class="code" href="structstd__summary__stats.html#a2e396b075b2f47ad38cc6cabc3cbeb16">tlppnnpers</a>*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160; </div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    sss-&gt;<a class="code" href="structstd__summary__stats.html#a2e396b075b2f47ad38cc6cabc3cbeb16">tlppnnpers</a>=sss-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    sss-&gt;<a class="code" href="structstd__summary__stats.html#a81431467e8f5b95dac9f75b26fb23785">tlpptnvpers</a>=tnvpers;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    sss-&gt;<a class="code" href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">pp_inf_timeline</a>=sss-&gt;<a class="code" href="structstd__summary__stats.html#a40874a46f008c64e6ad71312da1c3e04">inf_timeline</a>;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    sss-&gt;<a class="code" href="structstd__summary__stats.html#acc1e7914a73488e5ae0f119a4ea976bf">pp_newinf_timeline</a>=sss-&gt;<a class="code" href="structstd__summary__stats.html#a9f1399b1a96c10fc895ca4138cc0cae0">newinf_timeline</a>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    sss-&gt;<a class="code" href="structstd__summary__stats.html#ab24cc3e00ea54bfefbfad70baf4981c2">pp_newpostest_timeline</a>=sss-&gt;<a class="code" href="structstd__summary__stats.html#a1a4469f6d6346c2c1218880021c3189a">newpostest_timeline</a>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  }</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;}</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"> * @brief Frees memory used by the standard summary statistics.</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"> * This function must be called once to free the memory that was allocated by</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"> * std_stats_init.</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"> * @param stats: Pointer to the standard summary statistics.</span></div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;<span class="comment"> **/</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#aa38a2d7cde0950dcc13f741f49b12782">std_stats_free</a>(<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>* stats);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160; </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> std_stats_pri_init(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <a class="code" href="structinfindividual__.html">infindividual</a>* ii) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="comment">//We have to use curii here!</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ad5f5a0c02b49b1f8eaa9809e378100ae">event_time</a>) &lt; ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;npers &amp;&amp; sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a> &lt;= sv-&gt;brsim.<a class="code" href="structbrsim__vars.html#a6054ce18695f531e35cedac4a48af522">iis</a>+((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;lmax) {</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;Pri inf at %i\n&quot;</span>,(<span class="keywordtype">int</span>)floor(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ad5f5a0c02b49b1f8eaa9809e378100ae">event_time</a>));</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;newinf_timeline[(int)floor(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ad5f5a0c02b49b1f8eaa9809e378100ae">event_time</a>)]+=sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ab7336fd2e3b9bf73a9a95ae0a6e13062">ninfections</a>;</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  }</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;}</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"> * @brief Allocates memory for a new primary individual.</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"> * This function must be assigned to the simulation engine through a call of</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"> * sim_set_pri_init_proc_func.</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"> * @param ii: Infectious individuals.</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"> **/</span></div>
<div class="line"><a name="l00313"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#ab645fb6d8a87ea6a3ef37fe05570cc56">  313</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#ab645fb6d8a87ea6a3ef37fe05570cc56">std_stats_pri_init_rel</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <a class="code" href="structinfindividual__.html">infindividual</a>* ii)</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;{</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keyword">const</span> int32_t newshift=ceil(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*(-ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a>+(ii-&gt;<a class="code" href="structinfindividual__.html#aedd8dfe34765f625e26c6a6b8df1f256">comm_period</a>+ii-&gt;<a class="code" href="structinfindividual__.html#a73ff6b59c26c18648028348587cab820">latent_period</a>)));</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">if</span>(newshift &gt; ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;tlshift) {</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <a class="code" href="structstd__summary__stats.html">std_summary_stats</a>* stats=(<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    stats-&gt;<a class="code" href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">tlshift</a>=newshift;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">if</span>(newshift &gt; stats-&gt;<a class="code" href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">tlshifta</a>) {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;      <span class="keyword">const</span> uint32_t dshift=newshift-stats-&gt;<a class="code" href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">tlshifta</a>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;      <span class="keyword">const</span> uint32_t newsize=newshift+stats-&gt;<a class="code" href="structstd__summary__stats.html#a5692c490e4607c8ac651ee17d3e98ab0">npers</a>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;      uint32_t* newarray=(uint32_t*)malloc(newsize*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;      memset(newarray,0,dshift*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;      memcpy(newarray+dshift,stats-&gt;<a class="code" href="structstd__summary__stats.html#a40874a46f008c64e6ad71312da1c3e04">inf_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">tlshifta</a>,stats-&gt;<a class="code" href="structstd__summary__stats.html#a8c36935604a78b458da7ab1404453c71">tnpersa</a>*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;      free(stats-&gt;<a class="code" href="structstd__summary__stats.html#a40874a46f008c64e6ad71312da1c3e04">inf_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">tlshifta</a>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;      stats-&gt;<a class="code" href="structstd__summary__stats.html#a40874a46f008c64e6ad71312da1c3e04">inf_timeline</a>=newarray+newshift;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160; </div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;      newarray=(uint32_t*)malloc(newsize*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      memset(newarray,0,dshift*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;      memcpy(newarray+dshift,stats-&gt;<a class="code" href="structstd__summary__stats.html#a9f1399b1a96c10fc895ca4138cc0cae0">newinf_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">tlshifta</a>,stats-&gt;<a class="code" href="structstd__summary__stats.html#a8c36935604a78b458da7ab1404453c71">tnpersa</a>*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      free(stats-&gt;<a class="code" href="structstd__summary__stats.html#a9f1399b1a96c10fc895ca4138cc0cae0">newinf_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">tlshifta</a>);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      stats-&gt;<a class="code" href="structstd__summary__stats.html#a9f1399b1a96c10fc895ca4138cc0cae0">newinf_timeline</a>=newarray+newshift;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      newarray=(uint32_t*)malloc(newsize*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;      memset(newarray,0,dshift*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      memcpy(newarray+dshift,stats-&gt;<a class="code" href="structstd__summary__stats.html#acd11be3b63130e0de5173f46fb718642">postest_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">tlshifta</a>,stats-&gt;<a class="code" href="structstd__summary__stats.html#a8c36935604a78b458da7ab1404453c71">tnpersa</a>*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;      free(stats-&gt;<a class="code" href="structstd__summary__stats.html#acd11be3b63130e0de5173f46fb718642">postest_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">tlshifta</a>);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;      stats-&gt;<a class="code" href="structstd__summary__stats.html#acd11be3b63130e0de5173f46fb718642">postest_timeline</a>=newarray+newshift;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      newarray=(uint32_t*)malloc(newsize*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      memset(newarray,0,dshift*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      memcpy(newarray+dshift,stats-&gt;<a class="code" href="structstd__summary__stats.html#a1a4469f6d6346c2c1218880021c3189a">newpostest_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">tlshifta</a>,stats-&gt;<a class="code" href="structstd__summary__stats.html#a8c36935604a78b458da7ab1404453c71">tnpersa</a>*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;      free(stats-&gt;<a class="code" href="structstd__summary__stats.html#a1a4469f6d6346c2c1218880021c3189a">newpostest_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">tlshifta</a>);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      stats-&gt;<a class="code" href="structstd__summary__stats.html#a1a4469f6d6346c2c1218880021c3189a">newpostest_timeline</a>=newarray+newshift;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      <a class="code" href="structext__timeline__info.html">ext_timeline_info</a>* newarray_ext=malloc(newsize*<span class="keyword">sizeof</span>(<a class="code" href="structext__timeline__info.html">ext_timeline_info</a>));</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      memset(newarray_ext,0,dshift*<span class="keyword">sizeof</span>(<a class="code" href="structext__timeline__info.html">ext_timeline_info</a>));</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;      memcpy(newarray_ext+dshift,stats-&gt;<a class="code" href="structstd__summary__stats.html#a0bd89cf4c05f92f384a148c39ff44dbe">ext_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">tlshifta</a>,stats-&gt;<a class="code" href="structstd__summary__stats.html#a8c36935604a78b458da7ab1404453c71">tnpersa</a>*<span class="keyword">sizeof</span>(<a class="code" href="structext__timeline__info.html">ext_timeline_info</a>));</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      free(stats-&gt;<a class="code" href="structstd__summary__stats.html#a0bd89cf4c05f92f384a148c39ff44dbe">ext_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">tlshifta</a>);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      int32_t i;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keywordflow">if</span>(stats-&gt;<a class="code" href="structstd__summary__stats.html#a674edafa7c2d58245fe239b50d59410b">nainfbins</a>) {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    uint64_t* newarray64;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">for</span>(i=dshift-1; i&gt;=0; --i) {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      newarray64=(uint64_t*)malloc(stats-&gt;<a class="code" href="structstd__summary__stats.html#a674edafa7c2d58245fe239b50d59410b">nainfbins</a>*<span class="keyword">sizeof</span>(uint64_t));</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      memset(newarray64,0,stats-&gt;<a class="code" href="structstd__summary__stats.html#a674edafa7c2d58245fe239b50d59410b">nainfbins</a>*<span class="keyword">sizeof</span>(uint64_t));</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      newarray_ext[i].<a class="code" href="structext__timeline__info.html#aeca0daef2a8c5553596ea7871f4b4946">ngeninfs</a>=newarray64;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      <span class="comment">//printf(&quot;ext_timeline[%i].ngeninfs=%p\n&quot;,i-newshift,newarray64);</span></div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;      stats-&gt;<a class="code" href="structstd__summary__stats.html#a0bd89cf4c05f92f384a148c39ff44dbe">ext_timeline</a>=newarray_ext+newshift;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      stats-&gt;<a class="code" href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">tlshifta</a>=newshift;</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      stats-&gt;<a class="code" href="structstd__summary__stats.html#a8c36935604a78b458da7ab1404453c71">tnpersa</a>=newsize;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  }</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="comment">//We have to use curii here!</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ad5f5a0c02b49b1f8eaa9809e378100ae">event_time</a>) &lt; ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;npers &amp;&amp; sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a> &lt;= sv-&gt;brsim.<a class="code" href="structbrsim__vars.html#a6054ce18695f531e35cedac4a48af522">iis</a>+((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;lmax) {</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;Pri inf at %i\n&quot;</span>,(<span class="keywordtype">int</span>)floor(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ad5f5a0c02b49b1f8eaa9809e378100ae">event_time</a>));</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;newinf_timeline[(int)floor(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ad5f5a0c02b49b1f8eaa9809e378100ae">event_time</a>)]+=sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ab7336fd2e3b9bf73a9a95ae0a6e13062">ninfections</a>;</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  }</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;}</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment"> * @brief Allocates memory for the user-defined function data.</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"> * This function must be assigned to the simulation engine through a call of</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"> * sim_set_ii_alloc_proc_func.</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"> * @param ii: Infectious individuals.</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"> **/</span></div>
<div class="line"><a name="l00388"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#a6817859a53a32feb92636e9986da48cb">  388</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#a6817859a53a32feb92636e9986da48cb">std_stats_ii_alloc</a>(<a class="code" href="structinfindividual__.html">infindividual</a>* ii){</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;<span class="preprocessor">#ifdef CT_OUTPUT</span></div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  ii-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>=malloc(3*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  ii-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>=malloc(<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;}</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">#ifdef CT_OUTPUT</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> std_stats_add_ct_entry(<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>* stats, <span class="keyword">const</span> <span class="keywordtype">double</span> postesttime, <span class="keyword">const</span> <span class="keywordtype">double</span> presymtime, <span class="keyword">const</span> uint32_t <span class="keywordtype">id</span>, <span class="keyword">const</span> uint32_t pid, <span class="keyword">const</span> uint32_t ntracedcts){</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  ++(stats-&gt;nctentries);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;%s: %u %22.15e %22.15e %u %u %u\n&quot;</span>,__func__, stats-&gt;nctentries, postesttime, presymtime, <span class="keywordtype">id</span>, pid, ntracedcts);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <span class="keywordflow">if</span>(stats-&gt;nctentries==stats-&gt;nactentries) {</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    stats-&gt;nactentries*=CTENTRIES_GROWFACT;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    stats-&gt;ctentries=(ctposinf**)realloc(stats-&gt;ctentries,stats-&gt;nactentries*<span class="keyword">sizeof</span>(ctposinf*));</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160; </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    int32_t i;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">for</span>(i=stats-&gt;nctentries; i&lt;stats-&gt;nactentries; ++i) stats-&gt;ctentries[i]=(ctposinf*)malloc(<span class="keyword">sizeof</span>(ctposinf));</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  stats-&gt;ctentries[stats-&gt;nctentries-1]-&gt;postesttime=postesttime*1440; <span class="comment">//time in minutes</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  stats-&gt;ctentries[stats-&gt;nctentries-1]-&gt;presymtime=(isinf(presymtime)?INT32_MAX:presymtime*1440); <span class="comment">//time in minutes</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  stats-&gt;ctentries[stats-&gt;nctentries-1]-&gt;id=id;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  stats-&gt;ctentries[stats-&gt;nctentries-1]-&gt;pid=pid;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;  stats-&gt;ctentries[stats-&gt;nctentries-1]-&gt;ntracedcts=ntracedcts;</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;%s: Encoded: %i %i %u %u %u\n&quot;</span>,__func__,  stats-&gt;ctentries[stats-&gt;nctentries-1]-&gt;postesttime, stats-&gt;ctentries[stats-&gt;nctentries-1]-&gt;presymtime, stats-&gt;ctentries[stats-&gt;nctentries-1]-&gt;id=<span class="keywordtype">id</span>, stats-&gt;ctentries[stats-&gt;nctentries-1]-&gt;pid=pid, stats-&gt;ctentries[stats-&gt;nctentries-1]-&gt;ntracedcts);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;}</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="comment"> * @brief Processes the number of infections for this new event.</span></div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;<span class="comment"> * Adds the number of infections for this new event to the number of infections from</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="comment"> * the current infectious individual, and to the total infection timeline if the event</span></div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="comment"> * time is before tmax.  This function must be assigned to</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="comment"> * the simulation engine through a call of sim_set_new_event_proc_func.</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="comment"> * @return true if the event time is before tmax and new infections were</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;<span class="comment"> * generated, and false otherwise.</span></div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="comment"> **/</span></div>
<div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#aec5a65871a38a80d6a609baef1c314fe">  430</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="standard__summary__stats_8h.html#aec5a65871a38a80d6a609baef1c314fe">std_stats_new_event</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv)</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;{</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="preprocessor">#ifdef CT_OUTPUT</span></div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;  ((uint32_t*)sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[2]+=sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;ntracednicts+sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;ntracedicts;</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;Successfully traced contacts incremented to %u\n&quot;</span>,(((uint32_t*)sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[2]));</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  <span class="keywordflow">if</span>(sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ab7336fd2e3b9bf73a9a95ae0a6e13062">ninfections</a>) {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    ((uint32_t*)sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[0]+=sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ab7336fd2e3b9bf73a9a95ae0a6e13062">ninfections</a>;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;%s: Number of infections incremented to %u\n&quot;</span>,__func__,((uint32_t*)sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[0]);</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span>(sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ad5f5a0c02b49b1f8eaa9809e378100ae">event_time</a> &lt; sv-&gt;<a class="code" href="structsim__vars__.html#aac0335e2677fb786bfaf201d5e4730af">pars</a>.<a class="code" href="structmodel__pars.html#aac4af9226e4d189e42d148ce178f4033">tmax</a> &amp;&amp; sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a> &lt;= sv-&gt;brsim.<a class="code" href="structbrsim__vars.html#a6054ce18695f531e35cedac4a48af522">iis</a>+((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;lmax) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;newinf_timeline[(int)floor(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ad5f5a0c02b49b1f8eaa9809e378100ae">event_time</a>)]+=sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ab7336fd2e3b9bf73a9a95ae0a6e13062">ninfections</a>;</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;}</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;<span class="comment"> * @brief Processes the number of infections for this new event.</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="comment"> * Adds the number of infections for this new event to the number of infections from</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment"> * the current infectious individual, and to the total infection timeline if the event</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="comment"> * time is before tmax. If the incremented bin for the total infection timeline</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;<span class="comment"> * exceeds nimax, then set the extinction for the current path to false and</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="comment"> * update the value for the minimum time index where the maximum number of</span></div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;<span class="comment"> * infectious individuals was exceeded if required. This function must be assigned to</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;<span class="comment"> * the simulation engine through a call of sim_set_new_event_proc_func.</span></div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;<span class="comment"> * @return true if the event time is before tmax and new infections were</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;<span class="comment"> * generated, and false otherwise.</span></div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;<span class="comment"> **/</span></div>
<div class="line"><a name="l00464"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#a43b768c341a076d5e5b2253b9dfab9de">  464</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="standard__summary__stats_8h.html#a43b768c341a076d5e5b2253b9dfab9de">std_stats_new_event_nimax</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv)</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;{</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;<span class="preprocessor">#ifdef CT_OUTPUT</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;  ((uint32_t*)sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[2]+=sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;ntracednicts+sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;ntracedicts;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;Successfully traced contacts incremented to %u\n&quot;</span>,(((uint32_t*)sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[2]));</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="keywordflow">if</span>(sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ab7336fd2e3b9bf73a9a95ae0a6e13062">ninfections</a>) {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    ((uint32_t*)sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[0]+=sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ab7336fd2e3b9bf73a9a95ae0a6e13062">ninfections</a>;</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;%s: Number of infections incremented to %u\n&quot;</span>,__func__,((uint32_t*)sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[0]);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">if</span>(sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ad5f5a0c02b49b1f8eaa9809e378100ae">event_time</a> &lt; sv-&gt;<a class="code" href="structsim__vars__.html#aac0335e2677fb786bfaf201d5e4730af">pars</a>.<a class="code" href="structmodel__pars.html#aac4af9226e4d189e42d148ce178f4033">tmax</a>) {</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> eti=floor(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ad5f5a0c02b49b1f8eaa9809e378100ae">event_time</a>);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160; </div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keywordflow">if</span>(sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a> &lt;= sv-&gt;brsim.<a class="code" href="structbrsim__vars.html#a6054ce18695f531e35cedac4a48af522">iis</a>+((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;lmax) {</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">if</span>(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;newinf_timeline[eti]+sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ab7336fd2e3b9bf73a9a95ae0a6e13062">ninfections</a> &lt; ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nimax) {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;newinf_timeline[eti]+=sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ab7336fd2e3b9bf73a9a95ae0a6e13062">ninfections</a>;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;newinf_timeline[eti] &lt; ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nimax) {</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;newinf_timeline[eti]+=sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ab7336fd2e3b9bf73a9a95ae0a6e13062">ninfections</a>;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;extinction=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="keywordflow">if</span>(eti &lt; ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;maxedoutmintimeindex)  ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;maxedoutmintimeindex=eti;</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;nimax exceeded for time index %i (%u vs %u)\n&quot;</span>,eti,((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;newinf_timeline[eti],((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nimax);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;extinction=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;      <span class="keywordflow">if</span>(eti &lt; ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;maxedoutmintimeindex)  ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;maxedoutmintimeindex=eti;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;      <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;nimax exceeded for time index %i (%u vs %u)\n&quot;</span>,eti,((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;newinf_timeline[eti],((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nimax);</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    }</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  }</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;}</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;<span class="comment"> * @brief Processes the number of infections for this new event.</span></div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;<span class="comment"> * Adds the number of infections for this new event to the number of infections from</span></div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="comment"> * the current infectious individual, and to the total infection timeline if the event</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="comment"> * time is before tmax. If the bin for the recent positive test result timeline</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;<span class="comment"> * exceeds npostestmax, then set the extinction for the current path to false and</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="comment"> * update the value for the minimum time index where the maximum number of</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;<span class="comment"> * recent positive test results was exceeded if required. This function must be assigned to</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="comment"> * the simulation engine through a call of sim_set_new_event_proc_func.</span></div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;<span class="comment"> * @return true if the event time is before tmax and new infections were</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;<span class="comment"> * generated, and false otherwise.</span></div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="comment"> **/</span></div>
<div class="line"><a name="l00519"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#a89a2c20f5ae6364539f0fabc3a7da903">  519</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="standard__summary__stats_8h.html#a89a2c20f5ae6364539f0fabc3a7da903">std_stats_new_event_npostestmax</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv)</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;{</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="preprocessor">#ifdef CT_OUTPUT</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  ((uint32_t*)sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[2]+=sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;ntracednicts+sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;ntracedicts;</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;Successfully traced contacts incremented to %u\n&quot;</span>,(((uint32_t*)sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[2]));</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160; </div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;  <span class="keywordflow">if</span>(sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ab7336fd2e3b9bf73a9a95ae0a6e13062">ninfections</a>) {</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    ((uint32_t*)sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[0]+=sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ab7336fd2e3b9bf73a9a95ae0a6e13062">ninfections</a>;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;%s: Number of infections incremented to %u\n&quot;</span>,__func__,((uint32_t*)sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[0]);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">if</span>(sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ad5f5a0c02b49b1f8eaa9809e378100ae">event_time</a> &lt; sv-&gt;<a class="code" href="structsim__vars__.html#aac0335e2677fb786bfaf201d5e4730af">pars</a>.<a class="code" href="structmodel__pars.html#aac4af9226e4d189e42d148ce178f4033">tmax</a>) {</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> eti=floor(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ad5f5a0c02b49b1f8eaa9809e378100ae">event_time</a>);</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160; </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;      <span class="keywordflow">if</span>(sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a> &lt;= sv-&gt;brsim.<a class="code" href="structbrsim__vars.html#a6054ce18695f531e35cedac4a48af522">iis</a>+((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;lmax) {</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    <span class="keywordflow">if</span>(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;postest_timeline[eti] &lt; ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;npostestmax)</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;newinf_timeline[eti]+=sv-&gt;<a class="code" href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">curii</a>-&gt;<a class="code" href="structinfindividual__.html#ab7336fd2e3b9bf73a9a95ae0a6e13062">ninfections</a>;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;extinction=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160; </div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;      <span class="keywordflow">if</span>(eti &lt; ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;maxedoutmintimeindex)  {</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;maxedoutmintimeindex reduced from %i to %i\n&quot;</span>,((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;maxedoutmintimeindex,eti);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;maxedoutmintimeindex=eti;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;npostestmax exceeded for time index %i (%u vs %u)\n&quot;</span>,eti,((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;postest_timeline[eti],((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;npostestmax);</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  }</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;}</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160; </div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> std_stats_fill_newpostest(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <a class="code" href="structinfindividual__.html">infindividual</a>* ii, <a class="code" href="structinfindividual__.html">infindividual</a>* parent)</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;{</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keywordflow">if</span>(ii-&gt;<a class="code" href="structinfindividual__.html#a8f343e5dfdd3c37468005cf1567ae3d8">commpertype</a>&amp;ro_commper_true_positive_test) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> trt=floor(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*(ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a>+sv-&gt;<a class="code" href="structsim__vars__.html#aac0335e2677fb786bfaf201d5e4730af">pars</a>.<a class="code" href="structmodel__pars.html#a373b4abb19dc60d1a83f8acbde73b7f7">tdeltat</a>));</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;New pos test at %i\n&quot;</span>,trt);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160; </div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">if</span>(trt&lt;((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;npers) ++(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;newpostest_timeline[trt]);</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;<span class="preprocessor">#ifdef CT_OUTPUT</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    ((uint32_t*)ii-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[1]=++(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;curctid);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;True positive test with ID %u\n&quot;</span>,((uint32_t*)ii-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[1]);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    ((uint32_t*)ii-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[2]=0;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    int32_t i;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keyword">const</span> int32_t end_comm_per_i=floor(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*(ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a>+sv-&gt;<a class="code" href="structsim__vars__.html#aac0335e2677fb786bfaf201d5e4730af">pars</a>.<a class="code" href="structmodel__pars.html#a373b4abb19dc60d1a83f8acbde73b7f7">tdeltat</a>+((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;npostestmaxnpers));</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordflow">for</span>(i=(end_comm_per_i&gt;=((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;npers?((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;npers-1:end_comm_per_i); i&gt;=trt; --i) ++(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;postest_timeline[i]);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;  }</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;}</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;<span class="comment"> * @brief Initialises the processing variable for a new infectious individual.</span></div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;<span class="comment"> * This function initialises the number of infections from a new infectious</span></div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;<span class="comment"> * individual to zero. It is only called for infectious individuals that</span></div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;<span class="comment"> * participate to a non-zero number of transmission events, except for a primary</span></div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;<span class="comment"> * individual.</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment"> * @param ii: Infectious individual.</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;<span class="comment"> * @param parent: Infectious individual&#39;s parent.</span></div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;<span class="comment"> **/</span></div>
<div class="line"><a name="l00588"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#a53fee977873ddf8eecd7d65b2989e2ca">  588</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#a53fee977873ddf8eecd7d65b2989e2ca">std_stats_new_inf</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <a class="code" href="structinfindividual__.html">infindividual</a>* ii, <a class="code" href="structinfindividual__.html">infindividual</a>* parent)</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;{</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  ((uint32_t*)ii-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[0]=0;</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;%s: Number of infections initialized to 0.\n&quot;</span>,__func__);</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  <span class="comment">//++(*(uint32_t*)(ii-1)-&gt;dataptr);</span></div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  <span class="comment">//DEBUG_PRINTF(&quot;Number of parent infections incremented to %u\n&quot;,*(uint32_t*)(ii-1)-&gt;dataptr);</span></div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;%s\n&quot;</span>,__func__);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  std_stats_fill_newpostest(sv, ii, parent);</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;}</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160; </div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> std_stats_fill_inf_ext_n(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <a class="code" href="structinfindividual__.html">infindividual</a>* ii)</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;{</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> start_comm_per=ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a>-ii-&gt;<a class="code" href="structinfindividual__.html#aedd8dfe34765f625e26c6a6b8df1f256">comm_period</a>;</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="keyword">const</span> int32_t start_latent_per_i=floor(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*(ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a>-(ii-&gt;<a class="code" href="structinfindividual__.html#aedd8dfe34765f625e26c6a6b8df1f256">comm_period</a>+ii-&gt;<a class="code" href="structinfindividual__.html#a73ff6b59c26c18648028348587cab820">latent_period</a>)));</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;  <span class="keyword">const</span> int32_t end_comm_per_i=(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a> &gt;= ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;npers ? ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;npers-1 : floor(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a>));</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  int32_t i;</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160; </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keywordflow">if</span>(start_comm_per&lt;sv-&gt;pars.tmax) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keyword">const</span> int32_t start_comm_per_i=floor(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*start_comm_per);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;ext_timeline[start_comm_per_i].rsum+=((uint32_t*)ii-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[0];</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;ext_timeline[start_comm_per_i].n+=1;</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;ext_timeline[start_comm_per_i].commpersum+=ii-&gt;<a class="code" href="structinfindividual__.html#aedd8dfe34765f625e26c6a6b8df1f256">comm_period</a>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;<span class="preprocessor">#ifdef NUMEVENTSSTATS</span></div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;ext_timeline[start_comm_per_i].neventssum+=ii-&gt;<a class="code" href="structinfindividual__.html#a265ce6455f805f932484cb6bdd8a1514">nevents</a>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160; </div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordflow">for</span>(i=start_latent_per_i; i&lt;=end_comm_per_i; ++i) {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    ++(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;inf_timeline[i]);</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  }</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;}</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;<span class="comment"> * @brief Process the statistics after the last transmission event for an</span></div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;<span class="comment"> * infectious individual that participates to some transmission events.</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;<span class="comment"> * After an infectious infectious individual participated to its last</span></div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;<span class="comment"> * transmission event, this function adds the total number of infections from</span></div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;<span class="comment"> * the individual to the R sum, the individual&#39;s communicable period to the sum</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment"> * of communicable periods and the number of transmission events this individual</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment"> * participated to to the sum of events. If the individual was still infectious</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment"> * at tmax, then the path is set to not go extinct. Otherwise, the</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;<span class="comment"> * extinction time for the generating path is updated if its current value was</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;<span class="comment"> * exceeded, using the current event time for the individual&#39;s parent and the</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;<span class="comment"> * individual&#39;s communicable period. The timeline for the number of infectious</span></div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;<span class="comment"> * individuals is also updated.</span></div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;<span class="comment"> * @param ii: Infectious individual.</span></div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;<span class="comment"> * @param parent: Infectious individual&#39;s parent.</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment"> **/</span></div>
<div class="line"><a name="l00640"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#a13d5065aa4bf250cc1285273b0931efb">  640</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#a13d5065aa4bf250cc1285273b0931efb">std_stats_end_inf</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <a class="code" href="structinfindividual__.html">infindividual</a>* ii, <a class="code" href="structinfindividual__.html">infindividual</a>* parent)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;{</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;Number of infections was %u\n&quot;</span>,((uint32_t*)ii-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[0]);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;<span class="preprocessor">#ifdef CT_OUTPUT</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  <span class="keywordflow">if</span>(ii-&gt;<a class="code" href="structinfindividual__.html#a8f343e5dfdd3c37468005cf1567ae3d8">commpertype</a>&amp;ro_commper_true_positive_test) std_stats_add_ct_entry((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>, ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a>+sv-&gt;<a class="code" href="structsim__vars__.html#aac0335e2677fb786bfaf201d5e4730af">pars</a>.<a class="code" href="structmodel__pars.html#a373b4abb19dc60d1a83f8acbde73b7f7">tdeltat</a>, ((ii-&gt;<a class="code" href="structinfindividual__.html#a8f343e5dfdd3c37468005cf1567ae3d8">commpertype</a>&amp;ro_commper_alt)?ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a>-ii-&gt;<a class="code" href="structinfindividual__.html#aedd8dfe34765f625e26c6a6b8df1f256">comm_period</a>+ii-&gt;presym_comm_period:INFINITY), ((uint32_t*)ii-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[1], ((ii-&gt;<a class="code" href="structinfindividual__.html#a8f343e5dfdd3c37468005cf1567ae3d8">commpertype</a>&amp;ro_commper_int)?((uint32_t*)parent-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[1]:0), ((uint32_t*)ii-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[2]);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160; </div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="comment">//If truncated by tmax</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  <span class="keywordflow">if</span>(ii-&gt;<a class="code" href="structinfindividual__.html#a8f343e5dfdd3c37468005cf1567ae3d8">commpertype</a>&amp;ro_commper_tmax) ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;extinction=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">//++((std_summary_stats*)sv-&gt;dataptr)-&gt;n_ended_infections;</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordflow">if</span>(ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a> &gt; ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;extinction_time) ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;extinction_time=ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a>;</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  }</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  std_stats_fill_inf_ext_n(sv, ii);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;}</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;<span class="comment"> * @brief Process the statistics after the last transmission event for an</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;<span class="comment"> * infectious individual that participates to some transmission events and</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;<span class="comment"> * record the number of infections generated by each infectious individual.</span></div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;<span class="comment"> * In addition to calling the function std_stats_end_inf, this function records</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;<span class="comment"> * the number of infections generated by each infectious individual.</span></div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;<span class="comment"> * @param ii: Infectious individual.</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;<span class="comment"> * @param parent: Infectious individual&#39;s parent.</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="comment"> **/</span></div>
<div class="line"><a name="l00672"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#af4d186529dfe09f87c681cb9b00982d1">  672</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#af4d186529dfe09f87c681cb9b00982d1">std_stats_end_inf_rec_ninfs</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <a class="code" href="structinfindividual__.html">infindividual</a>* ii, <a class="code" href="structinfindividual__.html">infindividual</a>* parent)</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;{</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> start_comm_per=ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a>-ii-&gt;<a class="code" href="structinfindividual__.html#aedd8dfe34765f625e26c6a6b8df1f256">comm_period</a>;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="keywordflow">if</span>(start_comm_per&lt;sv-&gt;pars.tmax) {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <a class="code" href="structstd__summary__stats.html">std_summary_stats</a>* <span class="keyword">const</span> stats=(<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keywordflow">if</span>(((uint32_t*)ii-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[0] &gt;= stats-&gt;<a class="code" href="structstd__summary__stats.html#ae7b791ae4143018fe9cd72df38039d30">ninfbins</a>) {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      stats-&gt;<a class="code" href="structstd__summary__stats.html#ae7b791ae4143018fe9cd72df38039d30">ninfbins</a>=((uint32_t*)ii-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[0]+1;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <span class="keywordflow">if</span>(stats-&gt;<a class="code" href="structstd__summary__stats.html#ae7b791ae4143018fe9cd72df38039d30">ninfbins</a>&gt;stats-&gt;<a class="code" href="structstd__summary__stats.html#a674edafa7c2d58245fe239b50d59410b">nainfbins</a>) {</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;    <a class="code" href="structext__timeline__info.html">ext_timeline_info</a>* <span class="keyword">const</span> set=stats-&gt;<a class="code" href="structstd__summary__stats.html#a0bd89cf4c05f92f384a148c39ff44dbe">ext_timeline</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">tlshifta</a>;</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    int32_t i;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <span class="keyword">const</span> uint32_t dnbins=stats-&gt;<a class="code" href="structstd__summary__stats.html#ae7b791ae4143018fe9cd72df38039d30">ninfbins</a>-stats-&gt;<a class="code" href="structstd__summary__stats.html#a674edafa7c2d58245fe239b50d59410b">nainfbins</a>;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">for</span>(i=stats-&gt;<a class="code" href="structstd__summary__stats.html#a8c36935604a78b458da7ab1404453c71">tnpersa</a>-1; i&gt;=0; --i) {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      set[i].<a class="code" href="structext__timeline__info.html#aeca0daef2a8c5553596ea7871f4b4946">ngeninfs</a>=(uint64_t*)realloc(set[i].ngeninfs,stats-&gt;<a class="code" href="structstd__summary__stats.html#ae7b791ae4143018fe9cd72df38039d30">ninfbins</a>*<span class="keyword">sizeof</span>(uint64_t));</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      <span class="comment">//printf(&quot;ext_timeline[%i].ngeninfs=%p\n&quot;,i-stats-&gt;tlshifta,set[i].ngeninfs);</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;      memset(set[i].ngeninfs+stats-&gt;<a class="code" href="structstd__summary__stats.html#a674edafa7c2d58245fe239b50d59410b">nainfbins</a>,0,dnbins*<span class="keyword">sizeof</span>(uint64_t));</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    }</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    stats-&gt;<a class="code" href="structstd__summary__stats.html#a674edafa7c2d58245fe239b50d59410b">nainfbins</a>=stats-&gt;<a class="code" href="structstd__summary__stats.html#ae7b791ae4143018fe9cd72df38039d30">ninfbins</a>;</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;      }</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keyword">const</span> int32_t start_comm_per_i=floor(stats-&gt;<a class="code" href="structstd__summary__stats.html#a88045dcbad084a2bdca7c0d537aa7d79">nbinsperunit</a>*start_comm_per);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    ++(stats-&gt;<a class="code" href="structstd__summary__stats.html#a0bd89cf4c05f92f384a148c39ff44dbe">ext_timeline</a>[start_comm_per_i].<a class="code" href="structext__timeline__info.html#aeca0daef2a8c5553596ea7871f4b4946">ngeninfs</a>[((uint32_t*)ii-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[0]]);</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;  }</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160; </div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a13d5065aa4bf250cc1285273b0931efb">std_stats_end_inf</a>(sv, ii, parent);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;}</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;<span class="comment"> * @brief Process the statistics for an infectious individual that does not</span></div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;<span class="comment"> * participate to any transmission event.</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;<span class="comment"> * This function adds the individual&#39;s communicable period to the sum</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;<span class="comment"> * of communicable periods. If the individual was still infectious</span></div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;<span class="comment"> * at tmax, then the path is set to not go extinct. Otherwise, the</span></div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;<span class="comment"> * extinction time for the generating path is updated if its current value was</span></div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="comment"> * exceeded, using the current event time for the individual&#39;s parent and the</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment"> * individual&#39;s communicable period. The timeline for the number of infectious</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;<span class="comment"> * individuals is also updated.</span></div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment"> * @param ii: Pointer to the infectious individual.</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment"> * @param parent: Pointer to the infectious individual&#39;s parent.</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment"> **/</span></div>
<div class="line"><a name="l00718"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#a6c4c236eb0280b89b3501b7d3050fa1f">  718</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#a6c4c236eb0280b89b3501b7d3050fa1f">std_stats_noevent_new_inf</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <a class="code" href="structinfindividual__.html">infindividual</a>* ii, <a class="code" href="structinfindividual__.html">infindividual</a>* parent)</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;{</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;%s\n&quot;</span>,__func__);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;Number of infections was 0\n&quot;</span>);</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  ((uint32_t*)ii-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[0]=0;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  std_stats_fill_newpostest(sv, ii, parent);</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;<span class="preprocessor">#ifdef CT_OUTPUT</span></div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keywordflow">if</span>(ii-&gt;<a class="code" href="structinfindividual__.html#a8f343e5dfdd3c37468005cf1567ae3d8">commpertype</a>&amp;ro_commper_true_positive_test) std_stats_add_ct_entry((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>, ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a>+sv-&gt;<a class="code" href="structsim__vars__.html#aac0335e2677fb786bfaf201d5e4730af">pars</a>.<a class="code" href="structmodel__pars.html#a373b4abb19dc60d1a83f8acbde73b7f7">tdeltat</a>, ((ii-&gt;<a class="code" href="structinfindividual__.html#a8f343e5dfdd3c37468005cf1567ae3d8">commpertype</a>&amp;ro_commper_alt)?ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a>-ii-&gt;<a class="code" href="structinfindividual__.html#aedd8dfe34765f625e26c6a6b8df1f256">comm_period</a>+ii-&gt;presym_comm_period:INFINITY), ((uint32_t*)ii-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[1], ((ii-&gt;<a class="code" href="structinfindividual__.html#a8f343e5dfdd3c37468005cf1567ae3d8">commpertype</a>&amp;ro_commper_int)?((uint32_t*)parent-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[1]:0), ((uint32_t*)ii-&gt;<a class="code" href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">dataptr</a>)[2]);</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="comment">//If truncated by tmax</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordflow">if</span>(ii-&gt;<a class="code" href="structinfindividual__.html#a8f343e5dfdd3c37468005cf1567ae3d8">commpertype</a>&amp;ro_commper_tmax) ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;extinction=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="comment">//++((std_summary_stats*)sv-&gt;dataptr)-&gt;n_ended_infections;</span></div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160; </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;    <span class="keywordflow">if</span>(ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a> &gt; ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;extinction_time) ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;extinction_time=ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  }</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  std_stats_fill_inf_ext_n(sv, ii);</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;}</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="comment"> * @brief Process the statistics for an infectious individual that does not</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;<span class="comment"> * participate to any transmission event and record the number of infections</span></div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;<span class="comment"> * generated by each infectious individual.</span></div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;<span class="comment"> * In addition to calling the function std_stats_noevent_new_inf, this function records</span></div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;<span class="comment"> * the number of infections generated by each infectious individual.</span></div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment"> * @param ii: Pointer to the infectious individual.</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="comment"> * @param parent: Pointer to the infectious individual&#39;s parent.</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;<span class="comment"> **/</span></div>
<div class="line"><a name="l00755"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#a01df514c53bd28758cb76b012b250e8c">  755</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#a01df514c53bd28758cb76b012b250e8c">std_stats_noevent_new_inf_rec_ninfs</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <a class="code" href="structinfindividual__.html">infindividual</a>* ii, <a class="code" href="structinfindividual__.html">infindividual</a>* parent)</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;{</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> start_comm_per=ii-&gt;<a class="code" href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">end_comm_period</a>-ii-&gt;<a class="code" href="structinfindividual__.html#aedd8dfe34765f625e26c6a6b8df1f256">comm_period</a>;</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keywordflow">if</span>(start_comm_per&lt;sv-&gt;pars.tmax) {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keyword">const</span> int32_t start_comm_per_i=floor(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nbinsperunit*start_comm_per);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    ++(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;ext_timeline[start_comm_per_i].ngeninfs[0]);</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;  }</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160; </div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a6c4c236eb0280b89b3501b7d3050fa1f">std_stats_noevent_new_inf</a>(sv, ii, parent);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;}</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="astandard__summary__stats_8h_html_a89a2c20f5ae6364539f0fabc3a7da903"><div class="ttname"><a href="standard__summary__stats_8h.html#a89a2c20f5ae6364539f0fabc3a7da903">std_stats_new_event_npostestmax</a></div><div class="ttdeci">static bool std_stats_new_event_npostestmax(sim_vars *sv)</div><div class="ttdoc">Processes the number of infections for this new event.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00519">standard_summary_stats.h:519</a></div></div>
<div class="ttc" id="astructsim__vars___html_ad9d50be547359a56e26030911f2d3d96"><div class="ttname"><a href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">sim_vars_::dataptr</a></div><div class="ttdeci">void * dataptr</div><div class="ttdoc">Simulation-level data pointer for user-defined functions.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00043">simulation.h:43</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_acbd17fcad2eb7abd3430ec4ff8275d3d"><div class="ttname"><a href="structstd__summary__stats.html#acbd17fcad2eb7abd3430ec4ff8275d3d">std_summary_stats::extinction_time</a></div><div class="ttdeci">double extinction_time</div><div class="ttdoc">*Path extinction time, if any.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00056">standard_summary_stats.h:56</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_ac35116c06c0b121db7de1e4edb6a6f9e"><div class="ttname"><a href="standard__summary__stats_8h.html#ac35116c06c0b121db7de1e4edb6a6f9e">std_stats_path_init</a></div><div class="ttdeci">static void std_stats_path_init(std_summary_stats *stats)</div><div class="ttdoc">Initialises elements of the standard summary statistics before a path simulation.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00111">standard_summary_stats.h:111</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html"><div class="ttname"><a href="structstd__summary__stats.html">std_summary_stats</a></div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00054">standard_summary_stats.h:54</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a674edafa7c2d58245fe239b50d59410b"><div class="ttname"><a href="structstd__summary__stats.html#a674edafa7c2d58245fe239b50d59410b">std_summary_stats::nainfbins</a></div><div class="ttdeci">uint32_t nainfbins</div><div class="ttdoc">Number of allocated infectious individual bins.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00065">standard_summary_stats.h:65</a></div></div>
<div class="ttc" id="astructinfindividual___html_a73ff6b59c26c18648028348587cab820"><div class="ttname"><a href="structinfindividual__.html#a73ff6b59c26c18648028348587cab820">infindividual_::latent_period</a></div><div class="ttdeci">double latent_period</div><div class="ttdoc">Latent period.</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00030">infindividual.h:30</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a3b9774d0359ac227a1419a63bfb1b9ef"><div class="ttname"><a href="structstd__summary__stats.html#a3b9774d0359ac227a1419a63bfb1b9ef">std_summary_stats::timerelfirstpostestresults</a></div><div class="ttdeci">bool timerelfirstpostestresults</div><div class="ttdoc">Indicate that the output time values are relative to the time of the first positive test results....</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00088">standard_summary_stats.h:88</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a9f1399b1a96c10fc895ca4138cc0cae0"><div class="ttname"><a href="structstd__summary__stats.html#a9f1399b1a96c10fc895ca4138cc0cae0">std_summary_stats::newinf_timeline</a></div><div class="ttdeci">uint32_t * newinf_timeline</div><div class="ttdoc">For each integer interval between 0 and floor(nbinsperunit*tmax)-1, the number of individuals that ge...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00058">standard_summary_stats.h:58</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_af6b54552d1d6d46d9d8ac8ad1e11fa2f"><div class="ttname"><a href="structstd__summary__stats.html#af6b54552d1d6d46d9d8ac8ad1e11fa2f">std_summary_stats::tlppt0idx</a></div><div class="ttdeci">int32_t tlppt0idx</div><div class="ttdoc">Timeline post-processing t=0 index.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00078">standard_summary_stats.h:78</a></div></div>
<div class="ttc" id="astructsim__vars___html_aac0335e2677fb786bfaf201d5e4730af"><div class="ttname"><a href="structsim__vars__.html#aac0335e2677fb786bfaf201d5e4730af">sim_vars_::pars</a></div><div class="ttdeci">model_pars pars</div><div class="ttdoc">Simulation input parameters.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00040">simulation.h:40</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a2e396b075b2f47ad38cc6cabc3cbeb16"><div class="ttname"><a href="structstd__summary__stats.html#a2e396b075b2f47ad38cc6cabc3cbeb16">std_summary_stats::tlppnnpers</a></div><div class="ttdeci">int32_t tlppnnpers</div><div class="ttdoc">Timeline post-processing number of negative periods.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00079">standard_summary_stats.h:79</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_ab645fb6d8a87ea6a3ef37fe05570cc56"><div class="ttname"><a href="standard__summary__stats_8h.html#ab645fb6d8a87ea6a3ef37fe05570cc56">std_stats_pri_init_rel</a></div><div class="ttdeci">static void std_stats_pri_init_rel(sim_vars *sv, infindividual *ii)</div><div class="ttdoc">Allocates memory for a new primary individual.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00313">standard_summary_stats.h:313</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_a5c8ef3c24dad2c469a42784a9a39403b"><div class="ttname"><a href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a></div><div class="ttdeci">#define DEBUG_PRINTF(...)</div><div class="ttdoc">Debug print function.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00027">standard_summary_stats.h:27</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_ab24cc3e00ea54bfefbfad70baf4981c2"><div class="ttname"><a href="structstd__summary__stats.html#ab24cc3e00ea54bfefbfad70baf4981c2">std_summary_stats::pp_newpostest_timeline</a></div><div class="ttdeci">uint32_t * pp_newpostest_timeline</div><div class="ttdoc">Post-processing timeline. For each integer interval between 0 and floor(nbinsperunit*tmax),...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00063">standard_summary_stats.h:63</a></div></div>
<div class="ttc" id="astructinfindividual___html"><div class="ttname"><a href="structinfindividual__.html">infindividual_</a></div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00027">infindividual.h:27</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a1a4469f6d6346c2c1218880021c3189a"><div class="ttname"><a href="structstd__summary__stats.html#a1a4469f6d6346c2c1218880021c3189a">std_summary_stats::newpostest_timeline</a></div><div class="ttdeci">uint32_t * newpostest_timeline</div><div class="ttdoc">For each integer interval between 0 and floor(nbinsperunit*tmax), the number of individuals that rece...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00060">standard_summary_stats.h:60</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a8c36935604a78b458da7ab1404453c71"><div class="ttname"><a href="structstd__summary__stats.html#a8c36935604a78b458da7ab1404453c71">std_summary_stats::tnpersa</a></div><div class="ttdeci">uint32_t tnpersa</div><div class="ttdoc">*Total number of allocated integer intervals (negative+positive)</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00077">standard_summary_stats.h:77</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_a6c4c236eb0280b89b3501b7d3050fa1f"><div class="ttname"><a href="standard__summary__stats_8h.html#a6c4c236eb0280b89b3501b7d3050fa1f">std_stats_noevent_new_inf</a></div><div class="ttdeci">static void std_stats_noevent_new_inf(sim_vars *sv, infindividual *ii, infindividual *parent)</div><div class="ttdoc">Process the statistics for an infectious individual that does not participate to any transmission eve...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00718">standard_summary_stats.h:718</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a004bedeff4c407696e0681fe1b5c470a"><div class="ttname"><a href="structstd__summary__stats.html#a004bedeff4c407696e0681fe1b5c470a">std_summary_stats::tlshift</a></div><div class="ttdeci">int32_t tlshift</div><div class="ttdoc">*Integral shift of the timeline origin (to allow for negative time bins). Corresponds also to the num...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00076">standard_summary_stats.h:76</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_acd11be3b63130e0de5173f46fb718642"><div class="ttname"><a href="structstd__summary__stats.html#acd11be3b63130e0de5173f46fb718642">std_summary_stats::postest_timeline</a></div><div class="ttdeci">uint32_t * postest_timeline</div><div class="ttdoc">For each integer interval between 0 and floor(nbinsperunit*tmax)-1, the number of individuals that ha...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00059">standard_summary_stats.h:59</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a8e83d6a8048fe685966daa2fc88b9786"><div class="ttname"><a href="structstd__summary__stats.html#a8e83d6a8048fe685966daa2fc88b9786">std_summary_stats::nimax</a></div><div class="ttdeci">uint32_t nimax</div><div class="ttdoc">Maximum number of infectious individuals for a given integer interval between 0 and floor(nbinsperuni...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00082">standard_summary_stats.h:82</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_af4d186529dfe09f87c681cb9b00982d1"><div class="ttname"><a href="standard__summary__stats_8h.html#af4d186529dfe09f87c681cb9b00982d1">std_stats_end_inf_rec_ninfs</a></div><div class="ttdeci">static void std_stats_end_inf_rec_ninfs(sim_vars *sv, infindividual *ii, infindividual *parent)</div><div class="ttdoc">Process the statistics after the last transmission event for an infectious individual that participat...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00672">standard_summary_stats.h:672</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_aec5a65871a38a80d6a609baef1c314fe"><div class="ttname"><a href="standard__summary__stats_8h.html#aec5a65871a38a80d6a609baef1c314fe">std_stats_new_event</a></div><div class="ttdeci">static bool std_stats_new_event(sim_vars *sv)</div><div class="ttdoc">Processes the number of infections for this new event.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00430">standard_summary_stats.h:430</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a68ed8f4856c0c06225b77e25e1ba56e6"><div class="ttname"><a href="structstd__summary__stats.html#a68ed8f4856c0c06225b77e25e1ba56e6">std_summary_stats::lmax</a></div><div class="ttdeci">uint32_t lmax</div><div class="ttdoc">Maximum number of layers for the simulation. lmax=1 means only primary infectious individuals.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00081">standard_summary_stats.h:81</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_ae7b791ae4143018fe9cd72df38039d30"><div class="ttname"><a href="structstd__summary__stats.html#ae7b791ae4143018fe9cd72df38039d30">std_summary_stats::ninfbins</a></div><div class="ttdeci">uint32_t ninfbins</div><div class="ttdoc">Number of used infectious individual bins.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00066">standard_summary_stats.h:66</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_a6817859a53a32feb92636e9986da48cb"><div class="ttname"><a href="standard__summary__stats_8h.html#a6817859a53a32feb92636e9986da48cb">std_stats_ii_alloc</a></div><div class="ttdeci">static void std_stats_ii_alloc(infindividual *ii)</div><div class="ttdoc">Allocates memory for the user-defined function data.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00388">standard_summary_stats.h:388</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a0d8063962cd1061921d5988aed3009cb"><div class="ttname"><a href="structstd__summary__stats.html#a0d8063962cd1061921d5988aed3009cb">std_summary_stats::tlshifta</a></div><div class="ttdeci">int32_t tlshifta</div><div class="ttdoc">*Allocated integral shift of the timeline origin (to allow for negative time bins)....</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00075">standard_summary_stats.h:75</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a81431467e8f5b95dac9f75b26fb23785"><div class="ttname"><a href="structstd__summary__stats.html#a81431467e8f5b95dac9f75b26fb23785">std_summary_stats::tlpptnvpers</a></div><div class="ttdeci">uint32_t tlpptnvpers</div><div class="ttdoc">Timeline post-processing total number of valid periods.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00080">standard_summary_stats.h:80</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_ae164276299e063211e451d40224ab885"><div class="ttname"><a href="structstd__summary__stats.html#ae164276299e063211e451d40224ab885">std_summary_stats::npostestmax</a></div><div class="ttdeci">uint32_t npostestmax</div><div class="ttdoc">Maximum number of positive test results during an interval of duration npostestmaxnpers for each indi...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00083">standard_summary_stats.h:83</a></div></div>
<div class="ttc" id="astructext__timeline__info_html_aeca0daef2a8c5553596ea7871f4b4946"><div class="ttname"><a href="structext__timeline__info.html#aeca0daef2a8c5553596ea7871f4b4946">ext_timeline_info::ngeninfs</a></div><div class="ttdeci">uint64_t * ngeninfs</div><div class="ttdoc">Number of generated infections from each infectious individual in the timeline bin.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00048">standard_summary_stats.h:48</a></div></div>
<div class="ttc" id="astructinfindividual___html_ad5f5a0c02b49b1f8eaa9809e378100ae"><div class="ttname"><a href="structinfindividual__.html#ad5f5a0c02b49b1f8eaa9809e378100ae">infindividual_::event_time</a></div><div class="ttdeci">double event_time</div><div class="ttdoc">Start time for the current iteration event.</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00037">infindividual.h:37</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_aa38a2d7cde0950dcc13f741f49b12782"><div class="ttname"><a href="standard__summary__stats_8h.html#aa38a2d7cde0950dcc13f741f49b12782">std_stats_free</a></div><div class="ttdeci">void std_stats_free(std_summary_stats *stats)</div><div class="ttdoc">Frees memory used by the standard summary statistics.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8c_source.html#l00048">standard_summary_stats.c:48</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_ac229de531e51ab996d8d9943836a81df"><div class="ttname"><a href="structstd__summary__stats.html#ac229de531e51ab996d8d9943836a81df">std_summary_stats::extinction</a></div><div class="ttdeci">bool extinction</div><div class="ttdoc">*Set to true if extinction does not occur before tmax.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00087">standard_summary_stats.h:87</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_a43b768c341a076d5e5b2253b9dfab9de"><div class="ttname"><a href="standard__summary__stats_8h.html#a43b768c341a076d5e5b2253b9dfab9de">std_stats_new_event_nimax</a></div><div class="ttdeci">static bool std_stats_new_event_nimax(sim_vars *sv)</div><div class="ttdoc">Processes the number of infections for this new event.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00464">standard_summary_stats.h:464</a></div></div>
<div class="ttc" id="astructinfindividual___html_a8f343e5dfdd3c37468005cf1567ae3d8"><div class="ttname"><a href="structinfindividual__.html#a8f343e5dfdd3c37468005cf1567ae3d8">infindividual_::commpertype</a></div><div class="ttdeci">uint8_t commpertype</div><div class="ttdoc">Flags for the type of communicable period (filled using ro_commper_type flags)</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00047">infindividual.h:47</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_acc1e7914a73488e5ae0f119a4ea976bf"><div class="ttname"><a href="structstd__summary__stats.html#acc1e7914a73488e5ae0f119a4ea976bf">std_summary_stats::pp_newinf_timeline</a></div><div class="ttdeci">uint32_t * pp_newinf_timeline</div><div class="ttdoc">Post-processing timeline. For each integer interval between 0 and floor(nbinsperunit*tmax)-1,...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00062">standard_summary_stats.h:62</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a40874a46f008c64e6ad71312da1c3e04"><div class="ttname"><a href="structstd__summary__stats.html#a40874a46f008c64e6ad71312da1c3e04">std_summary_stats::inf_timeline</a></div><div class="ttdeci">uint32_t * inf_timeline</div><div class="ttdoc">For each integer interval between 0 and floor(nbinsperunit*tmax)-1, the number of individuals that ar...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00057">standard_summary_stats.h:57</a></div></div>
<div class="ttc" id="astructmodel__pars_html_aac4af9226e4d189e42d148ce178f4033"><div class="ttname"><a href="structmodel__pars.html#aac4af9226e4d189e42d148ce178f4033">model_pars::tmax</a></div><div class="ttdeci">double tmax</div><div class="ttdoc">Maximum simulation period used to instantiate new infectious individuals.</div><div class="ttdef"><b>Definition:</b> <a href="model__parameters_8h_source.html#l00091">model_parameters.h:91</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a5692c490e4607c8ac651ee17d3e98ab0"><div class="ttname"><a href="structstd__summary__stats.html#a5692c490e4607c8ac651ee17d3e98ab0">std_summary_stats::npers</a></div><div class="ttdeci">int32_t npers</div><div class="ttdoc">Number of positive integer intervals.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00073">standard_summary_stats.h:73</a></div></div>
<div class="ttc" id="astructbrsim__vars_html_a6054ce18695f531e35cedac4a48af522"><div class="ttname"><a href="structbrsim__vars.html#a6054ce18695f531e35cedac4a48af522">brsim_vars::iis</a></div><div class="ttdeci">infindividual * iis</div><div class="ttdoc">Array of current infectious individuals across all layers.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00027">simulation.h:27</a></div></div>
<div class="ttc" id="astructext__timeline__info_html_aed11afcf2a1f604436e380df85ab18ec"><div class="ttname"><a href="structext__timeline__info.html#aed11afcf2a1f604436e380df85ab18ec">ext_timeline_info::n</a></div><div class="ttdeci">uint32_t n</div><div class="ttdoc">Number of infectious creating infections in the timeline bin.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00042">standard_summary_stats.h:42</a></div></div>
<div class="ttc" id="astructext__timeline__info_html_ad53abeb4eebe50d38b9dfa8603e454f3"><div class="ttname"><a href="structext__timeline__info.html#ad53abeb4eebe50d38b9dfa8603e454f3">ext_timeline_info::rsum</a></div><div class="ttdeci">uint32_t rsum</div><div class="ttdoc">Sum of the number of individuals that get infected in the timeline bin.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00043">standard_summary_stats.h:43</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a0bd89cf4c05f92f384a148c39ff44dbe"><div class="ttname"><a href="structstd__summary__stats.html#a0bd89cf4c05f92f384a148c39ff44dbe">std_summary_stats::ext_timeline</a></div><div class="ttdeci">ext_timeline_info * ext_timeline</div><div class="ttdoc">Extended timeline for parameters that cannot correctly be calculated when a dynamic time cur is used.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00064">standard_summary_stats.h:64</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a250cff9a07ba69ccb2c04905b004f91d"><div class="ttname"><a href="structstd__summary__stats.html#a250cff9a07ba69ccb2c04905b004f91d">std_summary_stats::pp_inf_timeline</a></div><div class="ttdeci">uint32_t * pp_inf_timeline</div><div class="ttdoc">Post-processing timeline. For each integer interval between 0 and floor(nbinsperunit*tmax)-1,...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00061">standard_summary_stats.h:61</a></div></div>
<div class="ttc" id="astructmodel__pars_html_a373b4abb19dc60d1a83f8acbde73b7f7"><div class="ttname"><a href="structmodel__pars.html#a373b4abb19dc60d1a83f8acbde73b7f7">model_pars::tdeltat</a></div><div class="ttdeci">double tdeltat</div><div class="ttdoc">Time delay between the end of the applicable communicable period and test results.</div><div class="ttdef"><b>Definition:</b> <a href="model__parameters_8h_source.html#l00090">model_parameters.h:90</a></div></div>
<div class="ttc" id="astructsim__vars___html_a93f0830501be49887bb29a25db7314f1"><div class="ttname"><a href="structsim__vars__.html#a93f0830501be49887bb29a25db7314f1">sim_vars_::curii</a></div><div class="ttdeci">infindividual * curii</div><div class="ttdoc">Pointer to current iteration infectious individual.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00042">simulation.h:42</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_ab174bf9afad860d56a639cf6081494e4"><div class="ttname"><a href="structstd__summary__stats.html#ab174bf9afad860d56a639cf6081494e4">std_summary_stats::npostestmaxnpers</a></div><div class="ttdeci">uint32_t npostestmaxnpers</div><div class="ttdoc">Interval duration for the maximum number of positive test results.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00084">standard_summary_stats.h:84</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a5b91639bfd5662d72eb30e80629f3afb"><div class="ttname"><a href="structstd__summary__stats.html#a5b91639bfd5662d72eb30e80629f3afb">std_summary_stats::maxedoutmintimeindex</a></div><div class="ttdeci">int32_t maxedoutmintimeindex</div><div class="ttdoc">*Minimum time index which maxed out the allowed number of infected individuals or positive test resul...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00085">standard_summary_stats.h:85</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_a01df514c53bd28758cb76b012b250e8c"><div class="ttname"><a href="standard__summary__stats_8h.html#a01df514c53bd28758cb76b012b250e8c">std_stats_noevent_new_inf_rec_ninfs</a></div><div class="ttdeci">static void std_stats_noevent_new_inf_rec_ninfs(sim_vars *sv, infindividual *ii, infindividual *parent)</div><div class="ttdoc">Process the statistics for an infectious individual that does not participate to any transmission eve...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00755">standard_summary_stats.h:755</a></div></div>
<div class="ttc" id="asimulation_8h_html"><div class="ttname"><a href="simulation_8h.html">simulation.h</a></div><div class="ttdoc">Common simulation data structures and functions.</div></div>
<div class="ttc" id="astructsim__vars___html"><div class="ttname"><a href="structsim__vars__.html">sim_vars_</a></div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00038">simulation.h:38</a></div></div>
<div class="ttc" id="astructinfindividual___html_ab7336fd2e3b9bf73a9a95ae0a6e13062"><div class="ttname"><a href="structinfindividual__.html#ab7336fd2e3b9bf73a9a95ae0a6e13062">infindividual_::ninfections</a></div><div class="ttdeci">uint32_t ninfections</div><div class="ttdoc">Number of infections for the current iteration event.</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00044">infindividual.h:44</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_a53fee977873ddf8eecd7d65b2989e2ca"><div class="ttname"><a href="standard__summary__stats_8h.html#a53fee977873ddf8eecd7d65b2989e2ca">std_stats_new_inf</a></div><div class="ttdeci">static void std_stats_new_inf(sim_vars *sv, infindividual *ii, infindividual *parent)</div><div class="ttdoc">Initialises the processing variable for a new infectious individual.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00588">standard_summary_stats.h:588</a></div></div>
<div class="ttc" id="astructinfindividual___html_adff620382697d8b2a0c3d275d0c02295"><div class="ttname"><a href="structinfindividual__.html#adff620382697d8b2a0c3d275d0c02295">infindividual_::dataptr</a></div><div class="ttdeci">void * dataptr</div><div class="ttdoc">Data pointer for user-defined functions.</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00029">infindividual.h:29</a></div></div>
<div class="ttc" id="astructext__timeline__info_html_a07d1c95137114d8b33cac91c14d1d736"><div class="ttname"><a href="structext__timeline__info.html#a07d1c95137114d8b33cac91c14d1d736">ext_timeline_info::commpersum</a></div><div class="ttdeci">double commpersum</div><div class="ttdoc">Sum of communicable periods for all infectious individuals whose communicable period start before tma...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00044">standard_summary_stats.h:44</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_a7e48bd471bfd6ac6f97a903ac3e2ade0"><div class="ttname"><a href="standard__summary__stats_8h.html#a7e48bd471bfd6ac6f97a903ac3e2ade0">std_stats_init</a></div><div class="ttdeci">void std_stats_init(sim_vars *sv, const uint32_t nbinsperunit, bool ngeninfs, bool timerelfirstpostestresults)</div><div class="ttdoc">Initialises the standard summary statistics.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8c_source.html#l00009">standard_summary_stats.c:9</a></div></div>
<div class="ttc" id="astructext__timeline__info_html"><div class="ttname"><a href="structext__timeline__info.html">ext_timeline_info</a></div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00040">standard_summary_stats.h:40</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_a15f6d86b1bc2a5fccbdbf58c480476c0"><div class="ttname"><a href="standard__summary__stats_8h.html#a15f6d86b1bc2a5fccbdbf58c480476c0">std_stats_path_end</a></div><div class="ttdeci">static void std_stats_path_end(sim_vars *sv)</div><div class="ttdoc">Performs task at the end of a path simulation.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00152">standard_summary_stats.h:152</a></div></div>
<div class="ttc" id="astructinfindividual___html_aedd8dfe34765f625e26c6a6b8df1f256"><div class="ttname"><a href="structinfindividual__.html#aedd8dfe34765f625e26c6a6b8df1f256">infindividual_::comm_period</a></div><div class="ttdeci">double comm_period</div><div class="ttdoc">Communicable period.</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00031">infindividual.h:31</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_a13d5065aa4bf250cc1285273b0931efb"><div class="ttname"><a href="standard__summary__stats_8h.html#a13d5065aa4bf250cc1285273b0931efb">std_stats_end_inf</a></div><div class="ttdeci">static void std_stats_end_inf(sim_vars *sv, infindividual *ii, infindividual *parent)</div><div class="ttdoc">Process the statistics after the last transmission event for an infectious individual that participat...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00640">standard_summary_stats.h:640</a></div></div>
<div class="ttc" id="astructinfindividual___html_a265ce6455f805f932484cb6bdd8a1514"><div class="ttname"><a href="structinfindividual__.html#a265ce6455f805f932484cb6bdd8a1514">infindividual_::nevents</a></div><div class="ttdeci">uint32_t nevents</div><div class="ttdoc">Number of events.</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00038">infindividual.h:38</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a88045dcbad084a2bdca7c0d537aa7d79"><div class="ttname"><a href="structstd__summary__stats.html#a88045dcbad084a2bdca7c0d537aa7d79">std_summary_stats::nbinsperunit</a></div><div class="ttdeci">int32_t nbinsperunit</div><div class="ttdoc">Number of timeline bins per unit of time.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00074">standard_summary_stats.h:74</a></div></div>
<div class="ttc" id="astructinfindividual___html_a1ce2a34976746c00ccd4d6c41485e051"><div class="ttname"><a href="structinfindividual__.html#a1ce2a34976746c00ccd4d6c41485e051">infindividual_::end_comm_period</a></div><div class="ttdeci">double end_comm_period</div><div class="ttdoc">End of communicable period.</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00036">infindividual.h:36</a></div></div>
<div class="ttc" id="ainfindividual_8h_html"><div class="ttname"><a href="infindividual_8h.html">infindividual.h</a></div><div class="ttdoc">Data structure containing infected individual information.</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="standard__summary__stats_8h.html">standard_summary_stats.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
