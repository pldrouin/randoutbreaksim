<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>branchsimc: standard_summary_stats.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">branchsimc
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">branchsimc Outbreak Branching Model Simulation Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('standard__summary__stats_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">standard_summary_stats.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="standard__summary__stats_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * @file standard_summary_stats.h</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * @brief User-defined functions to compute standard summary statistics.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * @author &lt;Pierre-Luc.Drouin@drdc-rddc.gc.ca&gt;, Defence Research and Development Canada Ottawa Research Centre.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160; </div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#ifndef _STANDARD_SUMMARY_STATS_</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#define _STANDARD_SUMMARY_STATS_</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160; </div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;stdbool.h&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="infindividual_8h.html">infindividual.h</a>&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="simulation_8h.html">simulation.h</a>&quot;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#ifdef DEBUG_PRINTF</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#undef DEBUG_PRINTF</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">   19</a></span>&#160;<span class="preprocessor">#define DEBUG_PRINTF(...) </span><span class="comment">//!&lt; Debug print function</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"></span>//#define DEBUG_PRINTF(...) printf(__VA_ARGS__) <span class="comment">//!&lt; Debug print function</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> * Simulation-level standard summary statistics data struct.</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html">   25</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;{</div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#acbd17fcad2eb7abd3430ec4ff8275d3d">   27</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="structstd__summary__stats.html#acbd17fcad2eb7abd3430ec4ff8275d3d">extinction_time</a>;   <span class="comment">//!&lt; Path extinction time, if any.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a0823eb53dc979bc0221c570fa1b0e2d7">   28</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="structstd__summary__stats.html#a0823eb53dc979bc0221c570fa1b0e2d7">commpersum</a>;        <span class="comment">//!&lt; Sum of communicable periods for all infectious individuals whose communicable period does not occur after tmax.</span></div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a40874a46f008c64e6ad71312da1c3e04">   29</a></span>&#160;<span class="comment"></span>  uint32_t* <a class="code" href="structstd__summary__stats.html#a40874a46f008c64e6ad71312da1c3e04">inf_timeline</a>;   <span class="comment">//!&lt; For each integer interval between 0 and floor(tmax), the number of individuals that are infectious at some point in this interval (lower bound included, upper bound excluded).</span></div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a040ab82e792ffcd94c3fda6c22cf6960">   30</a></span>&#160;<span class="comment"></span>  uint32_t* <a class="code" href="structstd__summary__stats.html#a040ab82e792ffcd94c3fda6c22cf6960">totinf_timeline</a>;    <span class="comment">//!&lt; For each integer interval between 0 and floor(tmax), the number of individuals that get infected at some point in this interval (lower bound included, upper bound excluded). For the last interval, it includes the infectious that occur between floor(tmax) and tmax.</span></div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#af9a151e1652f1cbcdd66f9db6780e324">   31</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structstd__summary__stats.html#af9a151e1652f1cbcdd66f9db6780e324">npers</a>;       <span class="comment">//!&lt; Number of integer intervals (floor(tmax)+1)</span></div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#ae3fb94b9986390017590c435ac2fa66f">   32</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structstd__summary__stats.html#ae3fb94b9986390017590c435ac2fa66f">rsum</a>;        <span class="comment">//!&lt; Sum of the number of individuals that get infected during the simulation by the infectious individuals whose last transmission event does not occur after tmax.</span></div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a0b893ea867095df3b5169b9a5fcf026b">   33</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structstd__summary__stats.html#a0b893ea867095df3b5169b9a5fcf026b">neventssum</a>;      <span class="comment">//!&lt; Sum of the number of transmission events for all infectious individuals whose communicable period does not occur after tmax.</span></div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#a8e83d6a8048fe685966daa2fc88b9786">   34</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structstd__summary__stats.html#a8e83d6a8048fe685966daa2fc88b9786">nimax</a>;               <span class="comment">//!&lt; Maximum number of infectious individuals for a given integer inerval between 0 and floor(tmax). Extinction is set to false and the simulation does not proceed further if this maximum is exceeded.</span></div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#afebfc56bb1adf1c61f39f78a5e4e4b6f">   35</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structstd__summary__stats.html#afebfc56bb1adf1c61f39f78a5e4e4b6f">nimaxedoutmintimeindex</a>; <span class="comment">//!&lt; Minimum time index which maxed out the allowed number of infected individuals.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"></span>  <span class="comment">//uint32_t n_ended_infections;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="structstd__summary__stats.html#ac229de531e51ab996d8d9943836a81df">   37</a></span>&#160;  <span class="keywordtype">bool</span> <a class="code" href="structstd__summary__stats.html#ac229de531e51ab996d8d9943836a81df">extinction</a>;      <span class="comment">//!&lt; Set to true if extinction does not occur before or at tmax.</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span>} <a class="code" href="structstd__summary__stats.html">std_summary_stats</a>;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment"> * @brief Initialises the standard summary statistics.</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"> * This function must be called once to initialise the standard summary</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> * statistics, if used, as well as to allocate required memory in the</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> * simulation variables.</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables were memory for the</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> * user-defined function data will be allocated.</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> * @param stats: Pointer to the standard summary statistics that will be</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> * initialised.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#aa6712724eba0bb63ab1a67e093aadc14">std_stats_init</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <a class="code" href="structstd__summary__stats.html">std_summary_stats</a>* stats);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> * @brief Initialises elements of the standard summary statistics</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="comment"> * before a path simulation.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment"> * This function must be called before the simulation of each path to initialise</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"> * elements of the standard summary statistics, if used</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> * @param stats: Pointer to the standard summary statistics whose</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"> * elements will be initialised.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#ac35116c06c0b121db7de1e4edb6a6f9e">   64</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#ac35116c06c0b121db7de1e4edb6a6f9e">std_stats_path_init</a>(<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>* stats)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  stats-&gt;<a class="code" href="structstd__summary__stats.html#acbd17fcad2eb7abd3430ec4ff8275d3d">extinction_time</a>=0;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  stats-&gt;<a class="code" href="structstd__summary__stats.html#a0823eb53dc979bc0221c570fa1b0e2d7">commpersum</a>=0;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  memset(stats-&gt;<a class="code" href="structstd__summary__stats.html#a40874a46f008c64e6ad71312da1c3e04">inf_timeline</a>,0,stats-&gt;<a class="code" href="structstd__summary__stats.html#af9a151e1652f1cbcdd66f9db6780e324">npers</a>*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  memset(stats-&gt;<a class="code" href="structstd__summary__stats.html#a040ab82e792ffcd94c3fda6c22cf6960">totinf_timeline</a>,0,stats-&gt;<a class="code" href="structstd__summary__stats.html#af9a151e1652f1cbcdd66f9db6780e324">npers</a>*<span class="keyword">sizeof</span>(uint32_t));</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  stats-&gt;<a class="code" href="structstd__summary__stats.html#ae3fb94b9986390017590c435ac2fa66f">rsum</a>=0;</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  stats-&gt;<a class="code" href="structstd__summary__stats.html#a0b893ea867095df3b5169b9a5fcf026b">neventssum</a>=0;</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  stats-&gt;<a class="code" href="structstd__summary__stats.html#ac229de531e51ab996d8d9943836a81df">extinction</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  stats-&gt;<a class="code" href="structstd__summary__stats.html#afebfc56bb1adf1c61f39f78a5e4e4b6f">nimaxedoutmintimeindex</a>=UINT32_MAX;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;}</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"> * @brief Allocates additional memory for the user-defined function data.</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"> * This function must be assigned to the simulation engine through a call of</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"> * sim_set_increase_layers_proc_func.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"> * @param iis: First newly allocated layer element of the infectious individuals array.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"> * @param n: Number of layers that have been added</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"> * */</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#a0735dff281538c95ba18efe4e1e5dcab">std_stats_increase_layers</a>(<a class="code" href="structinfindividual.html">infindividual</a>* <a class="code" href="structsim__vars__.html#a1fac67c0df42bd1eb01036cd4694ea2d">iis</a>, uint32_t n);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"> * @brief Frees memory used by the standard summary statistics.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"> * This function must be called once to free the memory that was allocated by</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"> * std_stats_init.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables were memory for the</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"> * user-defined function data will be freed.</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"> * @param stats: Pointer to the standard summary statistics.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#ac4f441dbc08661402ae6ee49f09bcd01">std_stats_free</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <a class="code" href="structstd__summary__stats.html">std_summary_stats</a>* stats);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"> * @brief Processes the number of infections for this new event.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"> * Adds the number of infections for this new event to the number of infections from</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"> * the current infectious individual, and to the total infection timeline if the event</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment"> * time does not exceed tmax. If the incremented bin for the total infection timeline</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"> * exceeds nimax, then set the extinction for the current path to false and</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"> * update the value for the minimum time index where the maximum number of</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"> * infectious individuals was exceeded if required. This function must be assigned to</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"> * the simulation engine through a call of sim_set_new_event_proc_func.</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"> * @return true if the event time does not exceed tmax and false otherwise.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"> * */</span></div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#aec5a65871a38a80d6a609baef1c314fe">  113</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="standard__summary__stats_8h.html#aec5a65871a38a80d6a609baef1c314fe">std_stats_new_event</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;{</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  (*(uint32_t*)sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a157d62ba2c11a8b680e8a4ef7baa6cad">dataptr</a>)+=sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#afe3df4bdd66cd83ba78ae3d31e64231f">ninfections</a>;</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;Number of infections incremented to %u\n&quot;</span>,*(uint32_t*)sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a157d62ba2c11a8b680e8a4ef7baa6cad">dataptr</a>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#abb69b597195aa750d0fbb4dfa2626025">event_time</a> &lt;= (<span class="keywordtype">int</span>)sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#abb074f0356daa6993db1ffb400e7f8bd">tmax</a>) {</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <span class="keywordflow">if</span>(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;totinf_timeline[(<span class="keywordtype">int</span>)(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#abb69b597195aa750d0fbb4dfa2626025">event_time</a>)] &lt;= ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nimax)</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;      ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;totinf_timeline[(int)(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#abb69b597195aa750d0fbb4dfa2626025">event_time</a>)]+=sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#afe3df4bdd66cd83ba78ae3d31e64231f">ninfections</a>;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160; </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;extinction=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      <span class="keywordflow">if</span>((<span class="keywordtype">int</span>)(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#abb69b597195aa750d0fbb4dfa2626025">event_time</a>) &lt; ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nimaxedoutmintimeindex)  ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nimaxedoutmintimeindex=(int)(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#abb69b597195aa750d0fbb4dfa2626025">event_time</a>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;nimax exceeded for time index %i (%u vs %u)\n&quot;</span>,(<span class="keywordtype">int</span>)(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#abb69b597195aa750d0fbb4dfa2626025">event_time</a>),((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;totinf_timeline[(<span class="keywordtype">int</span>)(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#abb69b597195aa750d0fbb4dfa2626025">event_time</a>)],((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)-&gt;nimax);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <span class="keywordflow">return</span> (sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#abb69b597195aa750d0fbb4dfa2626025">event_time</a> &lt;= sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#abb074f0356daa6993db1ffb400e7f8bd">tmax</a>);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"> * @brief Initialises the processing variable for a new infectious individual.</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"> * This function initialises the number of infectins from a new infectious</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"> * individual to zero. It is only called for infectious individuals that</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"> * participate to a non-zero number of transmission events.</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"> * @param inf: Pointer to the new infectious individual.</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> * */</span></div>
<div class="line"><a name="l00144"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#acc025c857b60d98e0afbdcfa3a329734">  144</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#acc025c857b60d98e0afbdcfa3a329734">std_stats_new_inf</a>(<a class="code" href="structinfindividual.html">infindividual</a>* inf)</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;{</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  *(uint32_t*)inf-&gt;<a class="code" href="structinfindividual.html#a157d62ba2c11a8b680e8a4ef7baa6cad">dataptr</a>=0;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="comment">//++(*(uint32_t*)(inf-1)-&gt;dataptr);</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="comment">//DEBUG_PRINTF(&quot;Number of parent infections incremented to %u\n&quot;,*(uint32_t*)(inf-1)-&gt;dataptr);</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;%s\n&quot;</span>,__func__);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;}</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"> * @brief Process the statistics after the last transmission event for an</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"> * infectious individual that participates to some transmission events.</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"> * After an infectious infectious individual participated to its last</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"> * transmission event, this function adds the total number of infections from</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"> * the individual to the R sum, the individual&#39;s communicable period to the sum</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"> * of communicable periods and the number of transmission events this individual</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"> * participated to to the sum of events. If the individual was still infectious</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"> * at tmax, then the path is set to not go extinct. Otherwise, the</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"> * extinction time for the generating path is updated if its current value was</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"> * exceeded, using the current event time for the individual&#39;s parent and the</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> * individual&#39;s communicable period. The timeline for the number of infectious</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"> * individuals is also updated.</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> * @param inf: Pointer to the infectious individual.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"> * @param ptr: Pointer to the summary statistics.</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"> * */</span></div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#ad535aa342b3069ac685a6882e901e7cd">  170</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#ad535aa342b3069ac685a6882e901e7cd">std_stats_end_inf</a>(<a class="code" href="structinfindividual.html">infindividual</a>* inf, <span class="keywordtype">void</span>* ptr)</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;{</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;Number of infections was %u\n&quot;</span>,*(uint32_t*)inf-&gt;<a class="code" href="structinfindividual.html#a157d62ba2c11a8b680e8a4ef7baa6cad">dataptr</a>);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)ptr)-&gt;rsum+=*(uint32_t*)inf-&gt;<a class="code" href="structinfindividual.html#a157d62ba2c11a8b680e8a4ef7baa6cad">dataptr</a>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)ptr)-&gt;commpersum+=inf-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a>;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)ptr)-&gt;neventssum+=inf-&gt;<a class="code" href="structinfindividual.html#afd408b01ab38e9de03babe0f0059537b">nevents</a>;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> inf_end=(inf-1)-&gt;event_time+inf-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a>;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">//If truncated by tmax</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">if</span>(inf-&gt;<a class="code" href="structinfindividual.html#a185282fb4ce23dcec5b47429e7dfce90">infectious_at_tmax</a>) ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)ptr)-&gt;extinction=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">//++((std_summary_stats*)ptr)-&gt;n_ended_infections;</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">if</span>(inf_end &gt; ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)ptr)-&gt;extinction_time) ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)ptr)-&gt;extinction_time=inf_end;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> end_comm_per=(inf_end &gt;= ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)ptr)-&gt;npers ? ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)ptr)-&gt;npers-1 : (int)inf_end);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">for</span>(i=(<span class="keywordtype">int</span>)((inf-1)-&gt;event_time); i&lt;=end_comm_per; ++i) ++(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)ptr)-&gt;inf_timeline[i]);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"> * @brief Process the statistics for an infectious individual that does not</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"> * participate to any transmission event.</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"> * This function adds the individual&#39;s communicable period to the sum</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"> * of communicable periods. If the individual was still infectious</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"> * at tmax, then the path is set to not go extinct. Otherwise, the</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"> * extinction time for the generating path is updated if its current value was</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"> * exceeded, using the current event time for the individual&#39;s parent and the</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"> * individual&#39;s communicable period. The timeline for the number of infectious</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"> * individuals is also updated.</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"> * @param inf: Pointer to the infectious individual.</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"> * @param ptr: Pointer to the summary statistics.</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"> * */</span></div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="standard__summary__stats_8h.html#afbbab0fad0dc015775ee28834dfb2477">  209</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="standard__summary__stats_8h.html#afbbab0fad0dc015775ee28834dfb2477">std_stats_noevent_inf</a>(<a class="code" href="structinfindividual.html">infindividual</a>* inf, <span class="keywordtype">void</span>* ptr)</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;{</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;%s\n&quot;</span>,__func__);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <span class="comment">//++(*(uint32_t*)(inf-1)-&gt;dataptr);</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  <span class="comment">//DEBUG_PRINTF(&quot;Number of parent infections incremented to %u\n&quot;,*(uint32_t*)(inf-1)-&gt;dataptr);</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;Number of infections was 0\n&quot;</span>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)ptr)-&gt;commpersum+=inf-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160; </div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> inf_end=(inf-1)-&gt;event_time+inf-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a>;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;  <span class="comment">//If truncated by tmax</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordflow">if</span>(inf-&gt;<a class="code" href="structinfindividual.html#a185282fb4ce23dcec5b47429e7dfce90">infectious_at_tmax</a>) ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)ptr)-&gt;extinction=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="comment">//++((std_summary_stats*)ptr)-&gt;n_ended_infections;</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordflow">if</span>(inf_end &gt; ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)ptr)-&gt;extinction_time) ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)ptr)-&gt;extinction_time=inf_end;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  <span class="keywordtype">int</span> i;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> end_comm_per=(inf_end &gt;= ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)ptr)-&gt;npers ? ((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)ptr)-&gt;npers-1 : (int)inf_end);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">for</span>(i=(<span class="keywordtype">int</span>)((inf-1)-&gt;event_time); i&lt;=end_comm_per; ++i) ++(((<a class="code" href="structstd__summary__stats.html">std_summary_stats</a>*)ptr)-&gt;inf_timeline[i]);</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;}</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="astructinfindividual_html_a0eadbf3556c81840e17c2a9e3a6c9130"><div class="ttname"><a href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">infindividual::comm_period</a></div><div class="ttdeci">double comm_period</div><div class="ttdoc">Communicable period.</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00024">infindividual.h:24</a></div></div>
<div class="ttc" id="astructsim__vars___html_ad9d50be547359a56e26030911f2d3d96"><div class="ttname"><a href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">sim_vars_::dataptr</a></div><div class="ttdeci">void * dataptr</div><div class="ttdoc">Simulation-level data pointer for user-defined functions.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00054">simulation.h:54</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_acbd17fcad2eb7abd3430ec4ff8275d3d"><div class="ttname"><a href="structstd__summary__stats.html#acbd17fcad2eb7abd3430ec4ff8275d3d">std_summary_stats::extinction_time</a></div><div class="ttdeci">double extinction_time</div><div class="ttdoc">Path extinction time, if any.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00027">standard_summary_stats.h:27</a></div></div>
<div class="ttc" id="astructsim__vars___html_a1fac67c0df42bd1eb01036cd4694ea2d"><div class="ttname"><a href="structsim__vars__.html#a1fac67c0df42bd1eb01036cd4694ea2d">sim_vars_::iis</a></div><div class="ttdeci">infindividual * iis</div><div class="ttdoc">Array of current infectious individuals across all layers.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00051">simulation.h:51</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_ac35116c06c0b121db7de1e4edb6a6f9e"><div class="ttname"><a href="standard__summary__stats_8h.html#ac35116c06c0b121db7de1e4edb6a6f9e">std_stats_path_init</a></div><div class="ttdeci">static void std_stats_path_init(std_summary_stats *stats)</div><div class="ttdoc">Initialises elements of the standard summary statistics before a path simulation.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00064">standard_summary_stats.h:64</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html"><div class="ttname"><a href="structstd__summary__stats.html">std_summary_stats</a></div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00025">standard_summary_stats.h:25</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_afbbab0fad0dc015775ee28834dfb2477"><div class="ttname"><a href="standard__summary__stats_8h.html#afbbab0fad0dc015775ee28834dfb2477">std_stats_noevent_inf</a></div><div class="ttdeci">static void std_stats_noevent_inf(infindividual *inf, void *ptr)</div><div class="ttdoc">Process the statistics for an infectious individual that does not participate to any transmission eve...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00209">standard_summary_stats.h:209</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_a0735dff281538c95ba18efe4e1e5dcab"><div class="ttname"><a href="standard__summary__stats_8h.html#a0735dff281538c95ba18efe4e1e5dcab">std_stats_increase_layers</a></div><div class="ttdeci">void std_stats_increase_layers(infindividual *iis, uint32_t n)</div><div class="ttdoc">Allocates additional memory for the user-defined function data.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8c_source.html#l00021">standard_summary_stats.c:21</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a040ab82e792ffcd94c3fda6c22cf6960"><div class="ttname"><a href="structstd__summary__stats.html#a040ab82e792ffcd94c3fda6c22cf6960">std_summary_stats::totinf_timeline</a></div><div class="ttdeci">uint32_t * totinf_timeline</div><div class="ttdoc">For each integer interval between 0 and floor(tmax), the number of individuals that get infected at s...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00030">standard_summary_stats.h:30</a></div></div>
<div class="ttc" id="astructinfindividual_html_abb69b597195aa750d0fbb4dfa2626025"><div class="ttname"><a href="structinfindividual.html#abb69b597195aa750d0fbb4dfa2626025">infindividual::event_time</a></div><div class="ttdeci">double event_time</div><div class="ttdoc">Start time for the current iteration event.</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00025">infindividual.h:25</a></div></div>
<div class="ttc" id="astructinfindividual_html_a185282fb4ce23dcec5b47429e7dfce90"><div class="ttname"><a href="structinfindividual.html#a185282fb4ce23dcec5b47429e7dfce90">infindividual::infectious_at_tmax</a></div><div class="ttdeci">bool infectious_at_tmax</div><div class="ttdoc">Is the infected individual still infectious at tmax?</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00030">infindividual.h:30</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_a5c8ef3c24dad2c469a42784a9a39403b"><div class="ttname"><a href="standard__summary__stats_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a></div><div class="ttdeci">#define DEBUG_PRINTF(...)</div><div class="ttdoc">Debug print function.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00019">standard_summary_stats.h:19</a></div></div>
<div class="ttc" id="astructinfindividual_html_a157d62ba2c11a8b680e8a4ef7baa6cad"><div class="ttname"><a href="structinfindividual.html#a157d62ba2c11a8b680e8a4ef7baa6cad">infindividual::dataptr</a></div><div class="ttdeci">void * dataptr</div><div class="ttdoc">Data pointer for user-defined functions.</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00022">infindividual.h:22</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_afebfc56bb1adf1c61f39f78a5e4e4b6f"><div class="ttname"><a href="structstd__summary__stats.html#afebfc56bb1adf1c61f39f78a5e4e4b6f">std_summary_stats::nimaxedoutmintimeindex</a></div><div class="ttdeci">uint32_t nimaxedoutmintimeindex</div><div class="ttdoc">Minimum time index which maxed out the allowed number of infected individuals.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00035">standard_summary_stats.h:35</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a8e83d6a8048fe685966daa2fc88b9786"><div class="ttname"><a href="structstd__summary__stats.html#a8e83d6a8048fe685966daa2fc88b9786">std_summary_stats::nimax</a></div><div class="ttdeci">uint32_t nimax</div><div class="ttdoc">Maximum number of infectious individuals for a given integer inerval between 0 and floor(tmax)....</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00034">standard_summary_stats.h:34</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_aec5a65871a38a80d6a609baef1c314fe"><div class="ttname"><a href="standard__summary__stats_8h.html#aec5a65871a38a80d6a609baef1c314fe">std_stats_new_event</a></div><div class="ttdeci">static bool std_stats_new_event(sim_vars *sv)</div><div class="ttdoc">Processes the number of infections for this new event.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00113">standard_summary_stats.h:113</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a0b893ea867095df3b5169b9a5fcf026b"><div class="ttname"><a href="structstd__summary__stats.html#a0b893ea867095df3b5169b9a5fcf026b">std_summary_stats::neventssum</a></div><div class="ttdeci">uint32_t neventssum</div><div class="ttdoc">Sum of the number of transmission events for all infectious individuals whose communicable period doe...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00033">standard_summary_stats.h:33</a></div></div>
<div class="ttc" id="astructsim__pars_html_abb074f0356daa6993db1ffb400e7f8bd"><div class="ttname"><a href="structsim__pars.html#abb074f0356daa6993db1ffb400e7f8bd">sim_pars::tmax</a></div><div class="ttdeci">double tmax</div><div class="ttdoc">Maximum simulation period used to instantiate new infectious individuals.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00040">simulation.h:40</a></div></div>
<div class="ttc" id="astructsim__vars___html_a4ecabd97135c500f58175eb7e79f2590"><div class="ttname"><a href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">sim_vars_::ii</a></div><div class="ttdeci">infindividual * ii</div><div class="ttdoc">Pointer to current iteration infectious individual.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00052">simulation.h:52</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_acc025c857b60d98e0afbdcfa3a329734"><div class="ttname"><a href="standard__summary__stats_8h.html#acc025c857b60d98e0afbdcfa3a329734">std_stats_new_inf</a></div><div class="ttdeci">static void std_stats_new_inf(infindividual *inf)</div><div class="ttdoc">Initialises the processing variable for a new infectious individual.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00144">standard_summary_stats.h:144</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_ac229de531e51ab996d8d9943836a81df"><div class="ttname"><a href="structstd__summary__stats.html#ac229de531e51ab996d8d9943836a81df">std_summary_stats::extinction</a></div><div class="ttdeci">bool extinction</div><div class="ttdoc">Set to true if extinction does not occur before or at tmax.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00037">standard_summary_stats.h:37</a></div></div>
<div class="ttc" id="astructinfindividual_html_afe3df4bdd66cd83ba78ae3d31e64231f"><div class="ttname"><a href="structinfindividual.html#afe3df4bdd66cd83ba78ae3d31e64231f">infindividual::ninfections</a></div><div class="ttdeci">uint32_t ninfections</div><div class="ttdoc">Number of infections for the current iteration event.</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00028">infindividual.h:28</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_ae3fb94b9986390017590c435ac2fa66f"><div class="ttname"><a href="structstd__summary__stats.html#ae3fb94b9986390017590c435ac2fa66f">std_summary_stats::rsum</a></div><div class="ttdeci">uint32_t rsum</div><div class="ttdoc">Sum of the number of individuals that get infected during the simulation by the infectious individual...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00032">standard_summary_stats.h:32</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a40874a46f008c64e6ad71312da1c3e04"><div class="ttname"><a href="structstd__summary__stats.html#a40874a46f008c64e6ad71312da1c3e04">std_summary_stats::inf_timeline</a></div><div class="ttdeci">uint32_t * inf_timeline</div><div class="ttdoc">For each integer interval between 0 and floor(tmax), the number of individuals that are infectious at...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00029">standard_summary_stats.h:29</a></div></div>
<div class="ttc" id="astructinfindividual_html_afd408b01ab38e9de03babe0f0059537b"><div class="ttname"><a href="structinfindividual.html#afd408b01ab38e9de03babe0f0059537b">infindividual::nevents</a></div><div class="ttdeci">uint32_t nevents</div><div class="ttdoc">Number of events.</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00026">infindividual.h:26</a></div></div>
<div class="ttc" id="astructsim__vars___html_aaea3fd761978e15b95707db83a0121f5"><div class="ttname"><a href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">sim_vars_::pars</a></div><div class="ttdeci">sim_pars pars</div><div class="ttdoc">Simulation input parameters.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00049">simulation.h:49</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_a0823eb53dc979bc0221c570fa1b0e2d7"><div class="ttname"><a href="structstd__summary__stats.html#a0823eb53dc979bc0221c570fa1b0e2d7">std_summary_stats::commpersum</a></div><div class="ttdeci">double commpersum</div><div class="ttdoc">Sum of communicable periods for all infectious individuals whose communicable period does not occur a...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00028">standard_summary_stats.h:28</a></div></div>
<div class="ttc" id="asimulation_8h_html"><div class="ttname"><a href="simulation_8h.html">simulation.h</a></div><div class="ttdoc">Simulation data structures and functions.</div></div>
<div class="ttc" id="astructsim__vars___html"><div class="ttname"><a href="structsim__vars__.html">sim_vars_</a></div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00047">simulation.h:47</a></div></div>
<div class="ttc" id="astructstd__summary__stats_html_af9a151e1652f1cbcdd66f9db6780e324"><div class="ttname"><a href="structstd__summary__stats.html#af9a151e1652f1cbcdd66f9db6780e324">std_summary_stats::npers</a></div><div class="ttdeci">uint32_t npers</div><div class="ttdoc">Number of integer intervals (floor(tmax)+1)</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00031">standard_summary_stats.h:31</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_aa6712724eba0bb63ab1a67e093aadc14"><div class="ttname"><a href="standard__summary__stats_8h.html#aa6712724eba0bb63ab1a67e093aadc14">std_stats_init</a></div><div class="ttdeci">void std_stats_init(sim_vars *sv, std_summary_stats *stats)</div><div class="ttdoc">Initialises the standard summary statistics.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8c_source.html#l00009">standard_summary_stats.c:9</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_ad535aa342b3069ac685a6882e901e7cd"><div class="ttname"><a href="standard__summary__stats_8h.html#ad535aa342b3069ac685a6882e901e7cd">std_stats_end_inf</a></div><div class="ttdeci">static void std_stats_end_inf(infindividual *inf, void *ptr)</div><div class="ttdoc">Process the statistics after the last transmission event for an infectious individual that participat...</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8h_source.html#l00170">standard_summary_stats.h:170</a></div></div>
<div class="ttc" id="astructinfindividual_html"><div class="ttname"><a href="structinfindividual.html">infindividual</a></div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00020">infindividual.h:20</a></div></div>
<div class="ttc" id="astandard__summary__stats_8h_html_ac4f441dbc08661402ae6ee49f09bcd01"><div class="ttname"><a href="standard__summary__stats_8h.html#ac4f441dbc08661402ae6ee49f09bcd01">std_stats_free</a></div><div class="ttdeci">void std_stats_free(sim_vars *sv, std_summary_stats *stats)</div><div class="ttdoc">Frees memory used by the standard summary statistics.</div><div class="ttdef"><b>Definition:</b> <a href="standard__summary__stats_8c_source.html#l00029">standard_summary_stats.c:29</a></div></div>
<div class="ttc" id="ainfindividual_8h_html"><div class="ttname"><a href="infindividual_8h.html">infindividual.h</a></div><div class="ttdoc">Data structure containing infected individual information.</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="standard__summary__stats_8h.html">standard_summary_stats.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
