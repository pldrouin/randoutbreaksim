<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>branchsimc: simulation.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">branchsimc
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">branchsimc Outbreak Branching Model Simulation Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('simulation_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">simulation.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="simulation_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * @file simulation.h</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * @brief Simulation data structures and functions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * @author &lt;Pierre-Luc.Drouin@drdc-rddc.gc.ca&gt;, Defence Research and Development Canada Ottawa Research Centre.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * Model from &lt;jerome.levesque@tpsgc-pwgsc.gc.ca&gt; and</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * &lt;david.maybury@tpsgc-pwgsc.gc.ca&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#ifndef _SIMULATION_</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#define _SIMULATION_</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;gsl/gsl_rng.h&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;gsl/gsl_randist.h&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="infindividual_8h.html">infindividual.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno"><a class="line" href="simulation_8h.html#a5655a86be72747864aa32dadb4fa6b49">   21</a></span>&#160;<span class="preprocessor">#define INIT_N_LAYERS (16) </span><span class="comment">//!&lt; Initial number of simulation layers</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="simulation_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">   23</a></span>&#160;<span class="preprocessor">#define DEBUG_PRINTF(...) </span><span class="comment">//!&lt; Debug print function</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"></span>//#define DEBUG_PRINTF(...) printf(__VA_ARGS__) <span class="comment">//!&lt; Debug print function</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> * Simulation input parameters.</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="structsim__pars.html">   29</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;{</div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="structsim__pars.html#a000dd4e08e042a498ebd7e958f287093">   31</a></span>&#160;  <span class="keywordtype">double</span> <a class="code" href="structsim__pars.html#a000dd4e08e042a498ebd7e958f287093">tbar</a>;      <span class="comment">//!&lt; Mean uninterrupted communicable period</span></div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="structsim__pars.html#a661b5d41e285f97a120e2cc9750e8662">   32</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="structsim__pars.html#a661b5d41e285f97a120e2cc9750e8662">p</a>;     <span class="comment">//!&lt; Parameter for the logarithmic distribution used to draw number of new infections for a given transmission event</span></div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="structsim__pars.html#a1d347f340245fa2ba469b305639e0829">   33</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="structsim__pars.html#a1d347f340245fa2ba469b305639e0829">lambda</a>;    <span class="comment">//!&lt; Rate of transmission events</span></div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="structsim__pars.html#a9a259a96b53ca013c571c0cc28649d6a">   34</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="structsim__pars.html#a9a259a96b53ca013c571c0cc28649d6a">kappa</a>;     <span class="comment">//!&lt; branchim&#39;s kappa parameter for the gamma distribution used to generate the uninterrupted communicable period</span></div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="structsim__pars.html#a2050972eeb28af006b2e92ecf2f5606a">   35</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="structsim__pars.html#a2050972eeb28af006b2e92ecf2f5606a">lbar</a>;      <span class="comment">//!&lt; Mean latent pariod</span></div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="structsim__pars.html#abfab632383b0b2ead4ef8df7fc1368ba">   36</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="structsim__pars.html#abfab632383b0b2ead4ef8df7fc1368ba">kappal</a>;    <span class="comment">//!&lt; kappa parameter for the gamma distribution used to generate the latent period</span></div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="structsim__pars.html#acddde30706db8c2da2073310d35d86c3">   37</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="structsim__pars.html#acddde30706db8c2da2073310d35d86c3">q</a>;     <span class="comment">//!&lt; Probability of alternate communicable period</span></div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="structsim__pars.html#a82fd3d8b6632fbf948e2a6018ec257d7">   38</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="structsim__pars.html#a82fd3d8b6632fbf948e2a6018ec257d7">mbar</a>;      <span class="comment">//!&lt; Mean period for the alternate communicable period</span></div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="structsim__pars.html#aaa990fffe8036f83a95fd6c2c6bdc384">   39</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="structsim__pars.html#aaa990fffe8036f83a95fd6c2c6bdc384">kappaq</a>;    <span class="comment">//!&lt; branchim&#39;s kappa parameter for the gamma distribution used to generate the alternate communicable period</span></div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="structsim__pars.html#abb074f0356daa6993db1ffb400e7f8bd">   40</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">double</span> <a class="code" href="structsim__pars.html#abb074f0356daa6993db1ffb400e7f8bd">tmax</a>;      <span class="comment">//!&lt; Maximum simulation period used to instantiate new infectious individuals.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="structsim__pars.html#a87db097b251e1b6022de8ee8df4827ac">   41</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structsim__pars.html#a87db097b251e1b6022de8ee8df4827ac">nstart</a>;  <span class="comment">//!&lt; Initial number of infectious individuals</span></div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment"></span>} <a class="code" href="structsim__pars.html">sim_pars</a>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> * Simulation variables</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="structsim__vars__.html">   47</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structsim__vars__.html">sim_vars_</a></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">   49</a></span>&#160;  <a class="code" href="structsim__pars.html">sim_pars</a> <a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>;        <span class="comment">//!&lt; Simulation input parameters</span></div>
<div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">   50</a></span>&#160;<span class="comment"></span>  gsl_rng <span class="keyword">const</span>* <a class="code" href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">r</a>;     <span class="comment">//!&lt; Pointer to GSL random number generator</span></div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="structsim__vars__.html#a1fac67c0df42bd1eb01036cd4694ea2d">   51</a></span>&#160;<span class="comment"></span>  <a class="code" href="structinfindividual.html">infindividual</a>* <a class="code" href="structsim__vars__.html#a1fac67c0df42bd1eb01036cd4694ea2d">iis</a>;   <span class="comment">//!&lt; Array of current infectious individuals across all layers</span></div>
<div class="line"><a name="l00052"></a><span class="lineno"><a class="line" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">   52</a></span>&#160;<span class="comment"></span>  <a class="code" href="structinfindividual.html">infindividual</a>* <a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>;    <span class="comment">//!&lt; Pointer to current iteration infectious individual</span></div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="structsim__vars__.html#a8371841f622cffaa066aade2df13c58f">   53</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structsim__vars__.html#a8371841f622cffaa066aade2df13c58f">nlayers</a>;     <span class="comment">//!&lt; Current maximum number of layers that has been used so far </span></div>
<div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">   54</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span>* <a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>;        <span class="comment">//!&lt; Simulation-level data pointer for user-defined functions</span></div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="structsim__vars__.html#a512ad1b3e3afc84900cb0940bf31e5d3">   55</a></span>&#160;<span class="comment"></span>  void (*<a class="code" href="structsim__vars__.html#a512ad1b3e3afc84900cb0940bf31e5d3">gen_time_periods_func</a>)(<span class="keyword">struct </span><a class="code" href="structsim__vars__.html">sim_vars_</a>*);             <span class="comment">//!&lt; Pointer to the function used to generate time periods for a given infectious individual</span></div>
<div class="line"><a name="l00056"></a><span class="lineno"><a class="line" href="structsim__vars__.html#a7138287fc57ef7b9243d9553c4fbba35">   56</a></span>&#160;<span class="comment"></span>  void (*<a class="code" href="structsim__vars__.html#a7138287fc57ef7b9243d9553c4fbba35">increase_layers_proc_func</a>)(<a class="code" href="structinfindividual.html">infindividual</a>* <a class="code" href="structsim__vars__.html#a1fac67c0df42bd1eb01036cd4694ea2d">iis</a>, uint32_t n);    <span class="comment">//!&lt; Pointer to the user-defined processing function that is called when the maximum number of layers is increased.</span></div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="structsim__vars__.html#a3884cb21e08092c3e9c686bebc2e06c1">   57</a></span>&#160;<span class="comment"></span>  bool (*<a class="code" href="structsim__vars__.html#a3884cb21e08092c3e9c686bebc2e06c1">new_event_proc_func</a>)(<span class="keyword">struct </span><a class="code" href="structsim__vars__.html">sim_vars_</a>* sv);                <span class="comment">//!&lt; Pointer to the user-defined processing function that is called when a new transmission event is created, after an event time and the number of new infections have been assigned. The function is also called at the beginning of the simulation to account for the initial infectious individuals. The returned value from this function determines if new infectious individuals are instantiated for this event.</span></div>
<div class="line"><a name="l00058"></a><span class="lineno"><a class="line" href="structsim__vars__.html#aa811264d61ffd4e711034cd3965ec48b">   58</a></span>&#160;<span class="comment"></span>  void (*<a class="code" href="structsim__vars__.html#aa811264d61ffd4e711034cd3965ec48b">new_inf_proc_func</a>)(<a class="code" href="structinfindividual.html">infindividual</a>* newinf);         <span class="comment">//!&lt; Pointer to the user-defined processing function that is called when a new infected individual is created, after the communicable period and the number of transmission events have been assigned. The function is only called if the number of transmission events is non-zero. </span></div>
<div class="line"><a name="l00059"></a><span class="lineno"><a class="line" href="structsim__vars__.html#a0185f5ecedb040b1b8fb20a6f40f7b87">   59</a></span>&#160;<span class="comment"></span>  void (*<a class="code" href="structsim__vars__.html#a0185f5ecedb040b1b8fb20a6f40f7b87">end_inf_proc_func</a>)(<a class="code" href="structinfindividual.html">infindividual</a>* inf, <span class="keywordtype">void</span>* <a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>);         <span class="comment">//!&lt; Pointer to the user-defined processing function that is called once all transmission events for a given infectious individual have been generated.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno"><a class="line" href="structsim__vars__.html#aff1ee1c1322047e1ca12f5d9fa4b0b7f">   60</a></span>&#160;<span class="comment"></span>  void (*<a class="code" href="structsim__vars__.html#aff1ee1c1322047e1ca12f5d9fa4b0b7f">inf_proc_func_noevent</a>)(<a class="code" href="structinfindividual.html">infindividual</a>* inf, <span class="keywordtype">void</span>* <a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>); <span class="comment">//!&lt; Pointer to the user-defined processing function that is called for an infectious individual that does not generate any transmission event.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"></span>} <a class="code" href="simulation_8h.html#af56e48cea71d8ff85c6a1651de1707bf">sim_vars</a>;</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"> * @brief Verifies the validity of simulation parameters.</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="comment"> * This internal function verifies if the set of provided simulation parameter values are</span></div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"> * valid.</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"> * @param pars: Pointer to the simulation parameters.</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"> * @return 0 if the parameters are valid. If the parameters are</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"> * invalid, an error is printed on stderr.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="keywordtype">int</span> <a class="code" href="simulation_8h.html#a2e9b3d32f328788778fff13cbdf6dd57">sim_pars_check</a>(<a class="code" href="structsim__pars.html">sim_pars</a> <span class="keyword">const</span>* <a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"> * @brief Initialises the simulation.</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment"> * This function must be called to initialise the simulation.</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation handle.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"> * @param pars: Pointer to the simulation parameters</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"> * @param r: Pointer to the GSL random number generator.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"> * @return 0 if the simulation was initialised successfully.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="keywordtype">int</span> <a class="code" href="simulation_8h.html#ac390bfd4185b26248b9ea2990e075964">sim_init</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <a class="code" href="structsim__pars.html">sim_pars</a>* <a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>, <span class="keyword">const</span> gsl_rng* <a class="code" href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">r</a>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment"> * @brief Initialises the simulation-level data pointer for user-defined functions.</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment"> * This function can be used to set the simulation-level data pointer for user-defined functions.</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"> * @param dataptr: Data pointer.</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00095"></a><span class="lineno"><a class="line" href="simulation_8h.html#ae122699e5ed7266492671f08ad74f0f1">   95</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#ae122699e5ed7266492671f08ad74f0f1">sim_set_proc_data</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <span class="keywordtype">void</span>* <a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>){sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>=<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>;}</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> * @brief Sets the user-defined processing function that is called when a new transmission event is created.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"> * This function is called after an event time and the number of new infections</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"> * have been assigned. The function is also called at the beginning of the simulation</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment"> * to account for the initial infectious individuals.</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"> * @param new_event_proc_func: Pointer to the user-defined function.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"> * @return true if new infectious individuals are to be instantiated from this</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"> * event, false otherwise.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00109"></a><span class="lineno"><a class="line" href="simulation_8h.html#af5bcf389e2f823c77eaeb9c114ba8217">  109</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#af5bcf389e2f823c77eaeb9c114ba8217">sim_set_new_event_proc_func</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <span class="keywordtype">bool</span> (*<a class="code" href="structsim__vars__.html#a3884cb21e08092c3e9c686bebc2e06c1">new_event_proc_func</a>)(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv)){sv-&gt;<a class="code" href="structsim__vars__.html#a3884cb21e08092c3e9c686bebc2e06c1">new_event_proc_func</a>=<a class="code" href="structsim__vars__.html#a3884cb21e08092c3e9c686bebc2e06c1">new_event_proc_func</a>;}</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"> * @brief Sets the user-defined processing function that is called when a new infected individual is created.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="comment"> * This function is called after the communicable period and the number of</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"> * transmission events have been assigned. The function is only called if the number</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment"> * of transmission events is non-zero.</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> * @param new_inf_proc_func: Pointer to the user-defined function.</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00121"></a><span class="lineno"><a class="line" href="simulation_8h.html#a9e0b56e8119109b841681b7489e9eb4f">  121</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a9e0b56e8119109b841681b7489e9eb4f">sim_set_new_inf_proc_func</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <span class="keywordtype">void</span> (*<a class="code" href="structsim__vars__.html#aa811264d61ffd4e711034cd3965ec48b">new_inf_proc_func</a>)(<a class="code" href="structinfindividual.html">infindividual</a>* newinf)){sv-&gt;<a class="code" href="structsim__vars__.html#aa811264d61ffd4e711034cd3965ec48b">new_inf_proc_func</a>=<a class="code" href="structsim__vars__.html#aa811264d61ffd4e711034cd3965ec48b">new_inf_proc_func</a>;}</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"> * @brief Sets the user-defined processing function that is called when the maximum number of layers is increased.</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"> * This function is called after the array of infectious individuals has been</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"> * resized.</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment"> * @param increase_layers_proc_func: Pointer to the user-defined function. The</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"> * first argument of this function points to the infectious individuals array,</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"> * starting with the first newly allocated layer, and the second argument is the</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"> * number of layers that have been added.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00135"></a><span class="lineno"><a class="line" href="simulation_8h.html#a4ad9e4686543e5e6535b538a29dcd169">  135</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a4ad9e4686543e5e6535b538a29dcd169">sim_set_increase_layers_proc_func</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <span class="keywordtype">void</span> (*<a class="code" href="structsim__vars__.html#a7138287fc57ef7b9243d9553c4fbba35">increase_layers_proc_func</a>)(<a class="code" href="structinfindividual.html">infindividual</a>* <a class="code" href="structsim__vars__.html#a1fac67c0df42bd1eb01036cd4694ea2d">iis</a>, uint32_t n)){sv-&gt;<a class="code" href="structsim__vars__.html#a7138287fc57ef7b9243d9553c4fbba35">increase_layers_proc_func</a>=<a class="code" href="structsim__vars__.html#a7138287fc57ef7b9243d9553c4fbba35">increase_layers_proc_func</a>;}</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;<span class="comment"> * @brief Sets the user-defined processing function that is called once all</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"> * transmission events for a given infectious individual have been generated.</span></div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"> * @param end_inf_proc_func: Pointer to the user-defined function. The second</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> * argument for this function is the simulation-level data pointer.</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00145"></a><span class="lineno"><a class="line" href="simulation_8h.html#aaf6b49ed5309f072770c4c2038371e50">  145</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#aaf6b49ed5309f072770c4c2038371e50">sim_set_end_inf_proc_func</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <span class="keywordtype">void</span> (*<a class="code" href="structsim__vars__.html#a0185f5ecedb040b1b8fb20a6f40f7b87">end_inf_proc_func</a>)(<a class="code" href="structinfindividual.html">infindividual</a>* inf, <span class="keywordtype">void</span>* <a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)){sv-&gt;<a class="code" href="structsim__vars__.html#a0185f5ecedb040b1b8fb20a6f40f7b87">end_inf_proc_func</a>=<a class="code" href="structsim__vars__.html#a0185f5ecedb040b1b8fb20a6f40f7b87">end_inf_proc_func</a>;}</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"> * @brief Sets the user-defined processing function that is called for an infectious individual that does not generate any transmission event.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;<span class="comment"> * This function is called after the communicable period has been assigned for</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"> * the current infectious individual.</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"> * @param inf_proc_func_noevent: Pointer to the user-defined function. The second</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"> * argument for this function is the simulation-level data pointer.</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="simulation_8h.html#a0f2a0463da67aac089d7e7cf9e23bb77">  157</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a0f2a0463da67aac089d7e7cf9e23bb77">sim_set_inf_proc_noevent_func</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <span class="keywordtype">void</span> (*<a class="code" href="structsim__vars__.html#aff1ee1c1322047e1ca12f5d9fa4b0b7f">inf_proc_func_noevent</a>)(<a class="code" href="structinfindividual.html">infindividual</a>* inf, <span class="keywordtype">void</span>* <a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)){sv-&gt;<a class="code" href="structsim__vars__.html#aff1ee1c1322047e1ca12f5d9fa4b0b7f">inf_proc_func_noevent</a>=<a class="code" href="structsim__vars__.html#aff1ee1c1322047e1ca12f5d9fa4b0b7f">inf_proc_func_noevent</a>;}</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"> * @brief Frees the dynamic memory used in the simulation handle.</span></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"> * Does not free</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment"> * any memory related to the simulation-level data pointer for the user-defined</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> * functions.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno"><a class="line" href="simulation_8h.html#a5bde1baf6ffdfb13173d7dd10983bb68">  168</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a5bde1baf6ffdfb13173d7dd10983bb68">sim_free</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv){free(sv-&gt;<a class="code" href="structsim__vars__.html#a1fac67c0df42bd1eb01036cd4694ea2d">iis</a>);}</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> * @brief Performs the simulation.</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"> * Performs the simulation, as configured through the simulation variables. This</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"> * function can be called multiple times in a row.</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"> * @return 0 if there is no error.</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="keywordtype">int</span> <a class="code" href="simulation_8h.html#a25404969c762d39ee77eb67bc8611428">simulate</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"> * @brief Generates an uninterrupted communicable period without latent period.</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"> * This function generates the uninterrupted communicable period for the current</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"> * infectious individual without a latent period, as determined by the simulation</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"> * variables and parameters. It also sets the infectious_at_tmax parameter for</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"> * the current infectious individual.</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00191"></a><span class="lineno"><a class="line" href="simulation_8h.html#ae96c5576cb07eb625c14538051f0afd1">  191</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#ae96c5576cb07eb625c14538051f0afd1">gen_comm_period</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;{</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#aa01451a784f0632d3b6886b208dec889">latent_period</a>=0;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a>=gsl_ran_gamma(sv-&gt;<a class="code" href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">r</a>, sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a9a259a96b53ca013c571c0cc28649d6a">kappa</a>*sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a000dd4e08e042a498ebd7e958f287093">tbar</a>, 1./sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a9a259a96b53ca013c571c0cc28649d6a">kappa</a>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <span class="keywordtype">double</span> time_left=sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#abb074f0356daa6993db1ffb400e7f8bd">tmax</a>-(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-1)-&gt;event_time;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160; </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">if</span>(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a> &gt; time_left) {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">//sv-&gt;ii-&gt;comm_period=time_left;</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a185282fb4ce23dcec5b47429e7dfce90">infectious_at_tmax</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  } <span class="keywordflow">else</span> sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a185282fb4ce23dcec5b47429e7dfce90">infectious_at_tmax</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="simulation_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;Comm period is %f%s\n&quot;</span>,sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a>,(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a185282fb4ce23dcec5b47429e7dfce90">infectious_at_tmax</a>?<span class="stringliteral">&quot; (reached end)&quot;</span>:<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;}</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"> * @brief Generates a communicable period without a latent period.</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"> * This function generates the communicable period for the current</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"> * infectious individual without a latent period, as determined by the</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"> * simulation variables and parameters. It considers the alternate</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> * communicable period based on the q simulation parameter, and selects</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"> * the shortest period between the uninterrupted period and the alternate</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"> * period. It also sets the infectious_at_tmax parameter for the current</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"> * infectious individual.</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="simulation_8h.html#af1b123bb0bddf06a2a0001903ceb31b8">  218</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#af1b123bb0bddf06a2a0001903ceb31b8">gen_comm_period_isolation</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv)</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;{</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="keywordtype">double</span> m;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#aa01451a784f0632d3b6886b208dec889">latent_period</a>=0;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a>=gsl_ran_gamma(sv-&gt;<a class="code" href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">r</a>, sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a9a259a96b53ca013c571c0cc28649d6a">kappa</a>*sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a000dd4e08e042a498ebd7e958f287093">tbar</a>, 1./sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a9a259a96b53ca013c571c0cc28649d6a">kappa</a>);</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;  <span class="keywordflow">if</span>(gsl_rng_uniform(sv-&gt;<a class="code" href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">r</a>) &gt;= sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#acddde30706db8c2da2073310d35d86c3">q</a>) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160; </div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">if</span>(isinf(sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#aaa990fffe8036f83a95fd6c2c6bdc384">kappaq</a>)) m=sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a82fd3d8b6632fbf948e2a6018ec257d7">mbar</a>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordflow">else</span> m=gsl_ran_gamma(sv-&gt;<a class="code" href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">r</a>, sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#aaa990fffe8036f83a95fd6c2c6bdc384">kappaq</a>*sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a82fd3d8b6632fbf948e2a6018ec257d7">mbar</a>, 1./sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#aaa990fffe8036f83a95fd6c2c6bdc384">kappaq</a>);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordflow">if</span>(m&lt;sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a>) sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a>=m;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordtype">double</span> time_left=sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#abb074f0356daa6993db1ffb400e7f8bd">tmax</a>-(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-1)-&gt;event_time;</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  <span class="keywordflow">if</span>(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a> &gt; time_left) {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">//sv-&gt;ii-&gt;comm_period=time_left;</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a185282fb4ce23dcec5b47429e7dfce90">infectious_at_tmax</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160; </div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  } <span class="keywordflow">else</span> sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a185282fb4ce23dcec5b47429e7dfce90">infectious_at_tmax</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;  <a class="code" href="simulation_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;Comm period is %f%s\n&quot;</span>,sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a>,(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a185282fb4ce23dcec5b47429e7dfce90">infectious_at_tmax</a>?<span class="stringliteral">&quot; (reached end)&quot;</span>:<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;}</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"> * @brief Generates an uninterrupted communicable period and a latent period.</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"> * This function generates the uninterrupted communicable period for the current</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment"> * infectious individual and a latent period, as determined by the simulation</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment"> * variables and parameters. It also sets the infectious_at_tmax parameter for</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="comment"> * the current infectious individual.</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00252"></a><span class="lineno"><a class="line" href="simulation_8h.html#aed5a49fbb45324e1dd02058122f6b70a">  252</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#aed5a49fbb45324e1dd02058122f6b70a">gen_time_periods</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv)</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;{</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#aa01451a784f0632d3b6886b208dec889">latent_period</a>=gsl_ran_gamma(sv-&gt;<a class="code" href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">r</a>, sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#abfab632383b0b2ead4ef8df7fc1368ba">kappal</a>*sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a2050972eeb28af006b2e92ecf2f5606a">lbar</a>, 1./sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#abfab632383b0b2ead4ef8df7fc1368ba">kappal</a>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a>=gsl_ran_gamma(sv-&gt;<a class="code" href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">r</a>, sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a9a259a96b53ca013c571c0cc28649d6a">kappa</a>*sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a000dd4e08e042a498ebd7e958f287093">tbar</a>, 1./sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a9a259a96b53ca013c571c0cc28649d6a">kappa</a>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordtype">double</span> time_left=sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#abb074f0356daa6993db1ffb400e7f8bd">tmax</a>-(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-1)-&gt;event_time;</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <span class="keywordflow">if</span>(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a> &gt; time_left) {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="comment">//sv-&gt;ii-&gt;comm_period=time_left;</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a185282fb4ce23dcec5b47429e7dfce90">infectious_at_tmax</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  } <span class="keywordflow">else</span> sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a185282fb4ce23dcec5b47429e7dfce90">infectious_at_tmax</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <a class="code" href="simulation_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;Comm period is %f%s\n&quot;</span>,sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a>,(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a185282fb4ce23dcec5b47429e7dfce90">infectious_at_tmax</a>?<span class="stringliteral">&quot; (reached end)&quot;</span>:<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;}</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"> * @brief Generates a communicable period and a latent period.</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"> * This function generates the communicable period for the current</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="comment"> * infectious individual and a latent period, as determined by the</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"> * simulation variables and parameters. It considers the alternate</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment"> * communicable period based on the q simulation parameter, and selects</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"> * the shortest period between the uninterrupted period and the alternate</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"> * period. It also sets the infectious_at_tmax parameter for the current</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"> * infectious individual.</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="simulation_8h.html#abe890d83ca8cbe0b95d1c9eae6fd35c2">  279</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#abe890d83ca8cbe0b95d1c9eae6fd35c2">gen_time_periods_isolation</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv)</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;{</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="keywordtype">double</span> m;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#aa01451a784f0632d3b6886b208dec889">latent_period</a>=gsl_ran_gamma(sv-&gt;<a class="code" href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">r</a>, sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#abfab632383b0b2ead4ef8df7fc1368ba">kappal</a>*sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a2050972eeb28af006b2e92ecf2f5606a">lbar</a>, 1./sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#abfab632383b0b2ead4ef8df7fc1368ba">kappal</a>);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a>=gsl_ran_gamma(sv-&gt;<a class="code" href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">r</a>, sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a9a259a96b53ca013c571c0cc28649d6a">kappa</a>*sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a000dd4e08e042a498ebd7e958f287093">tbar</a>, 1./sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a9a259a96b53ca013c571c0cc28649d6a">kappa</a>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">if</span>(gsl_rng_uniform(sv-&gt;<a class="code" href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">r</a>) &gt;= sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#acddde30706db8c2da2073310d35d86c3">q</a>) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160; </div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span>(isinf(sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#aaa990fffe8036f83a95fd6c2c6bdc384">kappaq</a>)) m=sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a82fd3d8b6632fbf948e2a6018ec257d7">mbar</a>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    <span class="keywordflow">else</span> m=gsl_ran_gamma(sv-&gt;<a class="code" href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">r</a>, sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#aaa990fffe8036f83a95fd6c2c6bdc384">kappaq</a>*sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#a82fd3d8b6632fbf948e2a6018ec257d7">mbar</a>, 1./sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#aaa990fffe8036f83a95fd6c2c6bdc384">kappaq</a>);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <span class="keywordflow">if</span>(m&lt;sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a>) sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a>=m;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="keywordtype">double</span> time_left=sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#abb074f0356daa6993db1ffb400e7f8bd">tmax</a>-(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-1)-&gt;event_time;</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="keywordflow">if</span>(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a> &gt; time_left) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="comment">//sv-&gt;ii-&gt;comm_period=time_left;</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a185282fb4ce23dcec5b47429e7dfce90">infectious_at_tmax</a>=<span class="keyword">true</span>;</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  } <span class="keywordflow">else</span> sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a185282fb4ce23dcec5b47429e7dfce90">infectious_at_tmax</a>=<span class="keyword">false</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <a class="code" href="simulation_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a>(<span class="stringliteral">&quot;Comm period is %f%s\n&quot;</span>,sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">comm_period</a>,(sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#a185282fb4ce23dcec5b47429e7dfce90">infectious_at_tmax</a>?<span class="stringliteral">&quot; (reached end)&quot;</span>:<span class="stringliteral">&quot;&quot;</span>));</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"> * @brief Default processing function that is called when a new transmission event is created.</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"> * This function is called by default if a user-defined function has not been</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"> * set.</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"> * @return true if the event does not occur after tmax, false otherwise.</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="simulation_8h.html#a881fb314fa7f96332cfe3f324287400f">  312</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="simulation_8h.html#a881fb314fa7f96332cfe3f324287400f">default_event_proc_func</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv){<span class="keywordflow">return</span> (sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#abb69b597195aa750d0fbb4dfa2626025">event_time</a> &lt;= sv-&gt;<a class="code" href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">pars</a>.<a class="code" href="structsim__pars.html#abb074f0356daa6993db1ffb400e7f8bd">tmax</a>);}</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"> * @brief Default processing function that is called when the maximum number of</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"> * layers is increased.</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;<span class="comment"> * This function is called by default if a user-defined function has not been</span></div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="comment"> * set. The function does not do anything.</span></div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;<span class="comment"> * @param iis: First newly allocated layer element of the infectious individuals array.</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="comment"> * @param n: Number of layers that have been added</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00324"></a><span class="lineno"><a class="line" href="simulation_8h.html#a43209d4db5fb03b575e3b61a72877b87">  324</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a43209d4db5fb03b575e3b61a72877b87">default_increase_layers_proc_func</a>(<a class="code" href="structinfindividual.html">infindividual</a>* <a class="code" href="structsim__vars__.html#a1fac67c0df42bd1eb01036cd4694ea2d">iis</a>, uint32_t n){}</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;<span class="comment"> * @brief Default processing function.</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;<span class="comment"> * This function is called by default if a user-defined function has not been</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment"> * set. The function does not do anything.</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="simulation_8h.html#a4ecfceeb3812509d92a677d9c65d6d9a">  332</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a4ecfceeb3812509d92a677d9c65d6d9a">dummy_proc_func_sv</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv){}</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;<span class="comment"> * @brief Default processing function.</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;<span class="comment"> * This function is called by default if a user-defined function has not been</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;<span class="comment"> * set. The function does not do anything.</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00340"></a><span class="lineno"><a class="line" href="simulation_8h.html#a909090a23b94d15cfc7fe877c85466b1">  340</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a909090a23b94d15cfc7fe877c85466b1">dummy_proc_func_one_par</a>(<a class="code" href="structinfindividual.html">infindividual</a>* inf){}</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment"> * @brief Default processing function.</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;<span class="comment"> * This function is called by default if a user-defined function has not been</span></div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="comment"> * set. The function does not do anything.</span></div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="simulation_8h.html#a84beb2084ff7239d40c304cee0506411">  348</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a84beb2084ff7239d40c304cee0506411">dummy_proc_func_two_pars</a>(<a class="code" href="structinfindividual.html">infindividual</a>* inf, <span class="keywordtype">void</span>* ptr){}</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160; </div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="asimulation_8h_html_a84beb2084ff7239d40c304cee0506411"><div class="ttname"><a href="simulation_8h.html#a84beb2084ff7239d40c304cee0506411">dummy_proc_func_two_pars</a></div><div class="ttdeci">static void dummy_proc_func_two_pars(infindividual *inf, void *ptr)</div><div class="ttdoc">Default processing function.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00348">simulation.h:348</a></div></div>
<div class="ttc" id="astructsim__vars___html_a8b90e6b2db2c771bb954d0b082fdf96f"><div class="ttname"><a href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">sim_vars_::r</a></div><div class="ttdeci">gsl_rng const  * r</div><div class="ttdoc">Pointer to GSL random number generator.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00050">simulation.h:50</a></div></div>
<div class="ttc" id="astructsim__pars_html_a82fd3d8b6632fbf948e2a6018ec257d7"><div class="ttname"><a href="structsim__pars.html#a82fd3d8b6632fbf948e2a6018ec257d7">sim_pars::mbar</a></div><div class="ttdeci">double mbar</div><div class="ttdoc">Mean period for the alternate communicable period.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00038">simulation.h:38</a></div></div>
<div class="ttc" id="asimulation_8h_html_af1b123bb0bddf06a2a0001903ceb31b8"><div class="ttname"><a href="simulation_8h.html#af1b123bb0bddf06a2a0001903ceb31b8">gen_comm_period_isolation</a></div><div class="ttdeci">static void gen_comm_period_isolation(sim_vars *sv)</div><div class="ttdoc">Generates a communicable period without a latent period.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00218">simulation.h:218</a></div></div>
<div class="ttc" id="astructsim__vars___html_a7138287fc57ef7b9243d9553c4fbba35"><div class="ttname"><a href="structsim__vars__.html#a7138287fc57ef7b9243d9553c4fbba35">sim_vars_::increase_layers_proc_func</a></div><div class="ttdeci">void(* increase_layers_proc_func)(infindividual *iis, uint32_t n)</div><div class="ttdoc">Pointer to the user-defined processing function that is called when the maximum number of layers is i...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00056">simulation.h:56</a></div></div>
<div class="ttc" id="astructinfindividual_html_a0eadbf3556c81840e17c2a9e3a6c9130"><div class="ttname"><a href="structinfindividual.html#a0eadbf3556c81840e17c2a9e3a6c9130">infindividual::comm_period</a></div><div class="ttdeci">double comm_period</div><div class="ttdoc">Communicable period.</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00024">infindividual.h:24</a></div></div>
<div class="ttc" id="asimulation_8h_html_af56e48cea71d8ff85c6a1651de1707bf"><div class="ttname"><a href="simulation_8h.html#af56e48cea71d8ff85c6a1651de1707bf">sim_vars</a></div><div class="ttdeci">struct sim_vars_ sim_vars</div></div>
<div class="ttc" id="astructsim__vars___html_ad9d50be547359a56e26030911f2d3d96"><div class="ttname"><a href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">sim_vars_::dataptr</a></div><div class="ttdeci">void * dataptr</div><div class="ttdoc">Simulation-level data pointer for user-defined functions.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00054">simulation.h:54</a></div></div>
<div class="ttc" id="astructsim__vars___html_a1fac67c0df42bd1eb01036cd4694ea2d"><div class="ttname"><a href="structsim__vars__.html#a1fac67c0df42bd1eb01036cd4694ea2d">sim_vars_::iis</a></div><div class="ttdeci">infindividual * iis</div><div class="ttdoc">Array of current infectious individuals across all layers.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00051">simulation.h:51</a></div></div>
<div class="ttc" id="astructsim__pars_html_a1d347f340245fa2ba469b305639e0829"><div class="ttname"><a href="structsim__pars.html#a1d347f340245fa2ba469b305639e0829">sim_pars::lambda</a></div><div class="ttdeci">double lambda</div><div class="ttdoc">Rate of transmission events.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00033">simulation.h:33</a></div></div>
<div class="ttc" id="asimulation_8h_html_aaf6b49ed5309f072770c4c2038371e50"><div class="ttname"><a href="simulation_8h.html#aaf6b49ed5309f072770c4c2038371e50">sim_set_end_inf_proc_func</a></div><div class="ttdeci">static void sim_set_end_inf_proc_func(sim_vars *sv, void(*end_inf_proc_func)(infindividual *inf, void *dataptr))</div><div class="ttdoc">Sets the user-defined processing function that is called once all transmission events for a given inf...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00145">simulation.h:145</a></div></div>
<div class="ttc" id="astructinfindividual_html_abb69b597195aa750d0fbb4dfa2626025"><div class="ttname"><a href="structinfindividual.html#abb69b597195aa750d0fbb4dfa2626025">infindividual::event_time</a></div><div class="ttdeci">double event_time</div><div class="ttdoc">Start time for the current iteration event.</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00025">infindividual.h:25</a></div></div>
<div class="ttc" id="astructinfindividual_html_a185282fb4ce23dcec5b47429e7dfce90"><div class="ttname"><a href="structinfindividual.html#a185282fb4ce23dcec5b47429e7dfce90">infindividual::infectious_at_tmax</a></div><div class="ttdeci">bool infectious_at_tmax</div><div class="ttdoc">Is the infected individual still infectious at tmax?</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00030">infindividual.h:30</a></div></div>
<div class="ttc" id="asimulation_8h_html_a0f2a0463da67aac089d7e7cf9e23bb77"><div class="ttname"><a href="simulation_8h.html#a0f2a0463da67aac089d7e7cf9e23bb77">sim_set_inf_proc_noevent_func</a></div><div class="ttdeci">static void sim_set_inf_proc_noevent_func(sim_vars *sv, void(*inf_proc_func_noevent)(infindividual *inf, void *dataptr))</div><div class="ttdoc">Sets the user-defined processing function that is called for an infectious individual that does not g...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00157">simulation.h:157</a></div></div>
<div class="ttc" id="asimulation_8h_html_a2e9b3d32f328788778fff13cbdf6dd57"><div class="ttname"><a href="simulation_8h.html#a2e9b3d32f328788778fff13cbdf6dd57">sim_pars_check</a></div><div class="ttdeci">int sim_pars_check(sim_pars const *pars)</div><div class="ttdoc">Verifies the validity of simulation parameters.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8c_source.html#l00013">simulation.c:13</a></div></div>
<div class="ttc" id="astructsim__vars___html_a0185f5ecedb040b1b8fb20a6f40f7b87"><div class="ttname"><a href="structsim__vars__.html#a0185f5ecedb040b1b8fb20a6f40f7b87">sim_vars_::end_inf_proc_func</a></div><div class="ttdeci">void(* end_inf_proc_func)(infindividual *inf, void *dataptr)</div><div class="ttdoc">Pointer to the user-defined processing function that is called once all transmission events for a giv...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00059">simulation.h:59</a></div></div>
<div class="ttc" id="asimulation_8h_html_abe890d83ca8cbe0b95d1c9eae6fd35c2"><div class="ttname"><a href="simulation_8h.html#abe890d83ca8cbe0b95d1c9eae6fd35c2">gen_time_periods_isolation</a></div><div class="ttdeci">static void gen_time_periods_isolation(sim_vars *sv)</div><div class="ttdoc">Generates a communicable period and a latent period.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00279">simulation.h:279</a></div></div>
<div class="ttc" id="astructsim__pars_html_abb074f0356daa6993db1ffb400e7f8bd"><div class="ttname"><a href="structsim__pars.html#abb074f0356daa6993db1ffb400e7f8bd">sim_pars::tmax</a></div><div class="ttdeci">double tmax</div><div class="ttdoc">Maximum simulation period used to instantiate new infectious individuals.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00040">simulation.h:40</a></div></div>
<div class="ttc" id="astructsim__vars___html_a4ecabd97135c500f58175eb7e79f2590"><div class="ttname"><a href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">sim_vars_::ii</a></div><div class="ttdeci">infindividual * ii</div><div class="ttdoc">Pointer to current iteration infectious individual.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00052">simulation.h:52</a></div></div>
<div class="ttc" id="astructsim__pars_html_a661b5d41e285f97a120e2cc9750e8662"><div class="ttname"><a href="structsim__pars.html#a661b5d41e285f97a120e2cc9750e8662">sim_pars::p</a></div><div class="ttdeci">double p</div><div class="ttdoc">Parameter for the logarithmic distribution used to draw number of new infections for a given transmis...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00032">simulation.h:32</a></div></div>
<div class="ttc" id="astructsim__pars_html"><div class="ttname"><a href="structsim__pars.html">sim_pars</a></div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00029">simulation.h:29</a></div></div>
<div class="ttc" id="astructsim__pars_html_acddde30706db8c2da2073310d35d86c3"><div class="ttname"><a href="structsim__pars.html#acddde30706db8c2da2073310d35d86c3">sim_pars::q</a></div><div class="ttdeci">double q</div><div class="ttdoc">Probability of alternate communicable period.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00037">simulation.h:37</a></div></div>
<div class="ttc" id="asimulation_8h_html_a25404969c762d39ee77eb67bc8611428"><div class="ttname"><a href="simulation_8h.html#a25404969c762d39ee77eb67bc8611428">simulate</a></div><div class="ttdeci">int simulate(sim_vars *sv)</div><div class="ttdoc">Performs the simulation.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8c_source.html#l00099">simulation.c:99</a></div></div>
<div class="ttc" id="asimulation_8h_html_a909090a23b94d15cfc7fe877c85466b1"><div class="ttname"><a href="simulation_8h.html#a909090a23b94d15cfc7fe877c85466b1">dummy_proc_func_one_par</a></div><div class="ttdeci">static void dummy_proc_func_one_par(infindividual *inf)</div><div class="ttdoc">Default processing function.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00340">simulation.h:340</a></div></div>
<div class="ttc" id="asimulation_8h_html_aed5a49fbb45324e1dd02058122f6b70a"><div class="ttname"><a href="simulation_8h.html#aed5a49fbb45324e1dd02058122f6b70a">gen_time_periods</a></div><div class="ttdeci">static void gen_time_periods(sim_vars *sv)</div><div class="ttdoc">Generates an uninterrupted communicable period and a latent period.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00252">simulation.h:252</a></div></div>
<div class="ttc" id="asimulation_8h_html_ae122699e5ed7266492671f08ad74f0f1"><div class="ttname"><a href="simulation_8h.html#ae122699e5ed7266492671f08ad74f0f1">sim_set_proc_data</a></div><div class="ttdeci">static void sim_set_proc_data(sim_vars *sv, void *dataptr)</div><div class="ttdoc">Initialises the simulation-level data pointer for user-defined functions.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00095">simulation.h:95</a></div></div>
<div class="ttc" id="astructsim__pars_html_a000dd4e08e042a498ebd7e958f287093"><div class="ttname"><a href="structsim__pars.html#a000dd4e08e042a498ebd7e958f287093">sim_pars::tbar</a></div><div class="ttdeci">double tbar</div><div class="ttdoc">Mean uninterrupted communicable period.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00031">simulation.h:31</a></div></div>
<div class="ttc" id="asimulation_8h_html_a5bde1baf6ffdfb13173d7dd10983bb68"><div class="ttname"><a href="simulation_8h.html#a5bde1baf6ffdfb13173d7dd10983bb68">sim_free</a></div><div class="ttdeci">static void sim_free(sim_vars *sv)</div><div class="ttdoc">Frees the dynamic memory used in the simulation handle.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00168">simulation.h:168</a></div></div>
<div class="ttc" id="astructsim__vars___html_a3884cb21e08092c3e9c686bebc2e06c1"><div class="ttname"><a href="structsim__vars__.html#a3884cb21e08092c3e9c686bebc2e06c1">sim_vars_::new_event_proc_func</a></div><div class="ttdeci">bool(* new_event_proc_func)(struct sim_vars_ *sv)</div><div class="ttdoc">Pointer to the user-defined processing function that is called when a new transmission event is creat...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00057">simulation.h:57</a></div></div>
<div class="ttc" id="astructinfindividual_html_aa01451a784f0632d3b6886b208dec889"><div class="ttname"><a href="structinfindividual.html#aa01451a784f0632d3b6886b208dec889">infindividual::latent_period</a></div><div class="ttdeci">double latent_period</div><div class="ttdoc">Latent period.</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00023">infindividual.h:23</a></div></div>
<div class="ttc" id="asimulation_8h_html_af5bcf389e2f823c77eaeb9c114ba8217"><div class="ttname"><a href="simulation_8h.html#af5bcf389e2f823c77eaeb9c114ba8217">sim_set_new_event_proc_func</a></div><div class="ttdeci">static void sim_set_new_event_proc_func(sim_vars *sv, bool(*new_event_proc_func)(sim_vars *sv))</div><div class="ttdoc">Sets the user-defined processing function that is called when a new transmission event is created.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00109">simulation.h:109</a></div></div>
<div class="ttc" id="astructsim__vars___html_a512ad1b3e3afc84900cb0940bf31e5d3"><div class="ttname"><a href="structsim__vars__.html#a512ad1b3e3afc84900cb0940bf31e5d3">sim_vars_::gen_time_periods_func</a></div><div class="ttdeci">void(* gen_time_periods_func)(struct sim_vars_ *)</div><div class="ttdoc">Pointer to the function used to generate time periods for a given infectious individual.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00055">simulation.h:55</a></div></div>
<div class="ttc" id="asimulation_8h_html_a5c8ef3c24dad2c469a42784a9a39403b"><div class="ttname"><a href="simulation_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">DEBUG_PRINTF</a></div><div class="ttdeci">#define DEBUG_PRINTF(...)</div><div class="ttdoc">Debug print function.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00023">simulation.h:23</a></div></div>
<div class="ttc" id="astructsim__vars___html_aaea3fd761978e15b95707db83a0121f5"><div class="ttname"><a href="structsim__vars__.html#aaea3fd761978e15b95707db83a0121f5">sim_vars_::pars</a></div><div class="ttdeci">sim_pars pars</div><div class="ttdoc">Simulation input parameters.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00049">simulation.h:49</a></div></div>
<div class="ttc" id="asimulation_8h_html_a4ecfceeb3812509d92a677d9c65d6d9a"><div class="ttname"><a href="simulation_8h.html#a4ecfceeb3812509d92a677d9c65d6d9a">dummy_proc_func_sv</a></div><div class="ttdeci">static void dummy_proc_func_sv(sim_vars *sv)</div><div class="ttdoc">Default processing function.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00332">simulation.h:332</a></div></div>
<div class="ttc" id="asimulation_8h_html_ac390bfd4185b26248b9ea2990e075964"><div class="ttname"><a href="simulation_8h.html#ac390bfd4185b26248b9ea2990e075964">sim_init</a></div><div class="ttdeci">int sim_init(sim_vars *sv, sim_pars *pars, const gsl_rng *r)</div><div class="ttdoc">Initialises the simulation.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8c_source.html#l00075">simulation.c:75</a></div></div>
<div class="ttc" id="astructsim__vars___html_aa811264d61ffd4e711034cd3965ec48b"><div class="ttname"><a href="structsim__vars__.html#aa811264d61ffd4e711034cd3965ec48b">sim_vars_::new_inf_proc_func</a></div><div class="ttdeci">void(* new_inf_proc_func)(infindividual *newinf)</div><div class="ttdoc">Pointer to the user-defined processing function that is called when a new infected individual is crea...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00058">simulation.h:58</a></div></div>
<div class="ttc" id="astructsim__pars_html_abfab632383b0b2ead4ef8df7fc1368ba"><div class="ttname"><a href="structsim__pars.html#abfab632383b0b2ead4ef8df7fc1368ba">sim_pars::kappal</a></div><div class="ttdeci">double kappal</div><div class="ttdoc">kappa parameter for the gamma distribution used to generate the latent period</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00036">simulation.h:36</a></div></div>
<div class="ttc" id="astructsim__pars_html_a87db097b251e1b6022de8ee8df4827ac"><div class="ttname"><a href="structsim__pars.html#a87db097b251e1b6022de8ee8df4827ac">sim_pars::nstart</a></div><div class="ttdeci">uint32_t nstart</div><div class="ttdoc">Initial number of infectious individuals.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00041">simulation.h:41</a></div></div>
<div class="ttc" id="asimulation_8h_html_a881fb314fa7f96332cfe3f324287400f"><div class="ttname"><a href="simulation_8h.html#a881fb314fa7f96332cfe3f324287400f">default_event_proc_func</a></div><div class="ttdeci">static bool default_event_proc_func(sim_vars *sv)</div><div class="ttdoc">Default processing function that is called when a new transmission event is created.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00312">simulation.h:312</a></div></div>
<div class="ttc" id="astructsim__vars___html_a8371841f622cffaa066aade2df13c58f"><div class="ttname"><a href="structsim__vars__.html#a8371841f622cffaa066aade2df13c58f">sim_vars_::nlayers</a></div><div class="ttdeci">uint32_t nlayers</div><div class="ttdoc">Current maximum number of layers that has been used so far.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00053">simulation.h:53</a></div></div>
<div class="ttc" id="astructsim__vars___html"><div class="ttname"><a href="structsim__vars__.html">sim_vars_</a></div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00047">simulation.h:47</a></div></div>
<div class="ttc" id="asimulation_8h_html_ae96c5576cb07eb625c14538051f0afd1"><div class="ttname"><a href="simulation_8h.html#ae96c5576cb07eb625c14538051f0afd1">gen_comm_period</a></div><div class="ttdeci">static void gen_comm_period(sim_vars *sv)</div><div class="ttdoc">Generates an uninterrupted communicable period without latent period.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00191">simulation.h:191</a></div></div>
<div class="ttc" id="astructsim__vars___html_aff1ee1c1322047e1ca12f5d9fa4b0b7f"><div class="ttname"><a href="structsim__vars__.html#aff1ee1c1322047e1ca12f5d9fa4b0b7f">sim_vars_::inf_proc_func_noevent</a></div><div class="ttdeci">void(* inf_proc_func_noevent)(infindividual *inf, void *dataptr)</div><div class="ttdoc">Pointer to the user-defined processing function that is called for an infectious individual that does...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00060">simulation.h:60</a></div></div>
<div class="ttc" id="astructsim__pars_html_a9a259a96b53ca013c571c0cc28649d6a"><div class="ttname"><a href="structsim__pars.html#a9a259a96b53ca013c571c0cc28649d6a">sim_pars::kappa</a></div><div class="ttdeci">double kappa</div><div class="ttdoc">branchim's kappa parameter for the gamma distribution used to generate the uninterrupted communicable...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00034">simulation.h:34</a></div></div>
<div class="ttc" id="asimulation_8h_html_a4ad9e4686543e5e6535b538a29dcd169"><div class="ttname"><a href="simulation_8h.html#a4ad9e4686543e5e6535b538a29dcd169">sim_set_increase_layers_proc_func</a></div><div class="ttdeci">static void sim_set_increase_layers_proc_func(sim_vars *sv, void(*increase_layers_proc_func)(infindividual *iis, uint32_t n))</div><div class="ttdoc">Sets the user-defined processing function that is called when the maximum number of layers is increas...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00135">simulation.h:135</a></div></div>
<div class="ttc" id="asimulation_8h_html_a9e0b56e8119109b841681b7489e9eb4f"><div class="ttname"><a href="simulation_8h.html#a9e0b56e8119109b841681b7489e9eb4f">sim_set_new_inf_proc_func</a></div><div class="ttdeci">static void sim_set_new_inf_proc_func(sim_vars *sv, void(*new_inf_proc_func)(infindividual *newinf))</div><div class="ttdoc">Sets the user-defined processing function that is called when a new infected individual is created.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00121">simulation.h:121</a></div></div>
<div class="ttc" id="astructsim__pars_html_a2050972eeb28af006b2e92ecf2f5606a"><div class="ttname"><a href="structsim__pars.html#a2050972eeb28af006b2e92ecf2f5606a">sim_pars::lbar</a></div><div class="ttdeci">double lbar</div><div class="ttdoc">Mean latent pariod.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00035">simulation.h:35</a></div></div>
<div class="ttc" id="asimulation_8h_html_a43209d4db5fb03b575e3b61a72877b87"><div class="ttname"><a href="simulation_8h.html#a43209d4db5fb03b575e3b61a72877b87">default_increase_layers_proc_func</a></div><div class="ttdeci">static void default_increase_layers_proc_func(infindividual *iis, uint32_t n)</div><div class="ttdoc">Default processing function that is called when the maximum number of layers is increased.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00324">simulation.h:324</a></div></div>
<div class="ttc" id="astructinfindividual_html"><div class="ttname"><a href="structinfindividual.html">infindividual</a></div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00020">infindividual.h:20</a></div></div>
<div class="ttc" id="astructsim__pars_html_aaa990fffe8036f83a95fd6c2c6bdc384"><div class="ttname"><a href="structsim__pars.html#aaa990fffe8036f83a95fd6c2c6bdc384">sim_pars::kappaq</a></div><div class="ttdeci">double kappaq</div><div class="ttdoc">branchim's kappa parameter for the gamma distribution used to generate the alternate communicable per...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00039">simulation.h:39</a></div></div>
<div class="ttc" id="ainfindividual_8h_html"><div class="ttname"><a href="infindividual_8h.html">infindividual.h</a></div><div class="ttdoc">Data structure containing infected individual information.</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="simulation_8h.html">simulation.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
