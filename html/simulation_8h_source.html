<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>branchsimc: simulation.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">branchsimc
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">branchsimc Outbreak Branching Model Simulation Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('simulation_8h_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">simulation.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="simulation_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * @file simulation.h</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * @brief Simulation data structures and functions.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * @author &lt;Pierre-Luc.Drouin@drdc-rddc.gc.ca&gt;, Defence Research and Development Canada Ottawa Research Centre.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * Original model from &lt;jerome.levesque@tpsgc-pwgsc.gc.ca&gt; and</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * &lt;david.maybury@tpsgc-pwgsc.gc.ca&gt;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#ifndef _SIMULATION_</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#define _SIMULATION_</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160; </div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;stdint.h&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;math.h&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;gsl/gsl_rng.h&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;gsl/gsl_randist.h&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="infindividual_8h.html">infindividual.h</a>&quot;</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="model__parameters_8h.html">model_parameters.h</a>&quot;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno"><a class="line" href="simulation_8h.html#a5655a86be72747864aa32dadb4fa6b49">   22</a></span>&#160;<span class="preprocessor">#define INIT_N_LAYERS (16) </span><span class="comment">//!&lt; Initial number of simulation layers</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="simulation_8h.html#a5c8ef3c24dad2c469a42784a9a39403b">   24</a></span>&#160;<span class="preprocessor">#define DEBUG_PRINTF(...) </span><span class="comment">//!&lt; Debug print function</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"></span>//#define DEBUG_PRINTF(...) printf(__VA_ARGS__) <span class="comment">//!&lt; Debug print function</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment"> * Simulation variables</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00030"></a><span class="lineno"><a class="line" href="structsim__vars__.html">   30</a></span>&#160;<span class="keyword">typedef</span> <span class="keyword">struct </span><a class="code" href="structsim__vars__.html">sim_vars_</a></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;{</div>
<div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="structsim__vars__.html#aac0335e2677fb786bfaf201d5e4730af">   32</a></span>&#160;  <a class="code" href="structmodel__pars.html">model_pars</a> <a class="code" href="structsim__vars__.html#aac0335e2677fb786bfaf201d5e4730af">pars</a>;      <span class="comment">//!&lt; Simulation input parameters</span></div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">   33</a></span>&#160;<span class="comment"></span>  gsl_rng <span class="keyword">const</span>* <a class="code" href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">r</a>;     <span class="comment">//!&lt; Pointer to GSL random number generator</span></div>
<div class="line"><a name="l00034"></a><span class="lineno"><a class="line" href="structsim__vars__.html#a1fac67c0df42bd1eb01036cd4694ea2d">   34</a></span>&#160;<span class="comment"></span>  <a class="code" href="structinfindividual.html">infindividual</a>* <a class="code" href="structsim__vars__.html#a1fac67c0df42bd1eb01036cd4694ea2d">iis</a>;   <span class="comment">//!&lt; Array of current infectious individuals across all layers</span></div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">   35</a></span>&#160;<span class="comment"></span>  <a class="code" href="structinfindividual.html">infindividual</a>* <a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>;    <span class="comment">//!&lt; Pointer to current iteration infectious individual</span></div>
<div class="line"><a name="l00036"></a><span class="lineno"><a class="line" href="structsim__vars__.html#a8371841f622cffaa066aade2df13c58f">   36</a></span>&#160;<span class="comment"></span>  uint32_t <a class="code" href="structsim__vars__.html#a8371841f622cffaa066aade2df13c58f">nlayers</a>;     <span class="comment">//!&lt; Current maximum number of layers that has been used so far </span></div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">   37</a></span>&#160;<span class="comment"></span>  <span class="keywordtype">void</span>* <a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>;        <span class="comment">//!&lt; Simulation-level data pointer for user-defined functions</span></div>
<div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="structsim__vars__.html#a512ad1b3e3afc84900cb0940bf31e5d3">   38</a></span>&#160;<span class="comment"></span>  void (*<a class="code" href="structsim__vars__.html#a512ad1b3e3afc84900cb0940bf31e5d3">gen_time_periods_func</a>)(<span class="keyword">struct </span><a class="code" href="structsim__vars__.html">sim_vars_</a>*);             <span class="comment">//!&lt; Pointer to the function used to generate time periods for a given infectious individual</span></div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="structsim__vars__.html#a7138287fc57ef7b9243d9553c4fbba35">   39</a></span>&#160;<span class="comment"></span>  void (*<a class="code" href="structsim__vars__.html#a7138287fc57ef7b9243d9553c4fbba35">increase_layers_proc_func</a>)(<a class="code" href="structinfindividual.html">infindividual</a>* <a class="code" href="structsim__vars__.html#a1fac67c0df42bd1eb01036cd4694ea2d">iis</a>, uint32_t n);    <span class="comment">//!&lt; Pointer to the user-defined processing function that is called when the maximum number of layers is increased.</span></div>
<div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="structsim__vars__.html#a3884cb21e08092c3e9c686bebc2e06c1">   40</a></span>&#160;<span class="comment"></span>  bool (*<a class="code" href="structsim__vars__.html#a3884cb21e08092c3e9c686bebc2e06c1">new_event_proc_func</a>)(<span class="keyword">struct </span><a class="code" href="structsim__vars__.html">sim_vars_</a>* sv);                <span class="comment">//!&lt; Pointer to the user-defined processing function that is called when a new transmission event is created, after an event time and the number of new infections have been assigned. The function is also called at the beginning of the simulation to account for the initial infectious individuals. The returned value from this function determines if new infectious individuals are instantiated for this event.</span></div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="structsim__vars__.html#aa811264d61ffd4e711034cd3965ec48b">   41</a></span>&#160;<span class="comment"></span>  void (*<a class="code" href="structsim__vars__.html#aa811264d61ffd4e711034cd3965ec48b">new_inf_proc_func</a>)(<a class="code" href="structinfindividual.html">infindividual</a>* newinf);         <span class="comment">//!&lt; Pointer to the user-defined processing function that is called when a new infected individual is created, after the communicable period and the number of transmission events have been assigned. The function is only called if the number of transmission events is non-zero. </span></div>
<div class="line"><a name="l00042"></a><span class="lineno"><a class="line" href="structsim__vars__.html#a0185f5ecedb040b1b8fb20a6f40f7b87">   42</a></span>&#160;<span class="comment"></span>  void (*<a class="code" href="structsim__vars__.html#a0185f5ecedb040b1b8fb20a6f40f7b87">end_inf_proc_func</a>)(<a class="code" href="structinfindividual.html">infindividual</a>* inf, <span class="keywordtype">void</span>* <a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>);         <span class="comment">//!&lt; Pointer to the user-defined processing function that is called once all transmission events for a given infectious individual have been generated.</span></div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="structsim__vars__.html#aff1ee1c1322047e1ca12f5d9fa4b0b7f">   43</a></span>&#160;<span class="comment"></span>  void (*<a class="code" href="structsim__vars__.html#aff1ee1c1322047e1ca12f5d9fa4b0b7f">inf_proc_func_noevent</a>)(<a class="code" href="structinfindividual.html">infindividual</a>* inf, <span class="keywordtype">void</span>* <a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>); <span class="comment">//!&lt; Pointer to the user-defined processing function that is called for an infectious individual that does not generate any transmission event.</span></div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"></span>} <a class="code" href="simulation_8h.html#af56e48cea71d8ff85c6a1651de1707bf">sim_vars</a>;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment"> * @brief Verifies the validity of simulation parameters.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment"> * This internal function verifies if the set of provided simulation parameter values are</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment"> * valid.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment"> * @param pars: Pointer to the simulation parameters.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment"> * @return 0 if the parameters are valid. If the parameters are</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"> * invalid, an error is printed on stderr.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;<span class="keywordtype">int</span> <a class="code" href="simulation_8h.html#afd981fab1171f8b03e1c952b20f6f3ff">sim_pars_check</a>(<a class="code" href="structmodel__pars.html">model_pars</a> <span class="keyword">const</span>* <a class="code" href="structsim__vars__.html#aac0335e2677fb786bfaf201d5e4730af">pars</a>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="comment"> * @brief Initialises simulation parameters.</span></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment"> * This function must be called to initialise simulation</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment"> * parameters.</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;<span class="comment"> * @param pars: Pointer to the simulation parameters</span></div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;<span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a7d7687ebb34e4df53eff1ed32e7f7597">sim_pars_init</a>(<a class="code" href="structmodel__pars.html">model_pars</a>* <a class="code" href="structsim__vars__.html#aac0335e2677fb786bfaf201d5e4730af">pars</a>);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;<span class="comment"> * @brief Initialises the simulation.</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;<span class="comment"> * This function must be called to initialise the simulation.</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation handle.</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="comment"> * @param pars: Pointer to the simulation parameters</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="comment"> * @param r: Pointer to the GSL random number generator.</span></div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment"> * @return 0 if the simulation was initialised successfully.</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keywordtype">int</span> <a class="code" href="simulation_8h.html#a8013ee290efe1e7f13b3e6e4d262ed59">sim_init</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <a class="code" href="structmodel__pars.html">model_pars</a>* <a class="code" href="structsim__vars__.html#aac0335e2677fb786bfaf201d5e4730af">pars</a>, <span class="keyword">const</span> gsl_rng* <a class="code" href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">r</a>);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"> * @brief Initialises the simulation-level data pointer for user-defined functions.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"> * This function can be used to set the simulation-level data pointer for user-defined functions.</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"> * @param dataptr: Data pointer.</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="simulation_8h.html#ae122699e5ed7266492671f08ad74f0f1">   88</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#ae122699e5ed7266492671f08ad74f0f1">sim_set_proc_data</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <span class="keywordtype">void</span>* <a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>){sv-&gt;<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>=<a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>;}</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment"> * @brief Sets the user-defined processing function that is called when a new transmission event is created.</span></div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment"> * This function is called after an event time and the number of new infections</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment"> * have been assigned. The function is also called at the beginning of the simulation</span></div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment"> * to account for the initial infectious individuals.</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment"> * @param new_event_proc_func: Pointer to the user-defined function.</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment"> * @return true if new infectious individuals are to be instantiated from this</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment"> * event, false otherwise.</span></div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00102"></a><span class="lineno"><a class="line" href="simulation_8h.html#af5bcf389e2f823c77eaeb9c114ba8217">  102</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#af5bcf389e2f823c77eaeb9c114ba8217">sim_set_new_event_proc_func</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <span class="keywordtype">bool</span> (*<a class="code" href="structsim__vars__.html#a3884cb21e08092c3e9c686bebc2e06c1">new_event_proc_func</a>)(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv)){sv-&gt;<a class="code" href="structsim__vars__.html#a3884cb21e08092c3e9c686bebc2e06c1">new_event_proc_func</a>=<a class="code" href="structsim__vars__.html#a3884cb21e08092c3e9c686bebc2e06c1">new_event_proc_func</a>;}</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment"> * @brief Sets the user-defined processing function that is called when a new infected individual is created.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="comment"> * This function is called after the communicable period and the number of</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="comment"> * transmission events have been assigned. The function is only called if the number</span></div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="comment"> * of transmission events is non-zero.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="comment"> * @param new_inf_proc_func: Pointer to the user-defined function.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00114"></a><span class="lineno"><a class="line" href="simulation_8h.html#a9e0b56e8119109b841681b7489e9eb4f">  114</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a9e0b56e8119109b841681b7489e9eb4f">sim_set_new_inf_proc_func</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <span class="keywordtype">void</span> (*<a class="code" href="structsim__vars__.html#aa811264d61ffd4e711034cd3965ec48b">new_inf_proc_func</a>)(<a class="code" href="structinfindividual.html">infindividual</a>* newinf)){sv-&gt;<a class="code" href="structsim__vars__.html#aa811264d61ffd4e711034cd3965ec48b">new_inf_proc_func</a>=<a class="code" href="structsim__vars__.html#aa811264d61ffd4e711034cd3965ec48b">new_inf_proc_func</a>;}</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="comment"> * @brief Sets the user-defined processing function that is called when the maximum number of layers is increased.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="comment"> * This function is called after the array of infectious individuals has been</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;<span class="comment"> * resized.</span></div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="comment"> * @param increase_layers_proc_func: Pointer to the user-defined function. The</span></div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="comment"> * first argument of this function points to the infectious individuals array,</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="comment"> * starting with the first newly allocated layer, and the second argument is the</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="comment"> * number of layers that have been added.</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="simulation_8h.html#a4ad9e4686543e5e6535b538a29dcd169">  128</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a4ad9e4686543e5e6535b538a29dcd169">sim_set_increase_layers_proc_func</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <span class="keywordtype">void</span> (*<a class="code" href="structsim__vars__.html#a7138287fc57ef7b9243d9553c4fbba35">increase_layers_proc_func</a>)(<a class="code" href="structinfindividual.html">infindividual</a>* <a class="code" href="structsim__vars__.html#a1fac67c0df42bd1eb01036cd4694ea2d">iis</a>, uint32_t n)){sv-&gt;<a class="code" href="structsim__vars__.html#a7138287fc57ef7b9243d9553c4fbba35">increase_layers_proc_func</a>=<a class="code" href="structsim__vars__.html#a7138287fc57ef7b9243d9553c4fbba35">increase_layers_proc_func</a>;}</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="comment"> * @brief Sets the user-defined processing function that is called once all</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment"> * transmission events for a given infectious individual have been generated.</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment"> * @param end_inf_proc_func: Pointer to the user-defined function. The second</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;<span class="comment"> * argument for this function is the simulation-level data pointer.</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00138"></a><span class="lineno"><a class="line" href="simulation_8h.html#aaf6b49ed5309f072770c4c2038371e50">  138</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#aaf6b49ed5309f072770c4c2038371e50">sim_set_end_inf_proc_func</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <span class="keywordtype">void</span> (*<a class="code" href="structsim__vars__.html#a0185f5ecedb040b1b8fb20a6f40f7b87">end_inf_proc_func</a>)(<a class="code" href="structinfindividual.html">infindividual</a>* inf, <span class="keywordtype">void</span>* <a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)){sv-&gt;<a class="code" href="structsim__vars__.html#a0185f5ecedb040b1b8fb20a6f40f7b87">end_inf_proc_func</a>=<a class="code" href="structsim__vars__.html#a0185f5ecedb040b1b8fb20a6f40f7b87">end_inf_proc_func</a>;}</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment"> * @brief Sets the user-defined processing function that is called for an infectious individual that does not generate any transmission event.</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;<span class="comment"> * This function is called after the communicable period has been assigned for</span></div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;<span class="comment"> * the current infectious individual.</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="comment"> * @param inf_proc_func_noevent: Pointer to the user-defined function. The second</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;<span class="comment"> * argument for this function is the simulation-level data pointer.</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="simulation_8h.html#a0f2a0463da67aac089d7e7cf9e23bb77">  150</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a0f2a0463da67aac089d7e7cf9e23bb77">sim_set_inf_proc_noevent_func</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv, <span class="keywordtype">void</span> (*<a class="code" href="structsim__vars__.html#aff1ee1c1322047e1ca12f5d9fa4b0b7f">inf_proc_func_noevent</a>)(<a class="code" href="structinfindividual.html">infindividual</a>* inf, <span class="keywordtype">void</span>* <a class="code" href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">dataptr</a>)){sv-&gt;<a class="code" href="structsim__vars__.html#aff1ee1c1322047e1ca12f5d9fa4b0b7f">inf_proc_func_noevent</a>=<a class="code" href="structsim__vars__.html#aff1ee1c1322047e1ca12f5d9fa4b0b7f">inf_proc_func_noevent</a>;}</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="comment"> * @brief Frees the dynamic memory used in the simulation handle.</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="comment"> * Does not free</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="comment"> * any memory related to the simulation-level data pointer for the user-defined</span></div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="comment"> * functions.</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00161"></a><span class="lineno"><a class="line" href="simulation_8h.html#a5bde1baf6ffdfb13173d7dd10983bb68">  161</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a5bde1baf6ffdfb13173d7dd10983bb68">sim_free</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv){free(sv-&gt;<a class="code" href="structsim__vars__.html#a1fac67c0df42bd1eb01036cd4694ea2d">iis</a>);}</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="comment"> * @brief Performs the simulation.</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment"> * Performs the simulation, as configured through the simulation variables. This</span></div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment"> * function can be called multiple times in a row.</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment"> * @return 0 if there is no error.</span></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="keywordtype">int</span> <a class="code" href="simulation_8h.html#a25404969c762d39ee77eb67bc8611428">simulate</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">//! @cond Doxygen_Suppress</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"></span><span class="comment">/**</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"> * The preprocessing macros below are used by the main GEN_PER macro.</span></div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="preprocessor">#define GEN_PER_LATENT_0 sv-&gt;ii-&gt;latent_period=0;</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="preprocessor">#define GEN_PER_LATENT_1 sv-&gt;ii-&gt;latent_period=sv-&gt;pars.lbar;</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="preprocessor">#define GEN_PER_LATENT_2 sv-&gt;ii-&gt;latent_period=gsl_ran_gamma(sv-&gt;r, sv-&gt;pars.kappal*sv-&gt;pars.lbar, 1./sv-&gt;pars.kappal);</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160; </div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="preprocessor">#define GEN_PER_INTERRUPTED_MAIN_0</span></div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="preprocessor">#define GEN_PER_INTERRUPTED_MAIN_1 if(gsl_rng_uniform(sv-&gt;r) &lt; sv-&gt;pars.pit &amp;&amp; sv-&gt;pars.itbar &lt; sv-&gt;ii-&gt;comm_period) sv-&gt;ii-&gt;comm_period=sv-&gt;pars.itbar;</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="preprocessor">#define GEN_PER_INTERRUPTED_MAIN_2 if(gsl_rng_uniform(sv-&gt;r) &lt; sv-&gt;pars.pit) {const double time=gsl_ran_gamma(sv-&gt;r, sv-&gt;pars.kappait*sv-&gt;pars.itbar, 1./sv-&gt;pars.kappait); if(time &lt; sv-&gt;ii-&gt;comm_period) sv-&gt;ii-&gt;comm_period=time;}</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="preprocessor">#define GEN_PER_MAIN_1(IT) sv-&gt;ii-&gt;comm_period=sv-&gt;pars.tbar; GEN_PER_INTERRUPTED_MAIN_ ## IT;</span></div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="preprocessor">#define GEN_PER_MAIN_2(IT) sv-&gt;ii-&gt;comm_period=gsl_ran_gamma(sv-&gt;r, sv-&gt;pars.kappa*sv-&gt;pars.tbar, 1./sv-&gt;pars.kappa); GEN_PER_INTERRUPTED_MAIN_ ## IT;</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160; </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="preprocessor">#define GEN_PER_INTERRUPTED_ALT_0</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="preprocessor">#define GEN_PER_INTERRUPTED_ALT_1 if(gsl_rng_uniform(sv-&gt;r) &lt; sv-&gt;pars.pim &amp;&amp; sv-&gt;pars.imbar &lt; sv-&gt;ii-&gt;comm_period) sv-&gt;ii-&gt;comm_period=sv-&gt;pars.imbar;</span></div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="preprocessor">#define GEN_PER_INTERRUPTED_ALT_2 if(gsl_rng_uniform(sv-&gt;r) &lt; sv-&gt;pars.pim) {const double time=gsl_ran_gamma(sv-&gt;r, sv-&gt;pars.kappaim*sv-&gt;pars.imbar, 1./sv-&gt;pars.kappaim); if(time &lt; sv-&gt;ii-&gt;comm_period) sv-&gt;ii-&gt;comm_period=time;}</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160; </div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="preprocessor">#define GEN_PER_ALTERNATE_0(MAIN,IT,IM) GEN_PER_MAIN_ ## MAIN(IT);</span></div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor">#define GEN_PER_ALTERNATE_1(MAIN,IT,IM) if(gsl_rng_uniform(sv-&gt;r) &lt; sv-&gt;pars.q) {sv-&gt;ii-&gt;comm_period=sv-&gt;pars.mbar; GEN_PER_INTERRUPTED_ALT_ ## IM} else GEN_PER_MAIN_ ## MAIN(IT);</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="preprocessor">#define GEN_PER_ALTERNATE_2(MAIN,IT,IM) if(gsl_rng_uniform(sv-&gt;r) &lt; sv-&gt;pars.q) {sv-&gt;ii-&gt;comm_period=gsl_ran_gamma(sv-&gt;r, sv-&gt;pars.kappaq*sv-&gt;pars.mbar, 1./sv-&gt;pars.kappaq); GEN_PER_INTERRUPTED_ALT_ ## IM} else GEN_PER_MAIN_ ## MAIN(IT);</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment">//! @endcond</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"> * @brief Generates one function that generates a specific combination of</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"> * communicable and latent periods.</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"> * This preprocessing macro generates a function that</span></div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"> * generates the communicable period for the current</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"> * infectious individual and a latent period, as determined by the</span></div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"> * simulation variables and parameters. It considers the alternate</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"> * communicable period based on the q simulation parameter, as well</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment"> * as the two types of interrupted periods. It also sets the</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment"> * infectious_at_tmax parameter for the current infectious</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;<span class="comment"> * individual.</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment"> * @param LATENT: Type of latent period (0=none, 1=fixed, 2=variable)</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment"> * @param MAIN: Type of main period (1=fixed, 2=variable)</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment"> * @param IT: Type of interrupted main period (0=none, 1=fixed, 2=variable)</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"> * @param ALTERNATE: Type of alternate period (0=none, 1=fixed, 2=variable)</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment"> * @param IM: Type of interrupted alternate period (0=none, 1=fixed, 2=variable)</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment"> * latent)</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="simulation_8h.html#a11c36c17ab153322bdb53907a519f423">  218</a></span>&#160;<span class="preprocessor">#define GEN_PER(LATENT,MAIN,IT,ALTERNATE,IM) static inline void gen_comm_ ## LATENT ## _ ## MAIN ## _ ## IT ## _ ## ALTERNATE ## _ ## IM ## _periods(sim_vars* sv) \</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="preprocessor">{ \</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="preprocessor">  GEN_PER_LATENT_ ## LATENT \</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="preprocessor">  GEN_PER_ALTERNATE_ ## ALTERNATE(MAIN,IT,IM) \</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="preprocessor">  double time_left=sv-&gt;pars.tmax-(sv-&gt;ii-1)-&gt;event_time; \</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;<span class="preprocessor"> \</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;<span class="preprocessor">  if(sv-&gt;ii-&gt;comm_period &gt; time_left) { \</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;<span class="preprocessor">    sv-&gt;ii-&gt;infectious_at_tmax=true; \</span></div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;<span class="preprocessor"> \</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;<span class="preprocessor">  } else sv-&gt;ii-&gt;infectious_at_tmax=false; \</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="preprocessor">  DEBUG_PRINTF(&quot;Comm period is %f%s\n&quot;,sv-&gt;ii-&gt;comm_period,(sv-&gt;ii-&gt;infectious_at_tmax?&quot; (reached end)&quot;:&quot;&quot;)); \</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="preprocessor">}</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;<span class="comment">//! @cond Doxygen_Suppress</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="comment"></span><span class="comment">/**</span></div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;<span class="comment"> * The preprocessing macros below are used by the main GEN_PERS_MAIN macro.</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;<span class="preprocessor">#define GEN_PERS_IM(LATENT,MAIN,IT,ALTERNATE) GEN_PER(LATENT,MAIN,IT,ALTERNATE,0) GEN_PER(LATENT,MAIN,IT,ALTERNATE,1) GEN_PER(LATENT,MAIN,IT,ALTERNATE,2)</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;<span class="preprocessor">#define GEN_PERS_ALT(LATENT,MAIN,IT) GEN_PER(LATENT,MAIN,IT,0,0) GEN_PERS_IM(LATENT,MAIN,IT,1) GEN_PERS_IM(LATENT,MAIN,IT,2)</span></div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;<span class="preprocessor">#define GEN_PERS_IT(LATENT,MAIN) GEN_PERS_ALT(LATENT,MAIN,0) GEN_PERS_ALT(LATENT,MAIN,1) GEN_PERS_ALT(LATENT,MAIN,2)</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">//! @endcond</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;<span class="comment"> * @brief For a given type of latent period, generates functions that each</span></div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;<span class="comment"> * generates a specific combination of communicable and latent periods.</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="comment"> * @param LATENT: Type of latent period (0=none, 1=fixed, 2=variable)</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00246"></a><span class="lineno"><a class="line" href="simulation_8h.html#a98ef81198e297e099096bad9f1251649">  246</a></span>&#160;<span class="preprocessor">#define GEN_PERS_MAIN(LATENT) GEN_PERS_IT(LATENT,1) GEN_PERS_IT(LATENT,2)</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<a class="code" href="simulation_8h.html#a98ef81198e297e099096bad9f1251649">GEN_PERS_MAIN</a>(0)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<a class="code" href="simulation_8h.html#a98ef81198e297e099096bad9f1251649">GEN_PERS_MAIN</a>(1)</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;<a class="code" href="simulation_8h.html#a98ef81198e297e099096bad9f1251649">GEN_PERS_MAIN</a>(2)</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="comment">//! @cond Doxygen_Suppress</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;<span class="comment"></span><span class="comment">/**</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;<span class="comment"> * The preprocessing macros below are used by the main PER_COND macro.</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="preprocessor">#define PER_COND_IM(IMPREFIX) if(!(sv-&gt;pars.pim&gt;0)) sv-&gt;gen_time_periods_func=gen_comm_ ## IMPREFIX ## _0_periods; else if(isinf(sv-&gt;pars.kappaim)) sv-&gt;gen_time_periods_func=gen_comm_ ## IMPREFIX ## _1_periods; else sv-&gt;gen_time_periods_func=gen_comm_ ## IMPREFIX ## _2_periods;</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;<span class="preprocessor">#define PER_COND_ALT(ALTPREFIX) if(!(sv-&gt;pars.q&gt;0)) sv-&gt;gen_time_periods_func=gen_comm_ ## ALTPREFIX ## _0_0_periods; else if(isinf(sv-&gt;pars.kappaq)) {PER_COND_IM(ALTPREFIX ## _1)} else {PER_COND_IM(ALTPREFIX ## _2)};</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;<span class="preprocessor">#define PER_COND_IT(ITPREFIX) if(!(sv-&gt;pars.pit&gt;0)) {PER_COND_ALT(ITPREFIX ## _0)} else if(isinf(sv-&gt;pars.kappait)) {PER_COND_ALT(ITPREFIX ## _1)} else {PER_COND_ALT(ITPREFIX ## _2)};</span></div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="preprocessor">#define PER_COND_MAIN(MAINPREFIX) if(isinf(sv-&gt;pars.kappa)) {PER_COND_IT(MAINPREFIX ## _1)} else {PER_COND_IT(MAINPREFIX ## _2)};</span></div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;<span class="comment">//! @endcond</span></div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="comment"></span><span class="comment"></span> </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;<span class="comment"> * @brief Generates the conditional code that assigns the function that</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment"> * generates a specific combination of communicable and latent periods.</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;<span class="comment"> * This preprocessing macro generates the conditional code that assigns the</span></div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;<span class="comment"> * function that generates a specific combination of communicable and latent</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;<span class="comment"> * periods to the gen_time_periods_func pointer of the simulation, given the</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;<span class="comment"> * configuration of the model parameters.</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="simulation_8h.html#a27c7cde9db55b6b22c9bb6287c0b19ab">  270</a></span>&#160;<span class="preprocessor">#define PER_COND if(isnan(sv-&gt;pars.kappal)) {PER_COND_MAIN(0)} else if(isinf(sv-&gt;pars.kappal)) {PER_COND_MAIN(1)} else {PER_COND_MAIN(2)};</span></div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;<span class="comment"> * @brief Default processing function that is called when a new transmission event is created.</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;<span class="comment"> * This function is called by default if a user-defined function has not been</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;<span class="comment"> * set.</span></div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;<span class="comment"> * @param sv: Pointer to the simulation variables.</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="comment"> * @return true if the event does not occur after tmax, false otherwise.</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="simulation_8h.html#a881fb314fa7f96332cfe3f324287400f">  281</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="simulation_8h.html#a881fb314fa7f96332cfe3f324287400f">default_event_proc_func</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv){<span class="keywordflow">return</span> (sv-&gt;<a class="code" href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">ii</a>-&gt;<a class="code" href="structinfindividual.html#abb69b597195aa750d0fbb4dfa2626025">event_time</a> &lt;= sv-&gt;<a class="code" href="structsim__vars__.html#aac0335e2677fb786bfaf201d5e4730af">pars</a>.<a class="code" href="structmodel__pars.html#aac4af9226e4d189e42d148ce178f4033">tmax</a>);}</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="comment"> * @brief Default processing function that is called when the maximum number of</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;<span class="comment"> * layers is increased.</span></div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment"> * This function is called by default if a user-defined function has not been</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment"> * set. The function does not do anything.</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment"> * @param iis: First newly allocated layer element of the infectious individuals array.</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;<span class="comment"> * @param n: Number of layers that have been added</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00293"></a><span class="lineno"><a class="line" href="simulation_8h.html#a43209d4db5fb03b575e3b61a72877b87">  293</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a43209d4db5fb03b575e3b61a72877b87">default_increase_layers_proc_func</a>(<a class="code" href="structinfindividual.html">infindividual</a>* <a class="code" href="structsim__vars__.html#a1fac67c0df42bd1eb01036cd4694ea2d">iis</a>, uint32_t n){}</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment"> * @brief Default processing function.</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;<span class="comment"> * This function is called by default if a user-defined function has not been</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;<span class="comment"> * set. The function does not do anything.</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="simulation_8h.html#a4ecfceeb3812509d92a677d9c65d6d9a">  301</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a4ecfceeb3812509d92a677d9c65d6d9a">dummy_proc_func_sv</a>(<a class="code" href="structsim__vars__.html">sim_vars</a>* sv){}</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;<span class="comment"> * @brief Default processing function.</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="comment"> * This function is called by default if a user-defined function has not been</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;<span class="comment"> * set. The function does not do anything.</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="simulation_8h.html#a909090a23b94d15cfc7fe877c85466b1">  309</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a909090a23b94d15cfc7fe877c85466b1">dummy_proc_func_one_par</a>(<a class="code" href="structinfindividual.html">infindividual</a>* inf){}</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;<span class="comment">/**</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="comment"> * @brief Default processing function.</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="comment"> * This function is called by default if a user-defined function has not been</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="comment"> * set. The function does not do anything.</span></div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00317"></a><span class="lineno"><a class="line" href="simulation_8h.html#a84beb2084ff7239d40c304cee0506411">  317</a></span>&#160;<span class="keyword">inline</span> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="simulation_8h.html#a84beb2084ff7239d40c304cee0506411">dummy_proc_func_two_pars</a>(<a class="code" href="structinfindividual.html">infindividual</a>* inf, <span class="keywordtype">void</span>* ptr){}</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;<span class="preprocessor">#endif</span></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="asimulation_8h_html_a84beb2084ff7239d40c304cee0506411"><div class="ttname"><a href="simulation_8h.html#a84beb2084ff7239d40c304cee0506411">dummy_proc_func_two_pars</a></div><div class="ttdeci">static void dummy_proc_func_two_pars(infindividual *inf, void *ptr)</div><div class="ttdoc">Default processing function.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00317">simulation.h:317</a></div></div>
<div class="ttc" id="astructsim__vars___html_a8b90e6b2db2c771bb954d0b082fdf96f"><div class="ttname"><a href="structsim__vars__.html#a8b90e6b2db2c771bb954d0b082fdf96f">sim_vars_::r</a></div><div class="ttdeci">gsl_rng const  * r</div><div class="ttdoc">Pointer to GSL random number generator.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00033">simulation.h:33</a></div></div>
<div class="ttc" id="astructsim__vars___html_a7138287fc57ef7b9243d9553c4fbba35"><div class="ttname"><a href="structsim__vars__.html#a7138287fc57ef7b9243d9553c4fbba35">sim_vars_::increase_layers_proc_func</a></div><div class="ttdeci">void(* increase_layers_proc_func)(infindividual *iis, uint32_t n)</div><div class="ttdoc">Pointer to the user-defined processing function that is called when the maximum number of layers is i...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00039">simulation.h:39</a></div></div>
<div class="ttc" id="asimulation_8h_html_af56e48cea71d8ff85c6a1651de1707bf"><div class="ttname"><a href="simulation_8h.html#af56e48cea71d8ff85c6a1651de1707bf">sim_vars</a></div><div class="ttdeci">struct sim_vars_ sim_vars</div></div>
<div class="ttc" id="astructsim__vars___html_ad9d50be547359a56e26030911f2d3d96"><div class="ttname"><a href="structsim__vars__.html#ad9d50be547359a56e26030911f2d3d96">sim_vars_::dataptr</a></div><div class="ttdeci">void * dataptr</div><div class="ttdoc">Simulation-level data pointer for user-defined functions.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00037">simulation.h:37</a></div></div>
<div class="ttc" id="astructsim__vars___html_a1fac67c0df42bd1eb01036cd4694ea2d"><div class="ttname"><a href="structsim__vars__.html#a1fac67c0df42bd1eb01036cd4694ea2d">sim_vars_::iis</a></div><div class="ttdeci">infindividual * iis</div><div class="ttdoc">Array of current infectious individuals across all layers.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00034">simulation.h:34</a></div></div>
<div class="ttc" id="asimulation_8h_html_aaf6b49ed5309f072770c4c2038371e50"><div class="ttname"><a href="simulation_8h.html#aaf6b49ed5309f072770c4c2038371e50">sim_set_end_inf_proc_func</a></div><div class="ttdeci">static void sim_set_end_inf_proc_func(sim_vars *sv, void(*end_inf_proc_func)(infindividual *inf, void *dataptr))</div><div class="ttdoc">Sets the user-defined processing function that is called once all transmission events for a given inf...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00138">simulation.h:138</a></div></div>
<div class="ttc" id="astructsim__vars___html_aac0335e2677fb786bfaf201d5e4730af"><div class="ttname"><a href="structsim__vars__.html#aac0335e2677fb786bfaf201d5e4730af">sim_vars_::pars</a></div><div class="ttdeci">model_pars pars</div><div class="ttdoc">Simulation input parameters.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00032">simulation.h:32</a></div></div>
<div class="ttc" id="astructinfindividual_html_abb69b597195aa750d0fbb4dfa2626025"><div class="ttname"><a href="structinfindividual.html#abb69b597195aa750d0fbb4dfa2626025">infindividual::event_time</a></div><div class="ttdeci">double event_time</div><div class="ttdoc">Start time for the current iteration event.</div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00025">infindividual.h:25</a></div></div>
<div class="ttc" id="asimulation_8h_html_a0f2a0463da67aac089d7e7cf9e23bb77"><div class="ttname"><a href="simulation_8h.html#a0f2a0463da67aac089d7e7cf9e23bb77">sim_set_inf_proc_noevent_func</a></div><div class="ttdeci">static void sim_set_inf_proc_noevent_func(sim_vars *sv, void(*inf_proc_func_noevent)(infindividual *inf, void *dataptr))</div><div class="ttdoc">Sets the user-defined processing function that is called for an infectious individual that does not g...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00150">simulation.h:150</a></div></div>
<div class="ttc" id="amodel__parameters_8h_html"><div class="ttname"><a href="model__parameters_8h.html">model_parameters.h</a></div><div class="ttdoc">Model parameter functions.</div></div>
<div class="ttc" id="astructmodel__pars_html"><div class="ttname"><a href="structmodel__pars.html">model_pars</a></div><div class="ttdef"><b>Definition:</b> <a href="model__parameters_8h_source.html#l00022">model_parameters.h:22</a></div></div>
<div class="ttc" id="astructsim__vars___html_a0185f5ecedb040b1b8fb20a6f40f7b87"><div class="ttname"><a href="structsim__vars__.html#a0185f5ecedb040b1b8fb20a6f40f7b87">sim_vars_::end_inf_proc_func</a></div><div class="ttdeci">void(* end_inf_proc_func)(infindividual *inf, void *dataptr)</div><div class="ttdoc">Pointer to the user-defined processing function that is called once all transmission events for a giv...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00042">simulation.h:42</a></div></div>
<div class="ttc" id="asimulation_8h_html_a98ef81198e297e099096bad9f1251649"><div class="ttname"><a href="simulation_8h.html#a98ef81198e297e099096bad9f1251649">GEN_PERS_MAIN</a></div><div class="ttdeci">#define GEN_PERS_MAIN(LATENT)</div><div class="ttdoc">For a given type of latent period, generates functions that each generates a specific combination of ...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00246">simulation.h:246</a></div></div>
<div class="ttc" id="astructsim__vars___html_a4ecabd97135c500f58175eb7e79f2590"><div class="ttname"><a href="structsim__vars__.html#a4ecabd97135c500f58175eb7e79f2590">sim_vars_::ii</a></div><div class="ttdeci">infindividual * ii</div><div class="ttdoc">Pointer to current iteration infectious individual.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00035">simulation.h:35</a></div></div>
<div class="ttc" id="asimulation_8h_html_a25404969c762d39ee77eb67bc8611428"><div class="ttname"><a href="simulation_8h.html#a25404969c762d39ee77eb67bc8611428">simulate</a></div><div class="ttdeci">int simulate(sim_vars *sv)</div><div class="ttdoc">Performs the simulation.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8c_source.html#l00160">simulation.c:160</a></div></div>
<div class="ttc" id="asimulation_8h_html_a909090a23b94d15cfc7fe877c85466b1"><div class="ttname"><a href="simulation_8h.html#a909090a23b94d15cfc7fe877c85466b1">dummy_proc_func_one_par</a></div><div class="ttdeci">static void dummy_proc_func_one_par(infindividual *inf)</div><div class="ttdoc">Default processing function.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00309">simulation.h:309</a></div></div>
<div class="ttc" id="asimulation_8h_html_ae122699e5ed7266492671f08ad74f0f1"><div class="ttname"><a href="simulation_8h.html#ae122699e5ed7266492671f08ad74f0f1">sim_set_proc_data</a></div><div class="ttdeci">static void sim_set_proc_data(sim_vars *sv, void *dataptr)</div><div class="ttdoc">Initialises the simulation-level data pointer for user-defined functions.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00088">simulation.h:88</a></div></div>
<div class="ttc" id="asimulation_8h_html_a5bde1baf6ffdfb13173d7dd10983bb68"><div class="ttname"><a href="simulation_8h.html#a5bde1baf6ffdfb13173d7dd10983bb68">sim_free</a></div><div class="ttdeci">static void sim_free(sim_vars *sv)</div><div class="ttdoc">Frees the dynamic memory used in the simulation handle.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00161">simulation.h:161</a></div></div>
<div class="ttc" id="astructmodel__pars_html_aac4af9226e4d189e42d148ce178f4033"><div class="ttname"><a href="structmodel__pars.html#aac4af9226e4d189e42d148ce178f4033">model_pars::tmax</a></div><div class="ttdeci">double tmax</div><div class="ttdoc">Maximum simulation period used to instantiate new infectious individuals.</div><div class="ttdef"><b>Definition:</b> <a href="model__parameters_8h_source.html#l00046">model_parameters.h:46</a></div></div>
<div class="ttc" id="astructsim__vars___html_a3884cb21e08092c3e9c686bebc2e06c1"><div class="ttname"><a href="structsim__vars__.html#a3884cb21e08092c3e9c686bebc2e06c1">sim_vars_::new_event_proc_func</a></div><div class="ttdeci">bool(* new_event_proc_func)(struct sim_vars_ *sv)</div><div class="ttdoc">Pointer to the user-defined processing function that is called when a new transmission event is creat...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00040">simulation.h:40</a></div></div>
<div class="ttc" id="asimulation_8h_html_afd981fab1171f8b03e1c952b20f6f3ff"><div class="ttname"><a href="simulation_8h.html#afd981fab1171f8b03e1c952b20f6f3ff">sim_pars_check</a></div><div class="ttdeci">int sim_pars_check(model_pars const *pars)</div><div class="ttdoc">Verifies the validity of simulation parameters.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8c_source.html#l00013">simulation.c:13</a></div></div>
<div class="ttc" id="asimulation_8h_html_af5bcf389e2f823c77eaeb9c114ba8217"><div class="ttname"><a href="simulation_8h.html#af5bcf389e2f823c77eaeb9c114ba8217">sim_set_new_event_proc_func</a></div><div class="ttdeci">static void sim_set_new_event_proc_func(sim_vars *sv, bool(*new_event_proc_func)(sim_vars *sv))</div><div class="ttdoc">Sets the user-defined processing function that is called when a new transmission event is created.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00102">simulation.h:102</a></div></div>
<div class="ttc" id="astructsim__vars___html_a512ad1b3e3afc84900cb0940bf31e5d3"><div class="ttname"><a href="structsim__vars__.html#a512ad1b3e3afc84900cb0940bf31e5d3">sim_vars_::gen_time_periods_func</a></div><div class="ttdeci">void(* gen_time_periods_func)(struct sim_vars_ *)</div><div class="ttdoc">Pointer to the function used to generate time periods for a given infectious individual.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00038">simulation.h:38</a></div></div>
<div class="ttc" id="asimulation_8h_html_a4ecfceeb3812509d92a677d9c65d6d9a"><div class="ttname"><a href="simulation_8h.html#a4ecfceeb3812509d92a677d9c65d6d9a">dummy_proc_func_sv</a></div><div class="ttdeci">static void dummy_proc_func_sv(sim_vars *sv)</div><div class="ttdoc">Default processing function.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00301">simulation.h:301</a></div></div>
<div class="ttc" id="asimulation_8h_html_a8013ee290efe1e7f13b3e6e4d262ed59"><div class="ttname"><a href="simulation_8h.html#a8013ee290efe1e7f13b3e6e4d262ed59">sim_init</a></div><div class="ttdeci">int sim_init(sim_vars *sv, model_pars *pars, const gsl_rng *r)</div><div class="ttdoc">Initialises the simulation.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8c_source.html#l00137">simulation.c:137</a></div></div>
<div class="ttc" id="astructsim__vars___html_aa811264d61ffd4e711034cd3965ec48b"><div class="ttname"><a href="structsim__vars__.html#aa811264d61ffd4e711034cd3965ec48b">sim_vars_::new_inf_proc_func</a></div><div class="ttdeci">void(* new_inf_proc_func)(infindividual *newinf)</div><div class="ttdoc">Pointer to the user-defined processing function that is called when a new infected individual is crea...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00041">simulation.h:41</a></div></div>
<div class="ttc" id="asimulation_8h_html_a881fb314fa7f96332cfe3f324287400f"><div class="ttname"><a href="simulation_8h.html#a881fb314fa7f96332cfe3f324287400f">default_event_proc_func</a></div><div class="ttdeci">static bool default_event_proc_func(sim_vars *sv)</div><div class="ttdoc">Default processing function that is called when a new transmission event is created.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00281">simulation.h:281</a></div></div>
<div class="ttc" id="astructsim__vars___html_a8371841f622cffaa066aade2df13c58f"><div class="ttname"><a href="structsim__vars__.html#a8371841f622cffaa066aade2df13c58f">sim_vars_::nlayers</a></div><div class="ttdeci">uint32_t nlayers</div><div class="ttdoc">Current maximum number of layers that has been used so far.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00036">simulation.h:36</a></div></div>
<div class="ttc" id="astructsim__vars___html"><div class="ttname"><a href="structsim__vars__.html">sim_vars_</a></div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00030">simulation.h:30</a></div></div>
<div class="ttc" id="astructsim__vars___html_aff1ee1c1322047e1ca12f5d9fa4b0b7f"><div class="ttname"><a href="structsim__vars__.html#aff1ee1c1322047e1ca12f5d9fa4b0b7f">sim_vars_::inf_proc_func_noevent</a></div><div class="ttdeci">void(* inf_proc_func_noevent)(infindividual *inf, void *dataptr)</div><div class="ttdoc">Pointer to the user-defined processing function that is called for an infectious individual that does...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00043">simulation.h:43</a></div></div>
<div class="ttc" id="asimulation_8h_html_a4ad9e4686543e5e6535b538a29dcd169"><div class="ttname"><a href="simulation_8h.html#a4ad9e4686543e5e6535b538a29dcd169">sim_set_increase_layers_proc_func</a></div><div class="ttdeci">static void sim_set_increase_layers_proc_func(sim_vars *sv, void(*increase_layers_proc_func)(infindividual *iis, uint32_t n))</div><div class="ttdoc">Sets the user-defined processing function that is called when the maximum number of layers is increas...</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00128">simulation.h:128</a></div></div>
<div class="ttc" id="asimulation_8h_html_a9e0b56e8119109b841681b7489e9eb4f"><div class="ttname"><a href="simulation_8h.html#a9e0b56e8119109b841681b7489e9eb4f">sim_set_new_inf_proc_func</a></div><div class="ttdeci">static void sim_set_new_inf_proc_func(sim_vars *sv, void(*new_inf_proc_func)(infindividual *newinf))</div><div class="ttdoc">Sets the user-defined processing function that is called when a new infected individual is created.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00114">simulation.h:114</a></div></div>
<div class="ttc" id="asimulation_8h_html_a43209d4db5fb03b575e3b61a72877b87"><div class="ttname"><a href="simulation_8h.html#a43209d4db5fb03b575e3b61a72877b87">default_increase_layers_proc_func</a></div><div class="ttdeci">static void default_increase_layers_proc_func(infindividual *iis, uint32_t n)</div><div class="ttdoc">Default processing function that is called when the maximum number of layers is increased.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8h_source.html#l00293">simulation.h:293</a></div></div>
<div class="ttc" id="asimulation_8h_html_a7d7687ebb34e4df53eff1ed32e7f7597"><div class="ttname"><a href="simulation_8h.html#a7d7687ebb34e4df53eff1ed32e7f7597">sim_pars_init</a></div><div class="ttdeci">void sim_pars_init(model_pars *pars)</div><div class="ttdoc">Initialises simulation parameters.</div><div class="ttdef"><b>Definition:</b> <a href="simulation_8c_source.html#l00109">simulation.c:109</a></div></div>
<div class="ttc" id="astructinfindividual_html"><div class="ttname"><a href="structinfindividual.html">infindividual</a></div><div class="ttdef"><b>Definition:</b> <a href="infindividual_8h_source.html#l00020">infindividual.h:20</a></div></div>
<div class="ttc" id="ainfindividual_8h_html"><div class="ttname"><a href="infindividual_8h.html">infindividual.h</a></div><div class="ttdoc">Data structure containing infected individual information.</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="simulation_8h.html">simulation.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
